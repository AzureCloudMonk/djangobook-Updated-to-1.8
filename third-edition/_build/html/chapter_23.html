<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Chapter 23: Advanced database management &mdash; Mastering Django</title>
    
    <link rel="stylesheet" href="_static/agogo.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '0.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="Mastering Django" href="index.html" />
    <link rel="next" title="Appendix A: Model Definition Reference" href="appendix_A.html" />
    <link rel="prev" title="How to install Django" href="chapter_22.html" /> 
  </head>
  <body role="document">
    <div class="header-wrapper" role="banner">
      <div class="header">
        <div class="headertitle"><a
          href="index.html">Mastering Django</a></div>
        <div class="rel" role="navigation" aria-label="related navigation">
          <a href="chapter_22.html" title="How to install Django"
             accesskey="P">previous</a> |
          <a href="appendix_A.html" title="Appendix A: Model Definition Reference"
             accesskey="N">next</a> |
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a>
        </div>
       </div>
    </div>

    <div class="content-wrapper">
      <div class="content">
        <div class="document">
            
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="chapter-23-advanced-database-management">
<h1>Chapter 23: Advanced database management<a class="headerlink" href="#chapter-23-advanced-database-management" title="Permalink to this headline">¶</a></h1>
<p>This chapter provides additional information on each of the supported
relational databases in Django, as well as notes and tips and tricks for
connecting to legacy databases.</p>
<div class="section" id="general-notes">
<h2>General notes<a class="headerlink" href="#general-notes" title="Permalink to this headline">¶</a></h2>
<p>Django attempts to support as many features as possible on all database
backends. However, not all database backends are alike, and the Django
developers had to make
design decisions on which features to support and which assumptions could be
made safely.</p>
<p>This file describes some of the features that might be relevant to Django
usage. Of course, it is not intended as a replacement for server-specific
documentation or reference manuals.</p>
<div class="section" id="persistent-connections">
<span id="persistent-database-connections"></span><h3>Persistent connections<a class="headerlink" href="#persistent-connections" title="Permalink to this headline">¶</a></h3>
<p>Persistent connections avoid the overhead of re-establishing a connection to
the database in each request. They&#8217;re controlled by the
<code class="docutils literal"><span class="pre">CONN_MAX_AGE</span></code> parameter which defines the maximum lifetime of a
connection. It can be set independently for each database.</p>
<p>The default value is <code class="docutils literal"><span class="pre">0</span></code>, preserving the historical behavior of closing the
database connection at the end of each request. To enable persistent
connections, set <code class="docutils literal"><span class="pre">CONN_MAX_AGE</span></code> to a positive number of seconds. For
unlimited persistent connections, set it to <code class="docutils literal"><span class="pre">None</span></code>.</p>
<div class="section" id="connection-management">
<h4>Connection management<a class="headerlink" href="#connection-management" title="Permalink to this headline">¶</a></h4>
<p>Django opens a connection to the database when it first makes a database
query. It keeps this connection open and reuses it in subsequent requests.
Django closes the connection once it exceeds the maximum age defined by
<code class="docutils literal"><span class="pre">CONN_MAX_AGE</span></code> or when it isn&#8217;t usable any longer.</p>
<p>In detail, Django automatically opens a connection to the database whenever it
needs one and doesn&#8217;t have one already — either because this is the first
connection, or because the previous connection was closed.</p>
<p>At the beginning of each request, Django closes the connection if it has
reached its maximum age. If your database terminates idle connections after
some time, you should set <code class="docutils literal"><span class="pre">CONN_MAX_AGE</span></code> to a lower value, so that
Django doesn&#8217;t attempt to use a connection that has been terminated by the
database server. (This problem may only affect very low traffic sites.)</p>
<p>At the end of each request, Django closes the connection if it has reached its
maximum age or if it is in an unrecoverable error state. If any database
errors have occurred while processing the requests, Django checks whether the
connection still works, and closes it if it doesn&#8217;t. Thus, database errors
affect at most one request; if the connection becomes unusable, the next
request gets a fresh connection.</p>
</div>
<div class="section" id="caveats">
<h4>Caveats<a class="headerlink" href="#caveats" title="Permalink to this headline">¶</a></h4>
<p>Since each thread maintains its own connection, your database must support at
least as many simultaneous connections as you have worker threads.</p>
<p>Sometimes a database won&#8217;t be accessed by the majority of your views, for
example because it&#8217;s the database of an external system, or thanks to caching.
In such cases, you should set <code class="docutils literal"><span class="pre">CONN_MAX_AGE</span></code> to a low value or even
<code class="docutils literal"><span class="pre">0</span></code>, because it doesn&#8217;t make sense to maintain a connection that&#8217;s unlikely
to be reused. This will help keep the number of simultaneous connections to
this database small.</p>
<p>The development server creates a new thread for each request it handles,
negating the effect of persistent connections. Don&#8217;t enable them during
development.</p>
<p>When Django establishes a connection to the database, it sets up appropriate
parameters, depending on the backend being used. If you enable persistent
connections, this setup is no longer repeated every request. If you modify
parameters such as the connection&#8217;s isolation level or time zone, you should
either restore Django&#8217;s defaults at the end of each request, force an
appropriate value at the beginning of each request, or disable persistent
connections.</p>
</div>
</div>
<div class="section" id="encoding">
<h3>Encoding<a class="headerlink" href="#encoding" title="Permalink to this headline">¶</a></h3>
<p>Django assumes that all databases use UTF-8 encoding. Using other encodings may
result in unexpected behavior such as &#8220;value too long&#8221; errors from your
database for data that is valid in Django. See the database specific notes
below for information on how to set up your database correctly.</p>
</div>
</div>
<div class="section" id="postgresql-notes">
<span id="id1"></span><h2>PostgreSQL notes<a class="headerlink" href="#postgresql-notes" title="Permalink to this headline">¶</a></h2>
<p>Django supports PostgreSQL 9.0 and higher. It requires the use of Psycopg2
2.0.9 or higher.</p>
<div class="section" id="postgresql-connection-settings">
<h3>PostgreSQL connection settings<a class="headerlink" href="#postgresql-connection-settings" title="Permalink to this headline">¶</a></h3>
<p>See <code class="docutils literal"><span class="pre">HOST</span></code> for details.</p>
</div>
<div class="section" id="optimizing-postgresql-s-configuration">
<h3>Optimizing PostgreSQL&#8217;s configuration<a class="headerlink" href="#optimizing-postgresql-s-configuration" title="Permalink to this headline">¶</a></h3>
<p>Django needs the following parameters for its database connections:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">client_encoding</span></code>: <code class="docutils literal"><span class="pre">'UTF8'</span></code>,</li>
<li><code class="docutils literal"><span class="pre">default_transaction_isolation</span></code>: <code class="docutils literal"><span class="pre">'read</span> <span class="pre">committed'</span></code> by default,
or the value set in the connection options (see below),</li>
<li><code class="docutils literal"><span class="pre">timezone</span></code>: <code class="docutils literal"><span class="pre">'UTC'</span></code> when <code class="docutils literal"><span class="pre">USE_TZ</span></code> is <code class="docutils literal"><span class="pre">True</span></code>, value of
<code class="docutils literal"><span class="pre">TIME_ZONE</span></code> otherwise.</li>
</ul>
<p>If these parameters already have the correct values, Django won&#8217;t set them for
every new connection, which improves performance slightly. You can configure
them directly in <code class="docutils literal"><span class="pre">postgresql.conf</span></code> or more conveniently per database
user with <a class="reference external" href="http://www.postgresql.org/docs/current/interactive/sql-alterrole.html">ALTER ROLE</a>.</p>
<p>Django will work just fine without this optimization, but each new connection
will do some additional queries to set these parameters.</p>
</div>
<div class="section" id="isolation-level">
<span id="database-isolation-level"></span><h3>Isolation level<a class="headerlink" href="#isolation-level" title="Permalink to this headline">¶</a></h3>
<p>Like PostgreSQL itself, Django defaults to the <code class="docutils literal"><span class="pre">READ</span> <span class="pre">COMMITTED</span></code> <a class="reference external" href="http://www.postgresql.org/docs/current/static/transaction-iso.html">isolation
level</a>. If you need a higher isolation level such as <code class="docutils literal"><span class="pre">REPEATABLE</span> <span class="pre">READ</span></code> or
<code class="docutils literal"><span class="pre">SERIALIZABLE</span></code>, set it in the <code class="docutils literal"><span class="pre">OPTIONS</span></code> part of your database
configuration in <code class="docutils literal"><span class="pre">DATABASES</span></code>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">psycopg2.extensions</span>

<span class="n">DATABASES</span> <span class="o">=</span> <span class="p">{</span>
    <span class="c"># ...</span>
    <span class="s">&#39;OPTIONS&#39;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s">&#39;isolation_level&#39;</span><span class="p">:</span> <span class="n">psycopg2</span><span class="o">.</span><span class="n">extensions</span><span class="o">.</span><span class="n">ISOLATION_LEVEL_SERIALIZABLE</span><span class="p">,</span>
    <span class="p">},</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Under higher isolation levels, your application should be prepared to
handle exceptions raised on serialization failures. This option is
designed for advanced uses.</p>
</div>
</div>
<div class="section" id="indexes-for-varchar-and-text-columns">
<h3>Indexes for <code class="docutils literal"><span class="pre">varchar</span></code> and <code class="docutils literal"><span class="pre">text</span></code> columns<a class="headerlink" href="#indexes-for-varchar-and-text-columns" title="Permalink to this headline">¶</a></h3>
<p>When specifying <code class="docutils literal"><span class="pre">db_index=True</span></code> on your model fields, Django typically
outputs a single <code class="docutils literal"><span class="pre">CREATE</span> <span class="pre">INDEX</span></code> statement.  However, if the database type
for the field is either <code class="docutils literal"><span class="pre">varchar</span></code> or <code class="docutils literal"><span class="pre">text</span></code> (e.g., used by <code class="docutils literal"><span class="pre">CharField</span></code>,
<code class="docutils literal"><span class="pre">FileField</span></code>, and <code class="docutils literal"><span class="pre">TextField</span></code>), then Django will create
an additional index that uses an appropriate <a class="reference external" href="http://www.postgresql.org/docs/current/static/indexes-opclass.html">PostgreSQL operator class</a>
for the column.  The extra index is necessary to correctly perform
lookups that use the <code class="docutils literal"><span class="pre">LIKE</span></code> operator in their SQL, as is done with the
<code class="docutils literal"><span class="pre">contains</span></code> and <code class="docutils literal"><span class="pre">startswith</span></code> lookup types.</p>
</div>
</div>
<div class="section" id="mysql-notes">
<span id="id3"></span><h2>MySQL notes<a class="headerlink" href="#mysql-notes" title="Permalink to this headline">¶</a></h2>
<div class="section" id="version-support">
<h3>Version support<a class="headerlink" href="#version-support" title="Permalink to this headline">¶</a></h3>
<p>Django supports MySQL 5.5 and higher.</p>
<p>Django&#8217;s <code class="docutils literal"><span class="pre">inspectdb</span></code> feature uses the <code class="docutils literal"><span class="pre">information_schema</span></code> database, which
contains detailed data on all database schemas.</p>
<p>Django expects the database to support Unicode (UTF-8 encoding) and delegates to
it the task of enforcing transactions and referential integrity. It is important
to be aware of the fact that the two latter ones aren&#8217;t actually enforced by
MySQL when using the MyISAM storage engine, see the next section.</p>
</div>
<div class="section" id="storage-engines">
<span id="mysql-storage-engines"></span><h3>Storage engines<a class="headerlink" href="#storage-engines" title="Permalink to this headline">¶</a></h3>
<p>MySQL has several <a class="reference external" href="http://dev.mysql.com/doc/refman/5.6/en/storage-engines.html">storage engines</a>. You can change the default storage engine
in the server configuration.</p>
<p>Until MySQL 5.5.4, the default engine was <a class="reference external" href="http://dev.mysql.com/doc/refman/5.6/en/myisam-storage-engine.html">MyISAM</a> <a class="footnote-reference" href="#id6" id="id4">[1]</a>. The main drawbacks of
MyISAM are that it doesn&#8217;t support transactions or enforce foreign-key
constraints. On the plus side, it was the only engine that supported full-text
indexing and searching until MySQL 5.6.4.</p>
<p>Since MySQL 5.5.5, the default storage engine is <a class="reference external" href="http://dev.mysql.com/doc/refman/5.6/en/innodb-storage-engine.html">InnoDB</a>. This engine is fully
transactional and supports foreign key references. It&#8217;s probably the best
choice at this point. However, note that the InnoDB autoincrement counter
is lost on a MySQL restart because it does not remember the
<code class="docutils literal"><span class="pre">AUTO_INCREMENT</span></code> value, instead recreating it as &#8220;max(id)+1&#8221;. This may
result in an inadvertent reuse of <code class="xref py py-class docutils literal"><span class="pre">AutoField</span></code> values.</p>
<p>If you upgrade an existing project to MySQL 5.5.5 and subsequently add some
tables, ensure that your tables are using the same storage engine (i.e. MyISAM
vs. InnoDB). Specifically, if tables that have a <code class="docutils literal"><span class="pre">ForeignKey</span></code> between them
use different storage engines, you may see an error like the following when
running <code class="docutils literal"><span class="pre">migrate</span></code>:</p>
<div class="highlight-python"><div class="highlight"><pre>_mysql_exceptions.OperationalError: (
    1005, &quot;Can&#39;t create table &#39;\\db_name\\.#sql-4a8_ab&#39; (errno: 150)&quot;
)
</pre></div>
</div>
<table class="docutils footnote" frame="void" id="id6" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id4">[1]</a></td><td>Unless this was changed by the packager of your MySQL package. We&#8217;ve
had reports that the Windows Community Server installer sets up InnoDB as
the default storage engine, for example.</td></tr>
</tbody>
</table>
</div>
<div class="section" id="mysql-db-api-drivers">
<span id="id7"></span><h3>MySQL DB API Drivers<a class="headerlink" href="#mysql-db-api-drivers" title="Permalink to this headline">¶</a></h3>
<p>The Python Database API is described in <span class="target" id="index-0"></span><a class="pep reference external" href="https://www.python.org/dev/peps/pep-0249"><strong>PEP 249</strong></a>. MySQL has three prominent
drivers that implement this API:</p>
<ul class="simple">
<li><a class="reference external" href="https://pypi.python.org/pypi/MySQL-python/1.2.4">MySQLdb</a> is a native driver that has been developed and supported for over
a decade by Andy Dustman.</li>
<li><a class="reference external" href="https://pypi.python.org/pypi/mysqlclient">mysqlclient</a> is a fork of <code class="docutils literal"><span class="pre">MySQLdb</span></code> which notably supports Python 3 and
can be used as a drop-in replacement for MySQLdb. At the time of this writing,
this is <strong>the recommended choice</strong> for using MySQL with Django.</li>
<li><a class="reference external" href="http://dev.mysql.com/downloads/connector/python">MySQL Connector/Python</a> is a pure Python driver from Oracle that does not
require the MySQL client library or any Python modules outside the standard
library.</li>
</ul>
<p>All these drivers are thread-safe and provide connection pooling. <code class="docutils literal"><span class="pre">MySQLdb</span></code>
is the only one not supporting Python 3 currently.</p>
<p>In addition to a DB API driver, Django needs an adapter to access the database
drivers from its ORM. Django provides an adapter for MySQLdb/mysqlclient while
MySQL Connector/Python includes <a class="reference external" href="http://dev.mysql.com/doc/refman/5.6/en/connector-python-info.html">its own</a>.</p>
<div class="section" id="id8">
<h4>MySQLdb<a class="headerlink" href="#id8" title="Permalink to this headline">¶</a></h4>
<p>Django requires MySQLdb version 1.2.1p2 or later.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">If you see <code class="docutils literal"><span class="pre">ImportError:</span> <span class="pre">cannot</span> <span class="pre">import</span> <span class="pre">name</span> <span class="pre">ImmutableSet</span></code> when trying to
use Django, your MySQLdb installation may contain an outdated <code class="docutils literal"><span class="pre">sets.py</span></code>
file that conflicts with the built-in module of the same name from Python
2.4 and later. To fix this, verify that you have installed MySQLdb version
1.2.1p2 or newer, then delete the <code class="docutils literal"><span class="pre">sets.py</span></code> file in the MySQLdb
directory that was left by an earlier version.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>There are known issues with the way MySQLdb converts date strings into
datetime objects. Specifically, date strings with value 0000-00-00 are
valid for MySQL but will be converted into None by MySQLdb.</p>
<p class="last">This means you should be careful while using loaddata/dumpdata with rows
that may have 0000-00-00 values, as they will be converted to None.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">At the time of writing, the latest release of MySQLdb (1.2.4) doesn&#8217;t
support Python 3. In order to use MySQLdb under Python 3, you&#8217;ll have to
install <code class="docutils literal"><span class="pre">mysqlclient</span></code>.</p>
</div>
</div>
<div class="section" id="id9">
<h4>mysqlclient<a class="headerlink" href="#id9" title="Permalink to this headline">¶</a></h4>
<p>Django requires <a class="reference external" href="https://pypi.python.org/pypi/mysqlclient">mysqlclient</a> 1.3.3 or later. Note that Python 3.2 is not
supported. Except for the Python 3.3+ support, mysqlclient should mostly behave
the same as MySQLDB.</p>
</div>
<div class="section" id="id10">
<h4>MySQL Connector/Python<a class="headerlink" href="#id10" title="Permalink to this headline">¶</a></h4>
<p>MySQL Connector/Python is available from the <a class="reference external" href="http://dev.mysql.com/downloads/connector/python/">download page</a>.
The Django adapter is available in versions 1.1.X and later. It may not
support the most recent releases of Django.</p>
</div>
</div>
<div class="section" id="time-zone-definitions">
<span id="mysql-time-zone-definitions"></span><h3>Time zone definitions<a class="headerlink" href="#time-zone-definitions" title="Permalink to this headline">¶</a></h3>
<p>If you plan on using Django&#8217;s timezone support ,
use <a class="reference external" href="http://dev.mysql.com/doc/refman/5.6/en/mysql-tzinfo-to-sql.html">mysql_tzinfo_to_sql</a> to load time zone tables into the MySQL database.
This needs to be done just once for your MySQL server, not per database.</p>
</div>
<div class="section" id="creating-your-database">
<h3>Creating your database<a class="headerlink" href="#creating-your-database" title="Permalink to this headline">¶</a></h3>
<p>You can <a class="reference external" href="http://dev.mysql.com/doc/refman/5.6/en/create-database.html">create your database</a> using the command-line tools and this SQL:</p>
<div class="highlight-python"><div class="highlight"><pre>CREATE DATABASE &lt;dbname&gt; CHARACTER SET utf8;
</pre></div>
</div>
<p>This ensures all tables and columns will use UTF-8 by default.</p>
<div class="section" id="collation-settings">
<span id="mysql-collation"></span><h4>Collation settings<a class="headerlink" href="#collation-settings" title="Permalink to this headline">¶</a></h4>
<p>The collation setting for a column controls the order in which data is sorted
as well as what strings compare as equal. It can be set on a database-wide
level and also per-table and per-column. This is <a class="reference external" href="http://dev.mysql.com/doc/refman/5.6/en/charset.html">documented thoroughly</a> in
the MySQL documentation. In all cases, you set the collation by directly
manipulating the database tables; Django doesn&#8217;t provide a way to set this on
the model definition.</p>
<p>By default, with a UTF-8 database, MySQL will use the
<code class="docutils literal"><span class="pre">utf8_general_ci</span></code> collation. This results in all string equality
comparisons being done in a <em>case-insensitive</em> manner. That is, <code class="docutils literal"><span class="pre">&quot;Fred&quot;</span></code> and
<code class="docutils literal"><span class="pre">&quot;freD&quot;</span></code> are considered equal at the database level. If you have a unique
constraint on a field, it would be illegal to try to insert both <code class="docutils literal"><span class="pre">&quot;aa&quot;</span></code> and
<code class="docutils literal"><span class="pre">&quot;AA&quot;</span></code> into the same column, since they compare as equal (and, hence,
non-unique) with the default collation.</p>
<p>In many cases, this default will not be a problem. However, if you really want
case-sensitive comparisons on a particular column or table, you would change
the column or table to use the <code class="docutils literal"><span class="pre">utf8_bin</span></code> collation. The main thing to be
aware of in this case is that if you are using MySQLdb 1.2.2, the database
backend in Django will then return bytestrings (instead of unicode strings) for
any character fields it receive from the database. This is a strong variation
from Django&#8217;s normal practice of <em>always</em> returning unicode strings. It is up
to you, the developer, to handle the fact that you will receive bytestrings if
you configure your table(s) to use <code class="docutils literal"><span class="pre">utf8_bin</span></code> collation. Django itself should
mostly work smoothly with such columns (except for the <code class="docutils literal"><span class="pre">contrib.sessions</span></code>
<code class="docutils literal"><span class="pre">Session</span></code> and <code class="docutils literal"><span class="pre">contrib.admin</span></code> <code class="docutils literal"><span class="pre">LogEntry</span></code> tables described below), but
your code must be prepared to call <code class="docutils literal"><span class="pre">django.utils.encoding.smart_text()</span></code> at
times if it really wants to work with consistent data &#8211; Django will not do
this for you (the database backend layer and the model population layer are
separated internally so the database layer doesn&#8217;t know it needs to make this
conversion in this one particular case).</p>
<p>If you&#8217;re using MySQLdb 1.2.1p2, Django&#8217;s standard
<code class="xref py py-class docutils literal"><span class="pre">CharField</span></code> class will return unicode strings even
with <code class="docutils literal"><span class="pre">utf8_bin</span></code> collation. However, <a class="reference internal" href="appendix_A.html#django.db.models.TextField" title="django.db.models.TextField"><code class="xref py py-class docutils literal"><span class="pre">TextField</span></code></a>
fields will be returned as an <code class="docutils literal"><span class="pre">array.array</span></code> instance (from Python&#8217;s standard
<code class="docutils literal"><span class="pre">array</span></code> module). There isn&#8217;t a lot Django can do about that, since, again,
the information needed to make the necessary conversions isn&#8217;t available when
the data is read in from the database. This problem was <a class="reference external" href="http://sourceforge.net/tracker/index.php?func=detail&amp;aid=1495765&amp;group_id=22307&amp;atid=374932">fixed in MySQLdb
1.2.2</a>, so if you want to use <a class="reference internal" href="appendix_A.html#django.db.models.TextField" title="django.db.models.TextField"><code class="xref py py-class docutils literal"><span class="pre">TextField</span></code></a> with
<code class="docutils literal"><span class="pre">utf8_bin</span></code> collation, upgrading to version 1.2.2 and then dealing with the
bytestrings (which shouldn&#8217;t be too difficult) as described above is the
recommended solution.</p>
<p>Should you decide to use <code class="docutils literal"><span class="pre">utf8_bin</span></code> collation for some of your tables with
MySQLdb 1.2.1p2 or 1.2.2, you should still use <code class="docutils literal"><span class="pre">utf8_general_ci</span></code>
(the default) collation for the <code class="docutils literal"><span class="pre">django.contrib.sessions.models.Session</span></code>
table (usually called <code class="docutils literal"><span class="pre">django_session</span></code>) and the
<code class="docutils literal"><span class="pre">django.contrib.admin.models.LogEntry</span></code> table (usually called
<code class="docutils literal"><span class="pre">django_admin_log</span></code>). Those are the two standard tables that use
<a class="reference internal" href="appendix_A.html#django.db.models.TextField" title="django.db.models.TextField"><code class="xref py py-class docutils literal"><span class="pre">TextField</span></code></a> internally.</p>
<p>Please note that according to <a class="reference external" href="http://dev.mysql.com/doc/refman/5.7/en/charset-unicode-sets.html">MySQL Unicode Character Sets</a>, comparisons for
the <code class="docutils literal"><span class="pre">utf8_general_ci</span></code> collation are faster, but slightly less correct, than
comparisons for <code class="docutils literal"><span class="pre">utf8_unicode_ci</span></code>. If this is acceptable for your application,
you should use <code class="docutils literal"><span class="pre">utf8_general_ci</span></code> because it is faster. If this is not acceptable
(for example, if you require German dictionary order), use <code class="docutils literal"><span class="pre">utf8_unicode_ci</span></code>
because it is more accurate.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Model formsets validate unique fields in a case-sensitive manner. Thus when
using a case-insensitive collation, a formset with unique field values that
differ only by case will pass validation, but upon calling <code class="docutils literal"><span class="pre">save()</span></code>, an
<code class="docutils literal"><span class="pre">IntegrityError</span></code> will be raised.</p>
</div>
</div>
</div>
<div class="section" id="connecting-to-the-database">
<h3>Connecting to the database<a class="headerlink" href="#connecting-to-the-database" title="Permalink to this headline">¶</a></h3>
<p>Refer to the settings documentation .</p>
<p>Connection settings are used in this order:</p>
<ol class="arabic simple">
<li><code class="docutils literal"><span class="pre">OPTIONS</span></code>.</li>
<li><code class="docutils literal"><span class="pre">NAME</span></code>, <code class="docutils literal"><span class="pre">USER</span></code>, <code class="docutils literal"><span class="pre">PASSWORD</span></code>,
<code class="docutils literal"><span class="pre">HOST</span></code>, <code class="docutils literal"><span class="pre">PORT</span></code></li>
<li>MySQL option files.</li>
</ol>
<p>In other words, if you set the name of the database in <code class="docutils literal"><span class="pre">OPTIONS</span></code>,
this will take precedence over <code class="docutils literal"><span class="pre">NAME</span></code>, which would override
anything in a <a class="reference external" href="http://dev.mysql.com/doc/refman/5.6/en/option-files.html">MySQL option file</a>.</p>
<p>Here&#8217;s a sample configuration which uses a MySQL option file:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># settings.py</span>
<span class="n">DATABASES</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s">&#39;default&#39;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s">&#39;ENGINE&#39;</span><span class="p">:</span> <span class="s">&#39;django.db.backends.mysql&#39;</span><span class="p">,</span>
        <span class="s">&#39;OPTIONS&#39;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s">&#39;read_default_file&#39;</span><span class="p">:</span> <span class="s">&#39;/path/to/my.cnf&#39;</span><span class="p">,</span>
        <span class="p">},</span>
    <span class="p">}</span>
<span class="p">}</span>


<span class="c"># my.cnf</span>
<span class="p">[</span><span class="n">client</span><span class="p">]</span>
<span class="n">database</span> <span class="o">=</span> <span class="n">NAME</span>
<span class="n">user</span> <span class="o">=</span> <span class="n">USER</span>
<span class="n">password</span> <span class="o">=</span> <span class="n">PASSWORD</span>
<span class="n">default</span><span class="o">-</span><span class="n">character</span><span class="o">-</span><span class="nb">set</span> <span class="o">=</span> <span class="n">utf8</span>
</pre></div>
</div>
<p>Several other MySQLdb connection options may be useful, such as <code class="docutils literal"><span class="pre">ssl</span></code>,
<code class="docutils literal"><span class="pre">init_command</span></code>, and <code class="docutils literal"><span class="pre">sql_mode</span></code>. Consult the <a class="reference external" href="http://mysql-python.sourceforge.net/">MySQLdb documentation</a> for
more details.</p>
</div>
<div class="section" id="creating-your-tables">
<h3>Creating your tables<a class="headerlink" href="#creating-your-tables" title="Permalink to this headline">¶</a></h3>
<p>When Django generates the schema, it doesn&#8217;t specify a storage engine, so
tables will be created with whatever default storage engine your database
server is configured for. The easiest solution is to set your database server&#8217;s
default storage engine to the desired engine.</p>
<p>If you&#8217;re using a hosting service and can&#8217;t change your server&#8217;s default
storage engine, you have a couple of options.</p>
<ul>
<li><p class="first">After the tables are created, execute an <code class="docutils literal"><span class="pre">ALTER</span> <span class="pre">TABLE</span></code> statement to
convert a table to a new storage engine (such as InnoDB):</p>
<div class="highlight-python"><div class="highlight"><pre>ALTER TABLE &lt;tablename&gt; ENGINE=INNODB;
</pre></div>
</div>
<p>This can be tedious if you have a lot of tables.</p>
</li>
<li><p class="first">Another option is to use the <code class="docutils literal"><span class="pre">init_command</span></code> option for MySQLdb prior to
creating your tables:</p>
<div class="highlight-python"><div class="highlight"><pre>&#39;OPTIONS&#39;: {
   &#39;init_command&#39;: &#39;SET storage_engine=INNODB&#39;,
}
</pre></div>
</div>
<p>This sets the default storage engine upon connecting to the database.
After your tables have been created, you should remove this option as it
adds a query that is only needed during table creation to each database
connection.</p>
</li>
</ul>
</div>
<div class="section" id="table-names">
<h3>Table names<a class="headerlink" href="#table-names" title="Permalink to this headline">¶</a></h3>
<p>There are <a class="reference external" href="http://bugs.mysql.com/bug.php?id=48875">known issues</a> in even the latest versions of MySQL that can cause the
case of a table name to be altered when certain SQL statements are executed
under certain conditions. It is recommended that you use lowercase table
names, if possible, to avoid any problems that might arise from this behavior.
Django uses lowercase table names when it auto-generates table names from
models, so this is mainly a consideration if you are overriding the table name
via the <a class="reference internal" href="appendix_A.html#django.db.models.Options.db_table" title="django.db.models.Options.db_table"><code class="xref py py-class docutils literal"><span class="pre">db_table</span></code></a> parameter.</p>
</div>
<div class="section" id="savepoints">
<h3>Savepoints<a class="headerlink" href="#savepoints" title="Permalink to this headline">¶</a></h3>
<p>Both the Django ORM and MySQL (when using the InnoDB storage engine) support
database savepoints.</p>
<p>If you use the MyISAM storage engine please be aware of the fact that you will
receive database-generated errors if you try to use the savepoint-related
methods of the transactions API. The reason
for this is that detecting the storage engine of a MySQL database/table is an
expensive operation so it was decided it isn&#8217;t worth to dynamically convert
these methods in no-op&#8217;s based in the results of such detection.</p>
</div>
<div class="section" id="notes-on-specific-fields">
<h3>Notes on specific fields<a class="headerlink" href="#notes-on-specific-fields" title="Permalink to this headline">¶</a></h3>
<div class="section" id="character-fields">
<h4>Character fields<a class="headerlink" href="#character-fields" title="Permalink to this headline">¶</a></h4>
<p>Any fields that are stored with <code class="docutils literal"><span class="pre">VARCHAR</span></code> column types have their
<code class="docutils literal"><span class="pre">max_length</span></code> restricted to 255 characters if you are using <code class="docutils literal"><span class="pre">unique=True</span></code>
for the field. This affects <code class="xref py py-class docutils literal"><span class="pre">CharField</span></code>,
<a class="reference internal" href="appendix_A.html#django.db.models.SlugField" title="django.db.models.SlugField"><code class="xref py py-class docutils literal"><span class="pre">SlugField</span></code></a> and
<code class="xref py py-class docutils literal"><span class="pre">CommaSeparatedIntegerField</span></code>.</p>
</div>
<div class="section" id="fractional-seconds-support-for-time-and-datetime-fields">
<span id="mysql-fractional-seconds"></span><h4>Fractional seconds support for Time and DateTime fields<a class="headerlink" href="#fractional-seconds-support-for-time-and-datetime-fields" title="Permalink to this headline">¶</a></h4>
<p>MySQL 5.6.4 and later can store fractional seconds, provided that the
column definition includes a fractional indication (e.g. <code class="docutils literal"><span class="pre">DATETIME(6)</span></code>).
Earlier versions do not support them at all. In addition, versions of MySQLdb
older than 1.2.5 have <a class="reference external" href="https://github.com/farcepest/MySQLdb1/issues/24">a bug</a> that also prevents the use of fractional seconds
with MySQL.</p>
<p>Django will not upgrade existing columns to include fractional seconds if the
database server supports it. If you want to enable them on an existing database,
it&#8217;s up to you to either manually update the column on the target database, by
executing a command like:</p>
<div class="highlight-python"><div class="highlight"><pre>ALTER TABLE `your_table` MODIFY `your_datetime_column` DATETIME(6)
</pre></div>
</div>
<p>or using a <code class="xref py py-class docutils literal"><span class="pre">RunSQL</span></code> operation in a
<code class="docutils literal"><span class="pre">data</span> <span class="pre">migration</span> <span class="pre">&lt;data-migrations&gt;</span></code>.</p>
<p>By default, new <code class="docutils literal"><span class="pre">DateTimeField</span></code> or <code class="docutils literal"><span class="pre">TimeField</span></code> columns are now created
with fractional seconds support on MySQL 5.6.4 or later with either
mysqlclient or MySQLdb 1.2.5 or later.</p>
</div>
<div class="section" id="timestamp-columns">
<h4><code class="docutils literal"><span class="pre">TIMESTAMP</span></code> columns<a class="headerlink" href="#timestamp-columns" title="Permalink to this headline">¶</a></h4>
<p>If you are using a legacy database that contains <code class="docutils literal"><span class="pre">TIMESTAMP</span></code> columns, you must
set <code class="docutils literal"><span class="pre">USE_TZ</span> <span class="pre">=</span> <span class="pre">False</span> <span class="pre">&lt;USE_TZ&gt;</span></code> to avoid data corruption.
<code class="docutils literal"><span class="pre">inspectdb</span></code> maps these columns to
<code class="xref py py-class docutils literal"><span class="pre">DateTimeField</span></code> and if you enable timezone support,
both MySQL and Django will attempt to convert the values from UTC to local time.</p>
</div>
</div>
<div class="section" id="row-locking-with-queryset-select-for-update">
<h3>Row locking with <code class="docutils literal"><span class="pre">QuerySet.select_for_update()</span></code><a class="headerlink" href="#row-locking-with-queryset-select-for-update" title="Permalink to this headline">¶</a></h3>
<p>MySQL does not support the <code class="docutils literal"><span class="pre">NOWAIT</span></code> option to the <code class="docutils literal"><span class="pre">SELECT</span> <span class="pre">...</span> <span class="pre">FOR</span> <span class="pre">UPDATE</span></code>
statement. If <code class="docutils literal"><span class="pre">select_for_update()</span></code> is used with <code class="docutils literal"><span class="pre">nowait=True</span></code> then a
<code class="docutils literal"><span class="pre">DatabaseError</span></code> will be raised.</p>
</div>
<div class="section" id="automatic-typecasting-can-cause-unexpected-results">
<h3>Automatic typecasting can cause unexpected results<a class="headerlink" href="#automatic-typecasting-can-cause-unexpected-results" title="Permalink to this headline">¶</a></h3>
<p>When performing a query on a string type, but with an integer value, MySQL will
coerce the types of all values in the table to an integer before performing the
comparison. If your table contains the values <code class="docutils literal"><span class="pre">'abc'</span></code>, <code class="docutils literal"><span class="pre">'def'</span></code> and you
query for <code class="docutils literal"><span class="pre">WHERE</span> <span class="pre">mycolumn=0</span></code>, both rows will match. Similarly, <code class="docutils literal"><span class="pre">WHERE</span> <span class="pre">mycolumn=1</span></code>
will match the value <code class="docutils literal"><span class="pre">'abc1'</span></code>. Therefore, string type fields included in Django
will always cast the value to a string before using it in a query.</p>
<p>If you implement custom model fields that inherit from <code class="xref py py-class docutils literal"><span class="pre">Field</span></code>
directly, are overriding <code class="xref py py-meth docutils literal"><span class="pre">get_prep_value()</span></code>, or use
<code class="xref py py-meth docutils literal"><span class="pre">extra()</span></code> or
<code class="xref py py-meth docutils literal"><span class="pre">raw()</span></code>, you should ensure that you
perform the appropriate typecasting.</p>
</div>
</div>
<div class="section" id="sqlite-notes">
<span id="id11"></span><h2>SQLite notes<a class="headerlink" href="#sqlite-notes" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="http://www.sqlite.org/">SQLite</a> provides an excellent development alternative for applications that
are predominantly read-only or require a smaller installation footprint. As
with all database servers, though, there are some differences that are
specific to SQLite that you should be aware of.</p>
<div class="section" id="substring-matching-and-case-sensitivity">
<span id="sqlite-string-matching"></span><h3>Substring matching and case sensitivity<a class="headerlink" href="#substring-matching-and-case-sensitivity" title="Permalink to this headline">¶</a></h3>
<p>For all SQLite versions, there is some slightly counter-intuitive behavior when
attempting to match some types of strings.  These are triggered when using the
<code class="docutils literal"><span class="pre">iexact</span></code> or <code class="docutils literal"><span class="pre">contains</span></code> filters in Querysets. The behavior
splits into two cases:</p>
<p>1. For substring matching, all matches are done case-insensitively. That is a
filter such as <code class="docutils literal"><span class="pre">filter(name__contains=&quot;aa&quot;)</span></code> will match a name of <code class="docutils literal"><span class="pre">&quot;Aabb&quot;</span></code>.</p>
<p>2. For strings containing characters outside the ASCII range, all exact string
matches are performed case-sensitively, even when the case-insensitive options
are passed into the query. So the <code class="docutils literal"><span class="pre">iexact</span></code> filter will behave exactly
the same as the <code class="docutils literal"><span class="pre">exact</span></code> filter in these cases.</p>
<p>Some possible workarounds for this are <a class="reference external" href="http://www.sqlite.org/faq.html#q18">documented at sqlite.org</a>, but they
aren&#8217;t utilized by the default SQLite backend in Django, as incorporating them
would be fairly difficult to do robustly. Thus, Django exposes the default
SQLite behavior and you should be aware of this when doing case-insensitive or
substring filtering.</p>
</div>
<div class="section" id="old-sqlite-and-case-expressions">
<h3>Old SQLite and <code class="docutils literal"><span class="pre">CASE</span></code> expressions<a class="headerlink" href="#old-sqlite-and-case-expressions" title="Permalink to this headline">¶</a></h3>
<p>SQLite 3.6.23.1 and older contains a bug when <a class="reference external" href="https://code.djangoproject.com/ticket/24148">handling query parameters</a> in
a <code class="docutils literal"><span class="pre">CASE</span></code> expression that contains an <code class="docutils literal"><span class="pre">ELSE</span></code> and arithmetic.</p>
<p>SQLite 3.6.23.1 was released in March 2010, and most current binary
distributions for different platforms include a newer version of SQLite, with
the notable exception of the Python 2.7 installers for Windows.</p>
<p>As of this writing, the latest release for Windows - Python 2.7.9 - includes
SQLite 3.6.21. You can install <code class="docutils literal"><span class="pre">pysqlite2</span></code> or replace <code class="docutils literal"><span class="pre">sqlite3.dll</span></code> (by
default installed in <code class="docutils literal"><span class="pre">C:\Python27\DLLs</span></code>) with a newer version from
<a class="reference external" href="http://www.sqlite.org/">http://www.sqlite.org/</a> to remedy this issue.</p>
</div>
<div class="section" id="using-newer-versions-of-the-sqlite-db-api-2-0-driver">
<span id="using-newer-versions-of-pysqlite"></span><h3>Using newer versions of the SQLite DB-API 2.0 driver<a class="headerlink" href="#using-newer-versions-of-the-sqlite-db-api-2-0-driver" title="Permalink to this headline">¶</a></h3>
<p>Django will use a <code class="docutils literal"><span class="pre">pysqlite2</span></code> module in preference to <code class="docutils literal"><span class="pre">sqlite3</span></code> as shipped
with the Python standard library if it finds one is available.</p>
<p>This provides the ability to upgrade both the DB-API 2.0 interface or SQLite 3
itself to versions newer than the ones included with your particular Python
binary distribution, if needed.</p>
</div>
<div class="section" id="database-is-locked-errors">
<h3>&#8220;Database is locked&#8221; errors<a class="headerlink" href="#database-is-locked-errors" title="Permalink to this headline">¶</a></h3>
<p>SQLite is meant to be a lightweight database, and thus can&#8217;t support a high
level of concurrency. <code class="docutils literal"><span class="pre">OperationalError:</span> <span class="pre">database</span> <span class="pre">is</span> <span class="pre">locked</span></code> errors indicate
that your application is experiencing more concurrency than <code class="docutils literal"><span class="pre">sqlite</span></code> can
handle in default configuration. This error means that one thread or process has
an exclusive lock on the database connection and another thread timed out
waiting for the lock the be released.</p>
<p>Python&#8217;s SQLite wrapper has
a default timeout value that determines how long the second thread is allowed to
wait on the lock before it times out and raises the <code class="docutils literal"><span class="pre">OperationalError:</span> <span class="pre">database</span>
<span class="pre">is</span> <span class="pre">locked</span></code> error.</p>
<p>If you&#8217;re getting this error, you can solve it by:</p>
<ul>
<li><p class="first">Switching to another database backend. At a certain point SQLite becomes
too &#8220;lite&#8221; for real-world applications, and these sorts of concurrency
errors indicate you&#8217;ve reached that point.</p>
</li>
<li><p class="first">Rewriting your code to reduce concurrency and ensure that database
transactions are short-lived.</p>
</li>
<li><p class="first">Increase the default timeout value by setting the <code class="docutils literal"><span class="pre">timeout</span></code> database
option option:</p>
<div class="highlight-python"><div class="highlight"><pre>&#39;OPTIONS&#39;: {
    # ...
    &#39;timeout&#39;: 20,
    # ...
}
</pre></div>
</div>
<p>This will simply make SQLite wait a bit longer before throwing &#8220;database
is locked&#8221; errors; it won&#8217;t really do anything to solve them.</p>
</li>
</ul>
</div>
<div class="section" id="queryset-select-for-update-not-supported">
<h3><code class="docutils literal"><span class="pre">QuerySet.select_for_update()</span></code> not supported<a class="headerlink" href="#queryset-select-for-update-not-supported" title="Permalink to this headline">¶</a></h3>
<p>SQLite does not support the <code class="docutils literal"><span class="pre">SELECT</span> <span class="pre">...</span> <span class="pre">FOR</span> <span class="pre">UPDATE</span></code> syntax. Calling it will
have no effect.</p>
</div>
<div class="section" id="pyformat-parameter-style-in-raw-queries-not-supported">
<h3>&#8220;pyformat&#8221; parameter style in raw queries not supported<a class="headerlink" href="#pyformat-parameter-style-in-raw-queries-not-supported" title="Permalink to this headline">¶</a></h3>
<p>For most backends, raw queries (<code class="docutils literal"><span class="pre">Manager.raw()</span></code> or <code class="docutils literal"><span class="pre">cursor.execute()</span></code>)
can use the &#8220;pyformat&#8221; parameter style, where placeholders in the query
are given as <code class="docutils literal"><span class="pre">'%(name)s'</span></code> and the parameters are passed as a dictionary
rather than a list. SQLite does not support this.</p>
</div>
<div class="section" id="parameters-not-quoted-in-connection-queries">
<span id="sqlite-connection-queries"></span><h3>Parameters not quoted in <code class="docutils literal"><span class="pre">connection.queries</span></code><a class="headerlink" href="#parameters-not-quoted-in-connection-queries" title="Permalink to this headline">¶</a></h3>
<p><code class="docutils literal"><span class="pre">sqlite3</span></code> does not provide a way to retrieve the SQL after quoting and
substituting the parameters. Instead, the SQL in <code class="docutils literal"><span class="pre">connection.queries</span></code> is
rebuilt with a simple string interpolation. It may be incorrect. Make sure
you add quotes where necessary before copying a query into an SQLite shell.</p>
</div>
</div>
<div class="section" id="oracle-notes">
<span id="id12"></span><h2>Oracle notes<a class="headerlink" href="#oracle-notes" title="Permalink to this headline">¶</a></h2>
<p>Django supports <a class="reference external" href="http://www.oracle.com/">Oracle Database Server</a> versions 11.1 and higher. Version
4.3.1 or higher of the <a class="reference external" href="http://cx-oracle.sourceforge.net/">cx_Oracle</a> Python driver is required, although we
recommend version 5.1.3 or later as these versions support Python 3.</p>
<p>Note that due to a Unicode-corruption bug in <code class="docutils literal"><span class="pre">cx_Oracle</span></code> 5.0, that
version of the driver should <strong>not</strong> be used with Django;
<code class="docutils literal"><span class="pre">cx_Oracle</span></code> 5.0.1 resolved this issue, so if you&#8217;d like to use a
more recent <code class="docutils literal"><span class="pre">cx_Oracle</span></code>, use version 5.0.1.</p>
<p><code class="docutils literal"><span class="pre">cx_Oracle</span></code> 5.0.1 or greater can optionally be compiled with the
<code class="docutils literal"><span class="pre">WITH_UNICODE</span></code> environment variable.  This is recommended but not
required.</p>
<p>In order for the <code class="docutils literal"><span class="pre">python</span> <span class="pre">manage.py</span> <span class="pre">migrate</span></code> command to work, your Oracle
database user must have privileges to run the following commands:</p>
<ul class="simple">
<li>CREATE TABLE</li>
<li>CREATE SEQUENCE</li>
<li>CREATE PROCEDURE</li>
<li>CREATE TRIGGER</li>
</ul>
<p>To run a project&#8217;s test suite, the user usually needs these <em>additional</em>
privileges:</p>
<ul class="simple">
<li>CREATE USER</li>
<li>DROP USER</li>
<li>CREATE TABLESPACE</li>
<li>DROP TABLESPACE</li>
<li>CREATE SESSION WITH ADMIN OPTION</li>
<li>CREATE TABLE WITH ADMIN OPTION</li>
<li>CREATE SEQUENCE WITH ADMIN OPTION</li>
<li>CREATE PROCEDURE WITH ADMIN OPTION</li>
<li>CREATE TRIGGER WITH ADMIN OPTION</li>
</ul>
<p>Note that, while the RESOURCE role has the required CREATE TABLE, CREATE
SEQUENCE, CREATE PROCEDURE and CREATE TRIGGER privileges, and a user
granted RESOURCE WITH ADMIN OPTION can grant RESOURCE, such a user cannot
grant the individual privileges (e.g. CREATE TABLE), and thus RESOURCE
WITH ADMIN OPTION is not usually sufficient for running tests.</p>
<p>Some test suites also create views; to run these, the user also needs
the CREATE VIEW WITH ADMIN OPTION privilege. In particular, this is needed
for Django&#8217;s own test suite.</p>
<p>All of these privileges are included in the DBA role, which is appropriate
for use on a private developer&#8217;s database.</p>
<p>The Oracle database backend uses the <code class="docutils literal"><span class="pre">SYS.DBMS_LOB</span></code> package, so your user
will require execute permissions on it. It&#8217;s normally accessible to all users
by default, but in case it is not, you&#8217;ll need to grant permissions like so:</p>
<div class="highlight-sql"><div class="highlight"><pre><span class="k">GRANT</span> <span class="k">EXECUTE</span> <span class="k">ON</span> <span class="n">SYS</span><span class="p">.</span><span class="n">DBMS_LOB</span> <span class="k">TO</span> <span class="k">user</span><span class="p">;</span>
</pre></div>
</div>
<div class="section" id="id13">
<h3>Connecting to the database<a class="headerlink" href="#id13" title="Permalink to this headline">¶</a></h3>
<p>To connect using the service name of your Oracle database, your <code class="docutils literal"><span class="pre">settings.py</span></code>
file should look something like this:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">DATABASES</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s">&#39;default&#39;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s">&#39;ENGINE&#39;</span><span class="p">:</span> <span class="s">&#39;django.db.backends.oracle&#39;</span><span class="p">,</span>
        <span class="s">&#39;NAME&#39;</span><span class="p">:</span> <span class="s">&#39;xe&#39;</span><span class="p">,</span>
        <span class="s">&#39;USER&#39;</span><span class="p">:</span> <span class="s">&#39;a_user&#39;</span><span class="p">,</span>
        <span class="s">&#39;PASSWORD&#39;</span><span class="p">:</span> <span class="s">&#39;a_password&#39;</span><span class="p">,</span>
        <span class="s">&#39;HOST&#39;</span><span class="p">:</span> <span class="s">&#39;&#39;</span><span class="p">,</span>
        <span class="s">&#39;PORT&#39;</span><span class="p">:</span> <span class="s">&#39;&#39;</span><span class="p">,</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>In this case, you should leave both <code class="docutils literal"><span class="pre">HOST</span></code> and <code class="docutils literal"><span class="pre">PORT</span></code> empty.
However, if you don&#8217;t use a <code class="docutils literal"><span class="pre">tnsnames.ora</span></code> file or a similar naming method
and want to connect using the SID (&#8220;xe&#8221; in this example), then fill in both
<code class="docutils literal"><span class="pre">HOST</span></code> and <code class="docutils literal"><span class="pre">PORT</span></code> like so:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">DATABASES</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s">&#39;default&#39;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s">&#39;ENGINE&#39;</span><span class="p">:</span> <span class="s">&#39;django.db.backends.oracle&#39;</span><span class="p">,</span>
        <span class="s">&#39;NAME&#39;</span><span class="p">:</span> <span class="s">&#39;xe&#39;</span><span class="p">,</span>
        <span class="s">&#39;USER&#39;</span><span class="p">:</span> <span class="s">&#39;a_user&#39;</span><span class="p">,</span>
        <span class="s">&#39;PASSWORD&#39;</span><span class="p">:</span> <span class="s">&#39;a_password&#39;</span><span class="p">,</span>
        <span class="s">&#39;HOST&#39;</span><span class="p">:</span> <span class="s">&#39;dbprod01ned.mycompany.com&#39;</span><span class="p">,</span>
        <span class="s">&#39;PORT&#39;</span><span class="p">:</span> <span class="s">&#39;1540&#39;</span><span class="p">,</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>You should either supply both <code class="docutils literal"><span class="pre">HOST</span></code> and <code class="docutils literal"><span class="pre">PORT</span></code>, or leave
both as empty strings. Django will use a different connect descriptor depending
on that choice.</p>
</div>
<div class="section" id="threaded-option">
<h3>Threaded option<a class="headerlink" href="#threaded-option" title="Permalink to this headline">¶</a></h3>
<p>If you plan to run Django in a multithreaded environment (e.g. Apache using the
default MPM module on any modern operating system), then you <strong>must</strong> set
the <code class="docutils literal"><span class="pre">threaded</span></code> option of your Oracle database configuration to True:</p>
<div class="highlight-python"><div class="highlight"><pre>&#39;OPTIONS&#39;: {
    &#39;threaded&#39;: True,
},
</pre></div>
</div>
<p>Failure to do this may result in crashes and other odd behavior.</p>
</div>
<div class="section" id="insert-returning-into">
<h3>INSERT ... RETURNING INTO<a class="headerlink" href="#insert-returning-into" title="Permalink to this headline">¶</a></h3>
<p>By default, the Oracle backend uses a <code class="docutils literal"><span class="pre">RETURNING</span> <span class="pre">INTO</span></code> clause to efficiently
retrieve the value of an <code class="docutils literal"><span class="pre">AutoField</span></code> when inserting new rows.  This behavior
may result in a <code class="docutils literal"><span class="pre">DatabaseError</span></code> in certain unusual setups, such as when
inserting into a remote table, or into a view with an <code class="docutils literal"><span class="pre">INSTEAD</span> <span class="pre">OF</span></code> trigger.
The <code class="docutils literal"><span class="pre">RETURNING</span> <span class="pre">INTO</span></code> clause can be disabled by setting the
<code class="docutils literal"><span class="pre">use_returning_into</span></code> option of the database configuration to False:</p>
<div class="highlight-python"><div class="highlight"><pre>&#39;OPTIONS&#39;: {
    &#39;use_returning_into&#39;: False,
},
</pre></div>
</div>
<p>In this case, the Oracle backend will use a separate <code class="docutils literal"><span class="pre">SELECT</span></code> query to
retrieve AutoField values.</p>
</div>
<div class="section" id="naming-issues">
<h3>Naming issues<a class="headerlink" href="#naming-issues" title="Permalink to this headline">¶</a></h3>
<p>Oracle imposes a name length limit of 30 characters. To accommodate this, the
backend truncates database identifiers to fit, replacing the final four
characters of the truncated name with a repeatable MD5 hash value.
Additionally, the backend turns database identifiers to all-uppercase.</p>
<p>To prevent these transformations (this is usually required only when dealing
with legacy databases or accessing tables which belong to other users), use
a quoted name as the value for <code class="docutils literal"><span class="pre">db_table</span></code>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">class</span> <span class="nc">LegacyModel</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="k">class</span> <span class="nc">Meta</span><span class="p">:</span>
        <span class="n">db_table</span> <span class="o">=</span> <span class="s">&#39;&quot;name_left_in_lowercase&quot;&#39;</span>

<span class="k">class</span> <span class="nc">ForeignModel</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="k">class</span> <span class="nc">Meta</span><span class="p">:</span>
        <span class="n">db_table</span> <span class="o">=</span> <span class="s">&#39;&quot;OTHER_USER&quot;.&quot;NAME_ONLY_SEEMS_OVER_30&quot;&#39;</span>
</pre></div>
</div>
<p>Quoted names can also be used with Django&#8217;s other supported database
backends; except for Oracle, however, the quotes have no effect.</p>
<p>When running <code class="docutils literal"><span class="pre">migrate</span></code>, an <code class="docutils literal"><span class="pre">ORA-06552</span></code> error may be encountered if
certain Oracle keywords are used as the name of a model field or the
value of a <code class="docutils literal"><span class="pre">db_column</span></code> option.  Django quotes all identifiers used
in queries to prevent most such problems, but this error can still
occur when an Oracle datatype is used as a column name.  In
particular, take care to avoid using the names <code class="docutils literal"><span class="pre">date</span></code>,
<code class="docutils literal"><span class="pre">timestamp</span></code>, <code class="docutils literal"><span class="pre">number</span></code> or <code class="docutils literal"><span class="pre">float</span></code> as a field name.</p>
</div>
<div class="section" id="null-and-empty-strings">
<h3>NULL and empty strings<a class="headerlink" href="#null-and-empty-strings" title="Permalink to this headline">¶</a></h3>
<p>Django generally prefers to use the empty string (&#8216;&#8217;) rather than
NULL, but Oracle treats both identically. To get around this, the
Oracle backend ignores an explicit <code class="docutils literal"><span class="pre">null</span></code> option on fields that
have the empty string as a possible value and generates DDL as if
<code class="docutils literal"><span class="pre">null=True</span></code>. When fetching from the database, it is assumed that
a <code class="docutils literal"><span class="pre">NULL</span></code> value in one of these fields really means the empty
string, and the data is silently converted to reflect this assumption.</p>
</div>
<div class="section" id="textfield-limitations">
<h3><code class="docutils literal"><span class="pre">TextField</span></code> limitations<a class="headerlink" href="#textfield-limitations" title="Permalink to this headline">¶</a></h3>
<p>The Oracle backend stores <code class="docutils literal"><span class="pre">TextFields</span></code> as <code class="docutils literal"><span class="pre">NCLOB</span></code> columns. Oracle imposes
some limitations on the usage of such LOB columns in general:</p>
<ul class="simple">
<li>LOB columns may not be used as primary keys.</li>
<li>LOB columns may not be used in indexes.</li>
<li>LOB columns may not be used in a <code class="docutils literal"><span class="pre">SELECT</span> <span class="pre">DISTINCT</span></code> list. This means that
attempting to use the <code class="docutils literal"><span class="pre">QuerySet.distinct</span></code> method on a model that
includes <code class="docutils literal"><span class="pre">TextField</span></code> columns will result in an error when run against
Oracle. As a workaround, use the <code class="docutils literal"><span class="pre">QuerySet.defer</span></code> method in conjunction
with <code class="docutils literal"><span class="pre">distinct()</span></code> to prevent <code class="docutils literal"><span class="pre">TextField</span></code> columns from being included in
the <code class="docutils literal"><span class="pre">SELECT</span> <span class="pre">DISTINCT</span></code> list.</li>
</ul>
</div>
</div>
<div class="section" id="using-a-3rd-party-database-backend">
<span id="third-party-notes"></span><h2>Using a 3rd-party database backend<a class="headerlink" href="#using-a-3rd-party-database-backend" title="Permalink to this headline">¶</a></h2>
<p>In addition to the officially supported databases, there are backends provided
by 3rd parties that allow you to use other databases with Django:</p>
<ul class="simple">
<li><a class="reference external" href="https://github.com/sqlanywhere/sqlany-django">SAP SQL Anywhere</a></li>
<li><a class="reference external" href="http://code.google.com/p/ibm-db/">IBM DB2</a></li>
<li><a class="reference external" href="http://django-mssql.readthedocs.org/en/latest/">Microsoft SQL Server</a></li>
<li><a class="reference external" href="https://github.com/maxirobaina/django-firebird">Firebird</a></li>
<li><a class="reference external" href="https://github.com/lionheart/django-pyodbc/">ODBC</a></li>
<li><a class="reference external" href="http://code.google.com/p/adsdb-django/">ADSDB</a></li>
</ul>
<p>The Django versions and ORM features supported by these unofficial backends
vary considerably. Queries regarding the specific capabilities of these
unofficial backends, along with any support queries, should be directed to
the support channels provided by each 3rd party project.</p>
</div>
<div class="section" id="integrating-django-with-a-legacy-database">
<h2>Integrating Django with a legacy database<a class="headerlink" href="#integrating-django-with-a-legacy-database" title="Permalink to this headline">¶</a></h2>
<p>While Django is best suited for developing new applications, it&#8217;s quite
possible to integrate it into legacy databases. Django includes a couple of
utilities to automate as much of this process as possible.</p>
<p>Once you&#8217;ve got Django set up, you&#8217;ll follow this general process to integrate
with an existing database.</p>
<div class="section" id="give-django-your-database-parameters">
<h3>Give Django your database parameters<a class="headerlink" href="#give-django-your-database-parameters" title="Permalink to this headline">¶</a></h3>
<p>You&#8217;ll need to tell Django what your database connection parameters are, and
what the name of the database is. Do that by editing the <code class="docutils literal"><span class="pre">DATABASES</span></code>
setting and assigning values to the following keys for the <code class="docutils literal"><span class="pre">'default'</span></code>
connection:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">NAME</span></code></li>
<li><code class="docutils literal"><span class="pre">ENGINE</span> <span class="pre">&lt;DATABASE-ENGINE&gt;</span></code></li>
<li><code class="docutils literal"><span class="pre">USER</span></code></li>
<li><code class="docutils literal"><span class="pre">PASSWORD</span></code></li>
<li><code class="docutils literal"><span class="pre">HOST</span></code></li>
<li><code class="docutils literal"><span class="pre">PORT</span></code></li>
</ul>
</div>
<div class="section" id="auto-generate-the-models">
<h3>Auto-generate the models<a class="headerlink" href="#auto-generate-the-models" title="Permalink to this headline">¶</a></h3>
<p>Django comes with a utility called <code class="docutils literal"><span class="pre">inspectdb</span></code> that can create models
by introspecting an existing database. You can view the output by running this
command:</p>
<div class="highlight-python"><div class="highlight"><pre>$ python manage.py inspectdb
</pre></div>
</div>
<p>Save this as a file by using standard Unix output redirection:</p>
<div class="highlight-python"><div class="highlight"><pre>$ python manage.py inspectdb &gt; models.py
</pre></div>
</div>
<p>This feature is meant as a shortcut, not as definitive model generation. See the
<code class="docutils literal"><span class="pre">documentation</span> <span class="pre">of</span> <span class="pre">inspectdb</span> <span class="pre">&lt;inspectdb&gt;</span></code> for more information.</p>
<p>Once you&#8217;ve cleaned up your models, name the file <code class="docutils literal"><span class="pre">models.py</span></code> and put it in
the Python package that holds your app. Then add the app to your
<code class="docutils literal"><span class="pre">INSTALLED_APPS</span></code> setting.</p>
<p>By default, <code class="docutils literal"><span class="pre">inspectdb</span></code> creates unmanaged models. That is,
<code class="docutils literal"><span class="pre">managed</span> <span class="pre">=</span> <span class="pre">False</span></code> in the model&#8217;s <code class="docutils literal"><span class="pre">Meta</span></code> class tells Django not to manage
each table&#8217;s creation, modification, and deletion:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">class</span> <span class="nc">Person</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="nb">id</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">IntegerField</span><span class="p">(</span><span class="n">primary_key</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">first_name</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">70</span><span class="p">)</span>
    <span class="k">class</span> <span class="nc">Meta</span><span class="p">:</span>
       <span class="n">managed</span> <span class="o">=</span> <span class="bp">False</span>
       <span class="n">db_table</span> <span class="o">=</span> <span class="s">&#39;CENSUS_PERSONS&#39;</span>
</pre></div>
</div>
<p>If you do want to allow Django to manage the table&#8217;s lifecycle, you&#8217;ll need to
change the <a class="reference internal" href="appendix_A.html#django.db.models.Options.managed" title="django.db.models.Options.managed"><code class="xref py py-attr docutils literal"><span class="pre">managed</span></code></a> option above to <code class="docutils literal"><span class="pre">True</span></code>
(or simply remove it because <code class="docutils literal"><span class="pre">True</span></code> is its default value).</p>
</div>
<div class="section" id="install-the-core-django-tables">
<h3>Install the core Django tables<a class="headerlink" href="#install-the-core-django-tables" title="Permalink to this headline">¶</a></h3>
<p>Next, run the <code class="docutils literal"><span class="pre">migrate</span></code> command to install any extra needed database
records such as admin permissions and content types:</p>
<div class="highlight-python"><div class="highlight"><pre>$ python manage.py migrate
</pre></div>
</div>
</div>
<div class="section" id="cleaning-up-generated-models">
<h3>Cleaning Up Generated Models<a class="headerlink" href="#cleaning-up-generated-models" title="Permalink to this headline">¶</a></h3>
<p>As you might expect, the database introspection isn&#8217;t perfect, and you&#8217;ll need
to do some light cleanup of the resulting model code. Here are a few pointers
for dealing with the generated models:</p>
<ol class="arabic">
<li><p class="first">Each database table is converted to a model class (i.e., there is a
one-to-one mapping between database tables and model classes). This means
that you&#8217;ll need to refactor the models for any many-to-many join tables
into <code class="docutils literal"><span class="pre">ManyToManyField</span></code> objects.</p>
</li>
<li><p class="first">Each generated model has an attribute for every field, including
<code class="docutils literal"><span class="pre">id</span></code> primary key fields. However, recall that Django automatically
adds an <code class="docutils literal"><span class="pre">id</span></code> primary key field if a model doesn&#8217;t have a primary key.
Thus, you&#8217;ll want to remove any lines that look like this:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="nb">id</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">IntegerField</span><span class="p">(</span><span class="n">primary_key</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></div>
</div>
<p>Not only are these lines redundant, but also they can cause problems if your
application will be adding <em>new</em> records to these tables.</p>
</li>
<li><p class="first">Each field&#8217;s type (e.g., <code class="docutils literal"><span class="pre">CharField</span></code>, <code class="docutils literal"><span class="pre">DateField</span></code>) is determined by
looking at the database column type (e.g., <code class="docutils literal"><span class="pre">VARCHAR</span></code>, <code class="docutils literal"><span class="pre">DATE</span></code>). If
<code class="docutils literal"><span class="pre">inspectdb</span></code> cannot map a column&#8217;s type to a model field type, it will
use <code class="docutils literal"><span class="pre">TextField</span></code> and will insert the Python comment
<code class="docutils literal"><span class="pre">'This</span> <span class="pre">field</span> <span class="pre">type</span> <span class="pre">is</span> <span class="pre">a</span> <span class="pre">guess.'</span></code> next to the field in the generated
model. Keep an eye out for that, and change the field type accordingly
if needed.</p>
<p>If a field in your database has no good Django equivalent, you can
safely leave it off. The Django model layer is not required to include
every field in your table(s).</p>
</li>
<li><p class="first">If a database column name is a Python reserved word (such as <code class="docutils literal"><span class="pre">pass</span></code>,
<code class="docutils literal"><span class="pre">class</span></code>, or <code class="docutils literal"><span class="pre">for</span></code>), <code class="docutils literal"><span class="pre">inspectdb</span></code> will append <code class="docutils literal"><span class="pre">'_field'</span></code> to the
attribute name and set the <code class="docutils literal"><span class="pre">db_column</span></code> attribute to the real field
name (e.g., <code class="docutils literal"><span class="pre">pass</span></code>, <code class="docutils literal"><span class="pre">class</span></code>, or <code class="docutils literal"><span class="pre">for</span></code>).</p>
<p>For example, if a table has an <code class="docutils literal"><span class="pre">INT</span></code> column called <code class="docutils literal"><span class="pre">for</span></code>, the generated
model will have a field like this:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">for_field</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">IntegerField</span><span class="p">(</span><span class="n">db_column</span><span class="o">=</span><span class="s">&#39;for&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p><code class="docutils literal"><span class="pre">inspectdb</span></code> will insert the Python comment
<code class="docutils literal"><span class="pre">'Field</span> <span class="pre">renamed</span> <span class="pre">because</span> <span class="pre">it</span> <span class="pre">was</span> <span class="pre">a</span> <span class="pre">Python</span> <span class="pre">reserved</span> <span class="pre">word.'</span></code> next to the
field.</p>
</li>
<li><p class="first">If your database contains tables that refer to other tables (as most
databases do), you might need to rearrange the order of the generated
models so that models that refer to other models are ordered properly.
For example, if model <code class="docutils literal"><span class="pre">Book</span></code> has a <code class="docutils literal"><span class="pre">ForeignKey</span></code> to model <code class="docutils literal"><span class="pre">Author</span></code>,
model <code class="docutils literal"><span class="pre">Author</span></code> should be defined before model <code class="docutils literal"><span class="pre">Book</span></code>.  If you need
to create a relationship on a model that has not yet been defined, you
can use a string containing the name of the model, rather than the model
object itself.</p>
</li>
<li><p class="first"><code class="docutils literal"><span class="pre">inspectdb</span></code> detects primary keys for PostgreSQL, MySQL, and SQLite.
That is, it inserts <code class="docutils literal"><span class="pre">primary_key=True</span></code> where appropriate. For other
databases, you&#8217;ll need to insert <code class="docutils literal"><span class="pre">primary_key=True</span></code> for at least one
field in each model, because Django models are required to have a
<code class="docutils literal"><span class="pre">primary_key=True</span></code> field.</p>
</li>
<li><p class="first">Foreign-key detection only works with PostgreSQL and with certain types
of MySQL tables. In other cases, foreign-key fields will be generated as
<code class="docutils literal"><span class="pre">IntegerField``s,</span> <span class="pre">assuming</span> <span class="pre">the</span> <span class="pre">foreign-key</span> <span class="pre">column</span> <span class="pre">was</span> <span class="pre">an</span> <span class="pre">``INT</span></code>
column.</p>
</li>
</ol>
</div>
<div class="section" id="test-and-tweak">
<h3>Test and tweak<a class="headerlink" href="#test-and-tweak" title="Permalink to this headline">¶</a></h3>
<p>Those are the basic steps &#8211; from here you&#8217;ll want to tweak the models Django
generated until they work the way you&#8217;d like. Try accessing your data via the
Django database API, and try editing objects via Django&#8217;s admin site, and edit
the models file accordingly.</p>
</div>
</div>
</div>


          </div>
        </div>
      </div>
        </div>
        <div class="sidebar">
          <h3>Table Of Contents</h3>
          <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="front_matter.html">Frontmatter</a></li>
<li class="toctree-l1"><a class="reference internal" href="introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="introduction_django.html">Introduction to Django</a></li>
<li class="toctree-l1"><a class="reference internal" href="chapter_01.html">Chapter 1: Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="chapter_02.html">Chapter 2: Views and URLconfs</a></li>
<li class="toctree-l1"><a class="reference internal" href="chapter_03.html">Chapter 3: Templates</a></li>
<li class="toctree-l1"><a class="reference internal" href="chapter_04.html">Chapter 4: Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="chapter_05.html">Chapter 5: The Django Admin Site</a></li>
<li class="toctree-l1"><a class="reference internal" href="chapter_06.html">Chapter 6: Forms</a></li>
<li class="toctree-l1"><a class="reference internal" href="chapter_07.html">Chapter 7: Advanced Views and URLconfs</a></li>
<li class="toctree-l1"><a class="reference internal" href="chapter_08.html">Chapter 8: Advanced Templates</a></li>
<li class="toctree-l1"><a class="reference internal" href="chapter_09.html">Chapter 9: Advanced Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="chapter_10.html">Chapter 10: Generic Views</a></li>
<li class="toctree-l1"><a class="reference internal" href="chapter_11.html">Chapter 11: User authentication in Django</a></li>
<li class="toctree-l1"><a class="reference internal" href="chapter_12.html">Chapter 12 - testing in Django</a></li>
<li class="toctree-l1"><a class="reference internal" href="chapter_13.html">Chapter 13: Deploying Django</a></li>
<li class="toctree-l1"><a class="reference internal" href="chapter_14.html">Chapter 14 - How to write reusable apps</a></li>
<li class="toctree-l1"><a class="reference internal" href="chapter_15.html">Chapter 15: Generating Non-HTML Content</a></li>
<li class="toctree-l1"><a class="reference internal" href="chapter_16.html">Chapter 16 - Django sessions</a></li>
<li class="toctree-l1"><a class="reference internal" href="chapter_17.html">Chapter 17 - Django&#8217;s cache framework</a></li>
<li class="toctree-l1"><a class="reference internal" href="chapter_18.html">Chapter 18 - Other core Django functionalities</a></li>
<li class="toctree-l1"><a class="reference internal" href="chapter_19.html">Chapter 19 - Django Middleware</a></li>
<li class="toctree-l1"><a class="reference internal" href="chapter_20.html">Chapter 20: Internationalization</a></li>
<li class="toctree-l1"><a class="reference internal" href="chapter_21.html">Chapter 21: Security in Django</a></li>
<li class="toctree-l1"><a class="reference internal" href="chapter_22.html">How to install Django</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="">Chapter 23: Advanced database management</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#general-notes">General notes</a></li>
<li class="toctree-l2"><a class="reference internal" href="#postgresql-notes">PostgreSQL notes</a></li>
<li class="toctree-l2"><a class="reference internal" href="#mysql-notes">MySQL notes</a></li>
<li class="toctree-l2"><a class="reference internal" href="#sqlite-notes">SQLite notes</a></li>
<li class="toctree-l2"><a class="reference internal" href="#oracle-notes">Oracle notes</a></li>
<li class="toctree-l2"><a class="reference internal" href="#using-a-3rd-party-database-backend">Using a 3rd-party database backend</a></li>
<li class="toctree-l2"><a class="reference internal" href="#integrating-django-with-a-legacy-database">Integrating Django with a legacy database</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="appendix_A.html">Appendix A: Model Definition Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="appendix_B.html">Appendix B: Database API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="appendix_C.html">Appendix C: Generic View Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="appendix_D.html">Appendix D: Settings</a></li>
<li class="toctree-l1"><a class="reference internal" href="appendix_E.html">Appendix E: Built-in Template Tags and Filters</a></li>
<li class="toctree-l1"><a class="reference internal" href="appendix_F.html">Appendix F: The django-admin Utility</a></li>
<li class="toctree-l1"><a class="reference internal" href="appendix_G.html">Appendix G: Request and Response Objects</a></li>
<li class="toctree-l1"><a class="reference internal" href="license.html">License &amp; Copyright</a></li>
</ul>

          <div role="search">
            <h3 style="margin-top: 1.5em;">Search</h3>
            <form class="search" action="search.html" method="get">
                <input type="text" name="q" />
                <input type="submit" value="Go" />
                <input type="hidden" name="check_keywords" value="yes" />
                <input type="hidden" name="area" value="default" />
            </form>
            <p class="searchtip" style="font-size: 90%">
                Enter search terms or a module, class or function name.
            </p>
          </div>
        </div>
        <div class="clearer"></div>
      </div>
    </div>

    <div class="footer-wrapper">
      <div class="footer">
        <div class="left">
          <div role="navigation" aria-label="related navigaton">
            <a href="chapter_22.html" title="How to install Django"
              >previous</a> |
            <a href="appendix_A.html" title="Appendix A: Model Definition Reference"
              >next</a> |
            <a href="py-modindex.html" title="Python Module Index"
              >modules</a> |
            <a href="genindex.html" title="General Index"
              >index</a>
          </div>
          <div role="note" aria-label="source link">
              <br/>
              <a href="_sources/chapter_23.txt"
                rel="nofollow">Show Source</a>
          </div>
        </div>

        <div class="right">
          
    <div class="footer" role="contentinfo">
        &copy; Copyright 2015, Nigel George.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.3.1.
    </div>
        </div>
        <div class="clearer"></div>
      </div>
    </div>

  </body>
</html>