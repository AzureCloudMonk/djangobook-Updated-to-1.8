<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Chapter 11: User authentication in Django &mdash; Mastering Django</title>
    
    <link rel="stylesheet" href="_static/agogo.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '0.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="Mastering Django" href="index.html" />
    <link rel="next" title="Chapter 12 - testing in Django" href="chapter_12.html" />
    <link rel="prev" title="Chapter 10: Generic Views" href="chapter_10.html" /> 
  </head>
  <body role="document">
    <div class="header-wrapper" role="banner">
      <div class="header">
        <div class="headertitle"><a
          href="index.html">Mastering Django</a></div>
        <div class="rel" role="navigation" aria-label="related navigation">
          <a href="chapter_10.html" title="Chapter 10: Generic Views"
             accesskey="P">previous</a> |
          <a href="chapter_12.html" title="Chapter 12 - testing in Django"
             accesskey="N">next</a> |
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a>
        </div>
       </div>
    </div>

    <div class="content-wrapper">
      <div class="content">
        <div class="document">
            
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="chapter-11-user-authentication-in-django">
<h1>Chapter 11: User authentication in Django<a class="headerlink" href="#chapter-11-user-authentication-in-django" title="Permalink to this headline">¶</a></h1>
<p>A significant percentage of modern, interactive websites allow some form of
user interaction - from allowing simple comments on a blog, to full editorial
control of articles on a news site. If a site offers any sort of eCommerce,
authentication and authorization of paying customers is essential.</p>
<p>Just managing users &#8211; lost usernames, forgotten passwords and keeping
information up to date &#8211; can be a real pain. As a programmer, writing an
authentication system can be even worse.</p>
<p>Lucky for us, Django comes with a user authentication system installed
automatically for your convenience when your ran <code class="docutils literal"><span class="pre">django-admin</span>
<span class="pre">startproject</span></code>.</p>
<p>Django provides a default implementation for managing user accounts, groups,
permissions and cookie-based user sessions out of the box.</p>
<p>Like most things in Django, the default implementation is fully extendible and
customizable to suit your project&#8217;s needs. So let&#8217;s jump right in.</p>
<div class="section" id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Permalink to this headline">¶</a></h2>
<p>The Django authentication system handles both authentication and authorization.
Briefly, authentication verifies a user is who they claim to be, and
authorization determines what an authenticated user is allowed to do. Here the
term authentication is used to refer to both tasks.</p>
<p>The auth system consists of:</p>
<ul class="simple">
<li>Users</li>
<li>Permissions: Binary (yes/no) flags designating whether a user may perform
a certain task</li>
<li>Groups: A generic way of applying labels and permissions to more than one
user</li>
<li>A configurable password hashing system</li>
<li>Forms and view tools for logging in users, or restricting content</li>
<li>A pluggable backend system</li>
</ul>
<p>The authentication system in Django aims to be very generic and doesn&#8217;t provide
some features commonly found in web authentication systems. Solutions for some
of these common problems have been implemented in third-party packages:</p>
<ul class="simple">
<li>Password strength checking</li>
<li>Throttling of login attempts</li>
<li>Authentication against third-parties (OAuth, for example)</li>
</ul>
</div>
<div class="section" id="using-the-django-authentication-system">
<h2>Using the Django authentication system<a class="headerlink" href="#using-the-django-authentication-system" title="Permalink to this headline">¶</a></h2>
<p>Django&#8217;s authentication system in its default configuration has evolved to
serve the most common project needs, handling a reasonably wide range of
tasks, and has a careful implementation of passwords and permissions. For
projects where authentication needs differ from the default, Django also supports
extensive extension and customization of authentication.</p>
</div>
<div class="section" id="user-objects">
<span id="id1"></span><h2>User objects<a class="headerlink" href="#user-objects" title="Permalink to this headline">¶</a></h2>
<p><code class="xref py py-class docutils literal"><span class="pre">User</span></code> objects are the core of the
authentication system. They typically represent the people interacting with
your site and are used to enable things like restricting access, registering
user profiles, associating content with creators etc. Only one class of user
exists in Django&#8217;s authentication framework, i.e., <code class="xref py py-attr docutils literal"><span class="pre">'superusers'</span></code> or admin <code class="xref py py-attr docutils literal"><span class="pre">'staff'</span></code> users are just user objects with
special attributes set, not different classes of user objects.</p>
<p>The primary attributes of the default user are:</p>
<ul class="simple">
<li><code class="xref py py-attr docutils literal"><span class="pre">username</span></code></li>
<li><code class="xref py py-attr docutils literal"><span class="pre">password</span></code></li>
<li><code class="xref py py-attr docutils literal"><span class="pre">email</span></code></li>
<li><code class="xref py py-attr docutils literal"><span class="pre">first_name</span></code></li>
<li><code class="xref py py-attr docutils literal"><span class="pre">last_name</span></code></li>
</ul>
<div class="section" id="creating-users">
<span id="topics-auth-creating-users"></span><h3>Creating users<a class="headerlink" href="#creating-users" title="Permalink to this headline">¶</a></h3>
<p>The simplest, and least error prone way to create and manage users is through
the Django admin. Django also provides built in views and forms to allow users
to log in and out and change their own password.</p>
<p>We will be looking at user management via the admin and generic user forms a
bit later in this chapter, but first, lets look at how we would handle user
authentication directly.</p>
<p>The most direct way to create users is to use the included
<code class="xref py py-meth docutils literal"><span class="pre">create_user()</span></code> helper function:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">django.contrib.auth.models</span> <span class="kn">import</span> <span class="n">User</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">user</span> <span class="o">=</span> <span class="n">User</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">create_user</span><span class="p">(</span><span class="s">&#39;john&#39;</span><span class="p">,</span> <span class="s">&#39;lennon@thebeatles.com&#39;</span><span class="p">,</span> <span class="s">&#39;johnpassword&#39;</span><span class="p">)</span>

<span class="go"># At this point, user is a User object that has already been saved</span>
<span class="go"># to the database. You can continue to change its attributes</span>
<span class="go"># if you want to change other fields.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">user</span><span class="o">.</span><span class="n">last_name</span> <span class="o">=</span> <span class="s">&#39;Lennon&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">user</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="section" id="creating-superusers">
<span id="topics-auth-creating-superusers"></span><h3>Creating superusers<a class="headerlink" href="#creating-superusers" title="Permalink to this headline">¶</a></h3>
<p>Create superusers using the <code class="docutils literal"><span class="pre">createsuperuser</span></code> command:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>python manage.py createsuperuser --username<span class="o">=</span>joe --email<span class="o">=</span>joe@example.com
</pre></div>
</div>
<p>You will be prompted for a password. After you enter one, the user will be
created immediately. If you leave off the <code class="docutils literal"><span class="pre">--username</span></code> or the
<code class="docutils literal"><span class="pre">--email</span></code> options, it will prompt you for those values.</p>
</div>
<div class="section" id="changing-passwords">
<h3>Changing passwords<a class="headerlink" href="#changing-passwords" title="Permalink to this headline">¶</a></h3>
<p>Django does not store raw (clear text) passwords on the user model, but only a
hash. Because of this, do not attempt to manipulate the password attribute of
the user directly. This is why a helper function is used when creating a user.</p>
<p>To change a user&#8217;s password, you have two options:</p>
<p><code class="docutils literal"><span class="pre">manage.py</span> <span class="pre">changepassword</span> <span class="pre">*username*</span> <span class="pre">&lt;changepassword&gt;</span></code> offers a method
of changing a User&#8217;s password from the command line. It prompts you to
change the password of a given user which you must enter twice. If
they both match, the new password will be changed immediately. If you
do not supply a user, the command will attempt to change the password
of the user whose username matches the current system user.</p>
<p>You can also change a password programmatically, using
<code class="xref py py-meth docutils literal"><span class="pre">set_password()</span></code>:</p>
<div class="highlight-pycon"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">django.contrib.auth.models</span> <span class="kn">import</span> <span class="n">User</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">u</span> <span class="o">=</span> <span class="n">User</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">username</span><span class="o">=</span><span class="s">&#39;john&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">u</span><span class="o">.</span><span class="n">set_password</span><span class="p">(</span><span class="s">&#39;new password&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">u</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
</pre></div>
</div>
<p>Changing a user&#8217;s password will log out all their sessions if the
<a class="reference internal" href="chapter_19.html#django.contrib.auth.middleware.SessionAuthenticationMiddleware" title="django.contrib.auth.middleware.SessionAuthenticationMiddleware"><code class="xref py py-class docutils literal"><span class="pre">SessionAuthenticationMiddleware</span></code></a> is
enabled.</p>
</div>
<div class="section" id="authenticating-users">
<h3>Authenticating Users<a class="headerlink" href="#authenticating-users" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="authenticate">
<code class="descname">authenticate</code><span class="sig-paren">(</span><em>**credentials</em><span class="sig-paren">)</span><a class="headerlink" href="#authenticate" title="Permalink to this definition">¶</a></dt>
<dd><p>To authenticate a given username and password, use
<code class="xref py py-func docutils literal"><span class="pre">authenticate()</span></code>. It takes credentials in the
form of keyword arguments, for the default configuration this is
<code class="docutils literal"><span class="pre">username</span></code> and <code class="docutils literal"><span class="pre">password</span></code>, and it returns
a <code class="xref py py-class docutils literal"><span class="pre">User</span></code> object if the password is valid
for the given username. If the password is invalid,
<code class="xref py py-func docutils literal"><span class="pre">authenticate()</span></code> returns <code class="docutils literal"><span class="pre">None</span></code>. Example:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">django.contrib.auth</span> <span class="kn">import</span> <span class="n">authenticate</span>
<span class="n">user</span> <span class="o">=</span> <span class="n">authenticate</span><span class="p">(</span><span class="n">username</span><span class="o">=</span><span class="s">&#39;john&#39;</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="s">&#39;secret&#39;</span><span class="p">)</span>
<span class="k">if</span> <span class="n">user</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
    <span class="c"># the password verified for the user</span>
    <span class="k">if</span> <span class="n">user</span><span class="o">.</span><span class="n">is_active</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&quot;User is valid, active and authenticated&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&quot;The password is valid, but the account has been disabled!&quot;</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="c"># the authentication system was unable to verify the username and password</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&quot;The username and password were incorrect.&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This is a low level way to authenticate a set of credentials; for
example, it&#8217;s used by the
<a class="reference internal" href="chapter_19.html#django.contrib.auth.middleware.RemoteUserMiddleware" title="django.contrib.auth.middleware.RemoteUserMiddleware"><code class="xref py py-class docutils literal"><span class="pre">RemoteUserMiddleware</span></code></a>. Unless
you are writing your own authentication system, you probably won&#8217;t use
this. Rather if you are looking for a way to limit access to logged in
users, see the <a class="reference internal" href="#django.contrib.auth.decorators.login_required" title="django.contrib.auth.decorators.login_required"><code class="xref py py-func docutils literal"><span class="pre">login_required()</span></code></a>
decorator.</p>
</div>
</dd></dl>

</div>
</div>
<div class="section" id="permissions-and-authorization">
<span id="topic-authorization"></span><h2>Permissions and Authorization<a class="headerlink" href="#permissions-and-authorization" title="Permalink to this headline">¶</a></h2>
<p>Django comes with a simple permissions system. It provides a way to assign
permissions to specific users and groups of users.</p>
<p>It&#8217;s used by the Django admin site, but you&#8217;re welcome to use it in your own
code.</p>
<p>The Django admin site uses permissions as follows:</p>
<ul class="simple">
<li>Access to view the &#8220;add&#8221; form and add an object is limited to users with
the &#8220;add&#8221; permission for that type of object</li>
<li>Access to view the change list, view the &#8220;change&#8221; form and change an
object is limited to users with the &#8220;change&#8221; permission for that type of
object</li>
<li>Access to delete an object is limited to users with the &#8220;delete&#8221;
permission for that type of object</li>
</ul>
<p>Permissions can be set not only per type of object, but also per specific
object instance. By using the
<code class="xref py py-meth docutils literal"><span class="pre">has_add_permission()</span></code>,
<code class="xref py py-meth docutils literal"><span class="pre">has_change_permission()</span></code> and
<code class="xref py py-meth docutils literal"><span class="pre">has_delete_permission()</span></code> methods provided
by the <code class="xref py py-class docutils literal"><span class="pre">ModelAdmin</span></code> class, it is possible to
customize permissions for different object instances of the same type.</p>
<p><code class="xref py py-class docutils literal"><span class="pre">User</span></code> objects have two many-to-many
fields: <code class="docutils literal"><span class="pre">groups</span></code> and <code class="docutils literal"><span class="pre">user_permissions</span></code>.
<code class="xref py py-class docutils literal"><span class="pre">User</span></code> objects can access their related
objects in the same way as any other Django model.</p>
<div class="section" id="default-permissions">
<h3>Default permissions<a class="headerlink" href="#default-permissions" title="Permalink to this headline">¶</a></h3>
<p>When <code class="docutils literal"><span class="pre">django.contrib.auth</span></code> is listed in your <code class="docutils literal"><span class="pre">INSTALLED_APPS</span></code>
setting, it will ensure that three default permissions &#8211; add, change and
delete &#8211; are created for each Django model defined in one of your installed
applications.</p>
<p>These permissions will be created when you run <code class="docutils literal"><span class="pre">manage.py</span> <span class="pre">migrate</span></code> the first
time you run <code class="docutils literal"><span class="pre">migrate</span></code> after adding <code class="docutils literal"><span class="pre">django.contrib.auth</span></code> to
<code class="docutils literal"><span class="pre">INSTALLED_APPS</span></code>, the default permissions will be created for all
previously-installed models, as well as for any new models being installed at
that time. Afterward, it will create default permissions for new models each
time you run <code class="docutils literal"><span class="pre">manage.py</span> <span class="pre">migrate</span></code>.</p>
<p>Assuming you have an application with an
<a class="reference internal" href="appendix_A.html#django.db.models.Options.app_label" title="django.db.models.Options.app_label"><code class="xref py py-attr docutils literal"><span class="pre">app_label</span></code></a> <code class="docutils literal"><span class="pre">foo</span></code> and a model named <code class="docutils literal"><span class="pre">Bar</span></code>,
to test for basic permissions you should use:</p>
<ul class="simple">
<li>add: <code class="docutils literal"><span class="pre">user.has_perm('foo.add_bar')</span></code></li>
<li>change: <code class="docutils literal"><span class="pre">user.has_perm('foo.change_bar')</span></code></li>
<li>delete: <code class="docutils literal"><span class="pre">user.has_perm('foo.delete_bar')</span></code></li>
</ul>
<p>The <code class="xref py py-class docutils literal"><span class="pre">Permission</span></code> model is rarely accessed
directly.</p>
</div>
<div class="section" id="groups">
<h3>Groups<a class="headerlink" href="#groups" title="Permalink to this headline">¶</a></h3>
<p><code class="xref py py-class docutils literal"><span class="pre">django.contrib.auth.models.Group</span></code> models are a generic way of
categorizing users so you can apply permissions, or some other label, to those
users. A user can belong to any number of groups.</p>
<p>A user in a group automatically has the permissions granted to that group. For
example, if the group <code class="docutils literal"><span class="pre">Site</span> <span class="pre">editors</span></code> has the permission
<code class="docutils literal"><span class="pre">can_edit_home_page</span></code>, any user in that group will have that permission.</p>
<p>Beyond permissions, groups are a convenient way to categorize users to give
them some label, or extended functionality. For example, you could create a
group <code class="docutils literal"><span class="pre">'Special</span> <span class="pre">users'</span></code>, and you could write code that could, say, give them
access to a members-only portion of your site, or send them members-only email
messages.</p>
</div>
<div class="section" id="programmatically-creating-permissions">
<h3>Programmatically creating permissions<a class="headerlink" href="#programmatically-creating-permissions" title="Permalink to this headline">¶</a></h3>
<p>While custom permissions can be defined within
a model&#8217;s <code class="docutils literal"><span class="pre">Meta</span></code> class, you can also create permissions directly. For
example, you can create the <code class="docutils literal"><span class="pre">can_publish</span></code> permission for a <code class="docutils literal"><span class="pre">BookReview</span></code> model
in <code class="docutils literal"><span class="pre">books</span></code>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">books.models</span> <span class="kn">import</span> <span class="n">BookReview</span>
<span class="kn">from</span> <span class="nn">django.contrib.auth.models</span> <span class="kn">import</span> <span class="n">Group</span><span class="p">,</span> <span class="n">Permission</span>
<span class="kn">from</span> <span class="nn">django.contrib.contenttypes.models</span> <span class="kn">import</span> <span class="n">ContentType</span>

<span class="n">content_type</span> <span class="o">=</span> <span class="n">ContentType</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get_for_model</span><span class="p">(</span><span class="n">BookReview</span><span class="p">)</span>
<span class="n">permission</span> <span class="o">=</span> <span class="n">Permission</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">codename</span><span class="o">=</span><span class="s">&#39;can_publish&#39;</span><span class="p">,</span>
                                       <span class="n">name</span><span class="o">=</span><span class="s">&#39;Can Publish Reviews&#39;</span><span class="p">,</span>
                                       <span class="n">content_type</span><span class="o">=</span><span class="n">content_type</span><span class="p">)</span>
</pre></div>
</div>
<p>The permission can then be assigned to a
<code class="xref py py-class docutils literal"><span class="pre">User</span></code> via its <code class="docutils literal"><span class="pre">user_permissions</span></code>
attribute or to a <code class="xref py py-class docutils literal"><span class="pre">Group</span></code> via its
<code class="docutils literal"><span class="pre">permissions</span></code> attribute.</p>
</div>
<div class="section" id="permission-caching">
<h3>Permission caching<a class="headerlink" href="#permission-caching" title="Permalink to this headline">¶</a></h3>
<p>The <code class="xref py py-class docutils literal"><span class="pre">ModelBackend</span></code> caches permissions on
the <code class="docutils literal"><span class="pre">User</span></code> object after the first time they need to be fetched for a
permissions check. This is typically fine for the request-response cycle since
permissions are not typically checked immediately after they are added (in the
admin, for example). If you are adding permissions and checking them immediately
afterward, in a test or view for example, the easiest solution is to re-fetch
the <code class="docutils literal"><span class="pre">User</span></code> from the database. For example:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">django.contrib.auth.models</span> <span class="kn">import</span> <span class="n">Permission</span><span class="p">,</span> <span class="n">User</span>
<span class="kn">from</span> <span class="nn">django.shortcuts</span> <span class="kn">import</span> <span class="n">get_object_or_404</span>

<span class="k">def</span> <span class="nf">user_gains_perms</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">user_id</span><span class="p">):</span>
    <span class="n">user</span> <span class="o">=</span> <span class="n">get_object_or_404</span><span class="p">(</span><span class="n">User</span><span class="p">,</span> <span class="n">pk</span><span class="o">=</span><span class="n">user_id</span><span class="p">)</span>
    <span class="c"># any permission check will cache the current set of permissions</span>
    <span class="n">user</span><span class="o">.</span><span class="n">has_perm</span><span class="p">(</span><span class="s">&#39;books.change_bar&#39;</span><span class="p">)</span>

    <span class="n">permission</span> <span class="o">=</span> <span class="n">Permission</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">codename</span><span class="o">=</span><span class="s">&#39;change_bar&#39;</span><span class="p">)</span>
    <span class="n">user</span><span class="o">.</span><span class="n">user_permissions</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">permission</span><span class="p">)</span>

    <span class="c"># Checking the cached permission set</span>
    <span class="n">user</span><span class="o">.</span><span class="n">has_perm</span><span class="p">(</span><span class="s">&#39;books.change_bar&#39;</span><span class="p">)</span>  <span class="c"># False</span>

    <span class="c"># Request new instance of User</span>
    <span class="n">user</span> <span class="o">=</span> <span class="n">get_object_or_404</span><span class="p">(</span><span class="n">User</span><span class="p">,</span> <span class="n">pk</span><span class="o">=</span><span class="n">user_id</span><span class="p">)</span>

    <span class="c"># Permission cache is repopulated from the database</span>
    <span class="n">user</span><span class="o">.</span><span class="n">has_perm</span><span class="p">(</span><span class="s">&#39;books.change_bar&#39;</span><span class="p">)</span>  <span class="c"># True</span>

    <span class="o">...</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="authentication-in-web-requests">
<span id="auth-web-requests"></span><h2>Authentication in Web requests<a class="headerlink" href="#authentication-in-web-requests" title="Permalink to this headline">¶</a></h2>
<p>Django uses sessions and middleware to hook the
authentication system into <code class="xref py py-class docutils literal"><span class="pre">request</span> <span class="pre">objects</span></code>.</p>
<p>These provide a <code class="xref py py-attr docutils literal"><span class="pre">request.user</span></code>  attribute
on every request which represents the current user. If the current user has not
logged in, this attribute will be set to an instance
of <code class="xref py py-class docutils literal"><span class="pre">AnonymousUser</span></code>, otherwise it will be an
instance of <code class="xref py py-class docutils literal"><span class="pre">User</span></code>.</p>
<p>You can tell them apart with
<code class="xref py py-meth docutils literal"><span class="pre">is_authenticated()</span></code>, like so:</p>
<div class="highlight-python"><div class="highlight"><pre>if request.user.is_authenticated():
    # Do something for authenticated users.
else:
    # Do something for anonymous users.
</pre></div>
</div>
<div class="section" id="how-to-log-a-user-in">
<span id="id2"></span><h3>How to log a user in<a class="headerlink" href="#how-to-log-a-user-in" title="Permalink to this headline">¶</a></h3>
<p>If you have an authenticated user you want to attach to the current session
- this is done with a <code class="xref py py-func docutils literal"><span class="pre">login()</span></code> function.</p>
<dl class="function">
<dt id="login">
<code class="descname">login</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#login" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>To log a user in, from a view, use <code class="xref py py-func docutils literal"><span class="pre">login()</span></code>. It
takes an <code class="xref py py-class docutils literal"><span class="pre">HttpRequest</span></code> object and a
<code class="xref py py-class docutils literal"><span class="pre">User</span></code> object.
<code class="xref py py-func docutils literal"><span class="pre">login()</span></code> saves the user&#8217;s ID in the session, using
Django&#8217;s session framework.</p>
<p>Note that any data set during the anonymous session is retained in the session
after a user logs in.</p>
<p>This example shows how you might use both
<code class="xref py py-func docutils literal"><span class="pre">authenticate()</span></code> and
<code class="xref py py-func docutils literal"><span class="pre">login()</span></code>:</p>
<div class="highlight-python"><div class="highlight"><pre>from django.contrib.auth import authenticate, login

def my_view(request):
    username = request.POST[&#39;username&#39;]
    password = request.POST[&#39;password&#39;]
    user = authenticate(username=username, password=password)
    if user is not None:
        if user.is_active:
            login(request, user)
            # Redirect to a success page.
        else:
            # Return a &#39;disabled account&#39; error message
    else:
        # Return an &#39;invalid login&#39; error message.
</pre></div>
</div>
<div class="admonition-calling-authenticate-first admonition">
<p class="first admonition-title">Calling <code class="docutils literal"><span class="pre">authenticate()</span></code> first</p>
<p class="last">When you&#8217;re manually logging a user in, you <em>must</em> call
<code class="xref py py-func docutils literal"><span class="pre">authenticate()</span></code> before you call
<code class="xref py py-func docutils literal"><span class="pre">login()</span></code>.
<code class="xref py py-func docutils literal"><span class="pre">authenticate()</span></code>
sets an attribute on the <code class="xref py py-class docutils literal"><span class="pre">User</span></code> noting
which authentication backend successfully authenticated that user, and
this information is needed later during the login process. An error will be
raised if you try to login a user object retrieved from the database
directly.</p>
</div>
</div>
<div class="section" id="how-to-log-a-user-out">
<h3>How to log a user out<a class="headerlink" href="#how-to-log-a-user-out" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="logout">
<code class="descname">logout</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#logout" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>To log out a user who has been logged in via
<code class="xref py py-func docutils literal"><span class="pre">django.contrib.auth.login()</span></code>, use
<code class="xref py py-func docutils literal"><span class="pre">django.contrib.auth.logout()</span></code> within your view. It takes an
<code class="xref py py-class docutils literal"><span class="pre">HttpRequest</span></code> object and has no return value.
Example:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">django.contrib.auth</span> <span class="kn">import</span> <span class="n">logout</span>

<span class="k">def</span> <span class="nf">logout_view</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
    <span class="n">logout</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
    <span class="c"># Redirect to a success page.</span>
</pre></div>
</div>
<p>Note that <code class="xref py py-func docutils literal"><span class="pre">logout()</span></code> doesn&#8217;t throw any errors if
the user wasn&#8217;t logged in.</p>
<p>When you call <code class="xref py py-func docutils literal"><span class="pre">logout()</span></code>, the session data for
the current request is completely cleaned out. All existing data is
removed. This is to prevent another person from using the same Web browser
to log in and have access to the previous user&#8217;s session data. If you want
to put anything into the session that will be available to the user
immediately after logging out, do that <em>after</em> calling
<code class="xref py py-func docutils literal"><span class="pre">django.contrib.auth.logout()</span></code>.</p>
</div>
<div class="section" id="limiting-access-to-logged-in-users">
<h3>Limiting access to logged-in users<a class="headerlink" href="#limiting-access-to-logged-in-users" title="Permalink to this headline">¶</a></h3>
<div class="section" id="the-raw-way">
<h4>The raw way<a class="headerlink" href="#the-raw-way" title="Permalink to this headline">¶</a></h4>
<p>The simple, raw way to limit access to pages is to check
<code class="xref py py-meth docutils literal"><span class="pre">request.user.is_authenticated()</span></code> and either redirect to a
login page:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">django.shortcuts</span> <span class="kn">import</span> <span class="n">redirect</span>

<span class="k">def</span> <span class="nf">my_view</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">request</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">is_authenticated</span><span class="p">():</span>
        <span class="k">return</span> <span class="n">redirect</span><span class="p">(</span><span class="s">&#39;/login/?next=</span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="n">request</span><span class="o">.</span><span class="n">path</span><span class="p">)</span>
    <span class="c"># ...</span>
</pre></div>
</div>
<p>...or display an error message:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">django.shortcuts</span> <span class="kn">import</span> <span class="n">render</span>

<span class="k">def</span> <span class="nf">my_view</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">request</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">is_authenticated</span><span class="p">():</span>
        <span class="k">return</span> <span class="n">render</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="s">&#39;books/login_error.html&#39;</span><span class="p">)</span>
    <span class="c"># ...</span>
</pre></div>
</div>
</div>
<div class="section" id="the-login-required-decorator">
<h4>The login_required decorator<a class="headerlink" href="#the-login-required-decorator" title="Permalink to this headline">¶</a></h4>
<dl class="function">
<dt id="django.contrib.auth.decorators.login_required">
<code class="descclassname">django.contrib.auth.decorators.</code><code class="descname">login_required</code><span class="sig-paren">(</span><span class="optional">[</span><em>redirect_field_name=REDIRECT_FIELD_NAME</em>, <em>login_url=None</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#django.contrib.auth.decorators.login_required" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>As a shortcut, you can use the convenient
<a class="reference internal" href="#django.contrib.auth.decorators.login_required" title="django.contrib.auth.decorators.login_required"><code class="xref py py-func docutils literal"><span class="pre">login_required()</span></code></a> decorator:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">django.contrib.auth.decorators</span> <span class="kn">import</span> <span class="n">login_required</span>

<span class="nd">@login_required</span>
<span class="k">def</span> <span class="nf">my_view</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
    <span class="o">...</span>
</pre></div>
</div>
<p><a class="reference internal" href="#django.contrib.auth.decorators.login_required" title="django.contrib.auth.decorators.login_required"><code class="xref py py-func docutils literal"><span class="pre">login_required()</span></code></a> does the following:</p>
<ul class="simple">
<li>If the user isn&#8217;t logged in, redirect to
<code class="docutils literal"><span class="pre">LOGIN_URL</span></code>, passing the current absolute
path in the query string. Example: <code class="docutils literal"><span class="pre">/accounts/login/?next=/reviews/3/</span></code>.</li>
<li>If the user is logged in, execute the view normally. The view code is
free to assume the user is logged in.</li>
</ul>
<p>By default, the path that the user should be redirected to upon
successful authentication is stored in a query string parameter called
<code class="docutils literal"><span class="pre">&quot;next&quot;</span></code>. If you would prefer to use a different name for this parameter,
<a class="reference internal" href="#django.contrib.auth.decorators.login_required" title="django.contrib.auth.decorators.login_required"><code class="xref py py-func docutils literal"><span class="pre">login_required()</span></code></a> takes an
optional <code class="docutils literal"><span class="pre">redirect_field_name</span></code> parameter:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">django.contrib.auth.decorators</span> <span class="kn">import</span> <span class="n">login_required</span>

<span class="nd">@login_required</span><span class="p">(</span><span class="n">redirect_field_name</span><span class="o">=</span><span class="s">&#39;my_redirect_field&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">my_view</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
    <span class="o">...</span>
</pre></div>
</div>
<p>Note that if you provide a value to <code class="docutils literal"><span class="pre">redirect_field_name</span></code>, you will most
likely need to customize your login template as well, since the template
context variable which stores the redirect path will use the value of
<code class="docutils literal"><span class="pre">redirect_field_name</span></code> as its key rather than <code class="docutils literal"><span class="pre">&quot;next&quot;</span></code> (the default).</p>
<p><a class="reference internal" href="#django.contrib.auth.decorators.login_required" title="django.contrib.auth.decorators.login_required"><code class="xref py py-func docutils literal"><span class="pre">login_required()</span></code></a> also takes an
optional <code class="docutils literal"><span class="pre">login_url</span></code> parameter. Example:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">django.contrib.auth.decorators</span> <span class="kn">import</span> <span class="n">login_required</span>

<span class="nd">@login_required</span><span class="p">(</span><span class="n">login_url</span><span class="o">=</span><span class="s">&#39;/accounts/login/&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">my_view</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
    <span class="o">...</span>
</pre></div>
</div>
<p>Note that if you don&#8217;t specify the <code class="docutils literal"><span class="pre">login_url</span></code> parameter, you&#8217;ll need to
ensure that the <code class="docutils literal"><span class="pre">LOGIN_URL</span></code> and your login
view are properly associated. For example, using the defaults, add the
following lines to your URLconf:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">django.contrib.auth</span> <span class="kn">import</span> <span class="n">views</span> <span class="k">as</span> <span class="n">auth_views</span>

<span class="n">url</span><span class="p">(</span><span class="s">r&#39;^accounts/login/$&#39;</span><span class="p">,</span> <span class="n">auth_views</span><span class="o">.</span><span class="n">login</span><span class="p">),</span>
</pre></div>
</div>
<p>The <code class="docutils literal"><span class="pre">LOGIN_URL</span></code> also accepts view function
names and named URL patterns. This allows you
to freely remap your login view within your URLconf without having to
update the setting.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The login_required decorator does NOT check the is_active flag on a user.</p>
</div>
</div>
<div class="section" id="limiting-access-to-logged-in-users-that-pass-a-test">
<h4>Limiting access to logged-in users that pass a test<a class="headerlink" href="#limiting-access-to-logged-in-users-that-pass-a-test" title="Permalink to this headline">¶</a></h4>
<p>To limit access based on certain permissions or some other test, you&#8217;d do
essentially the same thing as described in the previous section.</p>
<p>The simple way is to run your test on <code class="xref py py-attr docutils literal"><span class="pre">request.user</span></code> in the view directly. For example, this view
checks to make sure the user has an email in the desired domain:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">my_view</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">request</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">email</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s">&#39;@example.com&#39;</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">HttpResponse</span><span class="p">(</span><span class="s">&quot;You can&#39;t leave a review for this book.&quot;</span><span class="p">)</span>
    <span class="c"># ...</span>
</pre></div>
</div>
<dl class="function">
<dt id="django.contrib.auth.decorators.user_passes_test">
<code class="descclassname">django.contrib.auth.decorators.</code><code class="descname">user_passes_test</code><span class="sig-paren">(</span><em>func</em><span class="optional">[</span>, <em>login_url=None</em>, <em>redirect_field_name=REDIRECT_FIELD_NAME</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#django.contrib.auth.decorators.user_passes_test" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>As a shortcut, you can use the convenient <code class="docutils literal"><span class="pre">user_passes_test</span></code> decorator:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">django.contrib.auth.decorators</span> <span class="kn">import</span> <span class="n">user_passes_test</span>

<span class="k">def</span> <span class="nf">email_check</span><span class="p">(</span><span class="n">user</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">user</span><span class="o">.</span><span class="n">email</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s">&#39;@example.com&#39;</span><span class="p">)</span>

<span class="nd">@user_passes_test</span><span class="p">(</span><span class="n">email_check</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">my_view</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
    <span class="o">...</span>
</pre></div>
</div>
<p><a class="reference internal" href="#django.contrib.auth.decorators.user_passes_test" title="django.contrib.auth.decorators.user_passes_test"><code class="xref py py-func docutils literal"><span class="pre">user_passes_test()</span></code></a> takes a required
argument: a callable that takes a
<code class="xref py py-class docutils literal"><span class="pre">User</span></code> object and returns <code class="docutils literal"><span class="pre">True</span></code> if
the user is allowed to view the page. Note that
<a class="reference internal" href="#django.contrib.auth.decorators.user_passes_test" title="django.contrib.auth.decorators.user_passes_test"><code class="xref py py-func docutils literal"><span class="pre">user_passes_test()</span></code></a> does not
automatically check that the <code class="xref py py-class docutils literal"><span class="pre">User</span></code> is
not anonymous.</p>
<p><a class="reference internal" href="#django.contrib.auth.decorators.user_passes_test" title="django.contrib.auth.decorators.user_passes_test"><code class="xref py py-func docutils literal"><span class="pre">user_passes_test()</span></code></a> takes two
optional arguments:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">login_url</span></code>
Lets you specify the URL that users who don&#8217;t pass the test will be
redirected to. It may be a login page and defaults to
<cite>LOGIN_URL`</cite> if you don&#8217;t specify one.</li>
<li><code class="docutils literal"><span class="pre">redirect_field_name</span></code>
Same as for <a class="reference internal" href="#django.contrib.auth.decorators.login_required" title="django.contrib.auth.decorators.login_required"><code class="xref py py-func docutils literal"><span class="pre">login_required()</span></code></a>.
Setting it to <code class="docutils literal"><span class="pre">None</span></code> removes it from the URL, which you may want to do
if you are redirecting users that don&#8217;t pass the test to a non-login
page where there&#8217;s no &#8220;next page&#8221;.</li>
</ul>
<p>For example:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="nd">@user_passes_test</span><span class="p">(</span><span class="n">email_check</span><span class="p">,</span> <span class="n">login_url</span><span class="o">=</span><span class="s">&#39;/login/&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">my_view</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
    <span class="o">...</span>
</pre></div>
</div>
</div>
<div class="section" id="the-permission-required-decorator">
<h4>The permission_required decorator<a class="headerlink" href="#the-permission-required-decorator" title="Permalink to this headline">¶</a></h4>
<dl class="function">
<dt id="django.contrib.auth.decorators.permission_required">
<code class="descclassname">django.contrib.auth.decorators.</code><code class="descname">permission_required</code><span class="sig-paren">(</span><em>perm</em><span class="optional">[</span>, <em>login_url=None</em>, <em>raise_exception=False</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#django.contrib.auth.decorators.permission_required" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>It&#8217;s a relatively common task to check whether a user has a particular
permission. For that reason, Django provides a shortcut for that case: the
<a class="reference internal" href="#django.contrib.auth.decorators.permission_required" title="django.contrib.auth.decorators.permission_required"><code class="xref py py-func docutils literal"><span class="pre">permission_required()</span></code></a> decorator.:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">django.contrib.auth.decorators</span> <span class="kn">import</span> <span class="n">permission_required</span>

<span class="nd">@permission_required</span><span class="p">(</span><span class="s">&#39;reviews.can_vote&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">my_view</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
    <span class="o">...</span>
</pre></div>
</div>
<p>Just like the <code class="xref py py-meth docutils literal"><span class="pre">has_perm()</span></code> method,
permission names take the form <code class="docutils literal"><span class="pre">&quot;&lt;app</span> <span class="pre">label&gt;.&lt;permission</span> <span class="pre">codename&gt;&quot;</span></code>
(i.e. <code class="docutils literal"><span class="pre">reviews.can_vote</span></code> for a permission on a model in the <code class="docutils literal"><span class="pre">reviews</span></code>
application).</p>
<p>The decorator may also take a list of permissions.</p>
<p>Note that <a class="reference internal" href="#django.contrib.auth.decorators.permission_required" title="django.contrib.auth.decorators.permission_required"><code class="xref py py-func docutils literal"><span class="pre">permission_required()</span></code></a>
also takes an optional <code class="docutils literal"><span class="pre">login_url</span></code> parameter. Example:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">django.contrib.auth.decorators</span> <span class="kn">import</span> <span class="n">permission_required</span>

<span class="nd">@permission_required</span><span class="p">(</span><span class="s">&#39;reviews.can_vote&#39;</span><span class="p">,</span> <span class="n">login_url</span><span class="o">=</span><span class="s">&#39;/loginpage/&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">my_view</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
    <span class="o">...</span>
</pre></div>
</div>
<p>As in the <a class="reference internal" href="#django.contrib.auth.decorators.login_required" title="django.contrib.auth.decorators.login_required"><code class="xref py py-func docutils literal"><span class="pre">login_required()</span></code></a> decorator,
<code class="docutils literal"><span class="pre">login_url</span></code> defaults to <cite>LOGIN_URL`</cite>.</p>
<p>If the <code class="docutils literal"><span class="pre">raise_exception</span></code> parameter is given, the decorator will raise
<code class="xref py py-exc docutils literal"><span class="pre">PermissionDenied</span></code>, prompting the 403
(HTTP Forbidden) view instead of redirecting to the
login page.</p>
</div>
<div class="section" id="applying-permissions-to-generic-views">
<span id="id3"></span><h4>Applying permissions to generic views<a class="headerlink" href="#applying-permissions-to-generic-views" title="Permalink to this headline">¶</a></h4>
<p>To apply a permission to a class-based generic view
, decorate the <code class="xref py py-meth docutils literal"><span class="pre">View.dispatch</span></code> method on the class. Another approach is to
write a mixin that wraps as_view().</p>
</div>
<div class="section" id="session-invalidation-on-password-change">
<span id="id4"></span><h4>Session invalidation on password change<a class="headerlink" href="#session-invalidation-on-password-change" title="Permalink to this headline">¶</a></h4>
<p>If your <code class="docutils literal"><span class="pre">AUTH_USER_MODEL</span></code> inherits from
<a class="reference internal" href="#django.contrib.auth.models.AbstractBaseUser" title="django.contrib.auth.models.AbstractBaseUser"><code class="xref py py-class docutils literal"><span class="pre">AbstractBaseUser</span></code></a> or implements its own
<a class="reference internal" href="#django.contrib.auth.models.AbstractBaseUser.get_session_auth_hash" title="django.contrib.auth.models.AbstractBaseUser.get_session_auth_hash"><code class="xref py py-meth docutils literal"><span class="pre">get_session_auth_hash()</span></code></a>
method, authenticated sessions will include the hash returned by this function.
In the <a class="reference internal" href="#django.contrib.auth.models.AbstractBaseUser" title="django.contrib.auth.models.AbstractBaseUser"><code class="xref py py-class docutils literal"><span class="pre">AbstractBaseUser</span></code></a> case, this is an
HMAC of the password field. If the
<a class="reference internal" href="chapter_19.html#django.contrib.auth.middleware.SessionAuthenticationMiddleware" title="django.contrib.auth.middleware.SessionAuthenticationMiddleware"><code class="xref py py-class docutils literal"><span class="pre">SessionAuthenticationMiddleware</span></code></a> is
enabled, Django verifies that the hash sent along with each request matches
the one that&#8217;s computed server-side. This allows a user to log out all of their
sessions by changing their password.</p>
<p>The default password change views included with Django,
<a class="reference internal" href="#django.contrib.auth.views.password_change" title="django.contrib.auth.views.password_change"><code class="xref py py-func docutils literal"><span class="pre">django.contrib.auth.views.password_change()</span></code></a> and the
<code class="docutils literal"><span class="pre">user_change_password</span></code> view in the <code class="xref py py-mod docutils literal"><span class="pre">django.contrib.auth</span></code> admin, update
the session with the new password hash so that a user changing their own
password won&#8217;t log themselves out. If you have a custom password change view
and wish to have similar behavior, use this function:</p>
<dl class="function">
<dt id="django.contrib.auth.decorators.update_session_auth_hash">
<code class="descclassname">django.contrib.auth.decorators.</code><code class="descname">update_session_auth_hash</code><span class="sig-paren">(</span><em>request</em>, <em>user</em><span class="sig-paren">)</span><a class="headerlink" href="#django.contrib.auth.decorators.update_session_auth_hash" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>This function takes the current request and the updated user object from
which the new session hash will be derived and updates the session hash
appropriately. Example usage:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">django.contrib.auth</span> <span class="kn">import</span> <span class="n">update_session_auth_hash</span>

<span class="k">def</span> <span class="nf">password_change</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">request</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="s">&#39;POST&#39;</span><span class="p">:</span>
        <span class="n">form</span> <span class="o">=</span> <span class="n">PasswordChangeForm</span><span class="p">(</span><span class="n">user</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">user</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">POST</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">form</span><span class="o">.</span><span class="n">is_valid</span><span class="p">():</span>
            <span class="n">form</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
            <span class="n">update_session_auth_hash</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">form</span><span class="o">.</span><span class="n">user</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="o">...</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Since
<a class="reference internal" href="#django.contrib.auth.models.AbstractBaseUser.get_session_auth_hash" title="django.contrib.auth.models.AbstractBaseUser.get_session_auth_hash"><code class="xref py py-meth docutils literal"><span class="pre">get_session_auth_hash()</span></code></a>
is based on <code class="docutils literal"><span class="pre">SECRET_KEY</span></code>, updating your site to use a new secret
will invalidate all existing sessions.</p>
</div>
</div>
</div>
</div>
<div class="section" id="module-django.contrib.auth.views">
<span id="authentication-views"></span><span id="built-in-auth-views"></span><h2>Authentication Views<a class="headerlink" href="#module-django.contrib.auth.views" title="Permalink to this headline">¶</a></h2>
<p>Django provides several views that you can use for handling login, logout, and
password management. These make use of the built-in auth forms but you can pass in your own forms as well.</p>
<p>Django provides no default template for the authentication views - however the
template context is documented for each view below.</p>
<p>The built-in views all return
a <code class="xref py py-class docutils literal"><span class="pre">TemplateResponse</span></code> instance, which allows
you to easily customize the response data before rendering.
Most built-in authentication views provide a URL name for easier reference.</p>
<div class="section" id="id5">
<h3><code class="docutils literal"><span class="pre">login</span></code><a class="headerlink" href="#id5" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="django.contrib.auth.views.login">
<code class="descclassname">django.contrib.auth.views.</code><code class="descname">login</code><span class="sig-paren">(</span><em>request</em><span class="optional">[</span>, <em>template_name</em>, <em>redirect_field_name</em>, <em>authentication_form</em>, <em>current_app</em>, <em>extra_context</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#django.contrib.auth.views.login" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Logs a user in.</p>
<p><strong>Default URL:</strong> /login/</p>
<p><strong>Optional arguments:</strong></p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">template_name</span></code>: The name of a template to display for the view used to
log the user in. Defaults to <code class="file docutils literal"><span class="pre">registration/login.html</span></code>.</li>
<li><code class="docutils literal"><span class="pre">redirect_field_name</span></code>: The name of a <code class="docutils literal"><span class="pre">GET</span></code> field containing the
URL to redirect to after login. Defaults to <code class="docutils literal"><span class="pre">next</span></code>.</li>
<li><code class="docutils literal"><span class="pre">authentication_form</span></code>: A callable (typically just a form class) to
use for authentication. Defaults to
<code class="xref py py-class docutils literal"><span class="pre">AuthenticationForm</span></code>.</li>
<li><code class="docutils literal"><span class="pre">current_app</span></code>: A hint indicating which application contains the current
view. See the namespaced URL resolution strategy for more information.</li>
<li><code class="docutils literal"><span class="pre">extra_context</span></code>: A dictionary of context data that will be added to the
default context data passed to the template.</li>
</ul>
<p>Here&#8217;s what <code class="docutils literal"><span class="pre">django.contrib.auth.views.login</span></code> does:</p>
<ul class="simple">
<li>If called via <code class="docutils literal"><span class="pre">GET</span></code>, it displays a login form that POSTs to the
same URL. More on this in a bit.</li>
<li>If called via <code class="docutils literal"><span class="pre">POST</span></code> with user submitted credentials, it tries to log
the user in. If login is successful, the view redirects to the URL
specified in <code class="docutils literal"><span class="pre">next</span></code>. If <code class="docutils literal"><span class="pre">next</span></code> isn&#8217;t provided, it redirects to
<code class="docutils literal"><span class="pre">LOGIN_REDIRECT_URL</span></code> (which
defaults to <code class="docutils literal"><span class="pre">/accounts/profile/</span></code>). If login isn&#8217;t successful, it
redisplays the login form.</li>
</ul>
<p>It&#8217;s your responsibility to provide the html for the login template
, called <code class="docutils literal"><span class="pre">registration/login.html</span></code> by default. This template gets passed
four template context variables:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">form</span></code>: A <code class="xref py py-class docutils literal"><span class="pre">Form</span></code> object representing the
<code class="xref py py-class docutils literal"><span class="pre">AuthenticationForm</span></code>.</li>
<li><code class="docutils literal"><span class="pre">next</span></code>: The URL to redirect to after successful login. This may
contain a query string, too.</li>
<li><code class="docutils literal"><span class="pre">site</span></code>: The current <code class="xref py py-class docutils literal"><span class="pre">Site</span></code>,
according to the <code class="docutils literal"><span class="pre">SITE_ID</span></code> setting. If you don&#8217;t have the
site framework installed, this will be set to an instance of
<code class="xref py py-class docutils literal"><span class="pre">RequestSite</span></code>, which derives the
site name and domain from the current
<code class="xref py py-class docutils literal"><span class="pre">HttpRequest</span></code>.</li>
<li><code class="docutils literal"><span class="pre">site_name</span></code>: An alias for <code class="docutils literal"><span class="pre">site.name</span></code>. If you don&#8217;t have the site
framework installed, this will be set to the value of
<code class="xref py py-attr docutils literal"><span class="pre">request.META['SERVER_NAME']</span></code>.</li>
</ul>
<p>If you&#8217;d prefer not to call the template <code class="file docutils literal"><span class="pre">registration/login.html</span></code>,
you can pass the <code class="docutils literal"><span class="pre">template_name</span></code> parameter via the extra arguments to
the view in your URLconf. For example, this URLconf line would use
<code class="file docutils literal"><span class="pre">books/login.html</span></code> instead:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">url</span><span class="p">(</span><span class="s">r&#39;^accounts/login/$&#39;</span><span class="p">,</span> <span class="n">auth_views</span><span class="o">.</span><span class="n">login</span><span class="p">,</span> <span class="p">{</span><span class="s">&#39;template_name&#39;</span><span class="p">:</span> <span class="s">&#39;books/login.html&#39;</span><span class="p">}),</span>
</pre></div>
</div>
<p>You can also specify the name of the <code class="docutils literal"><span class="pre">GET</span></code> field which contains the URL
to redirect to after login by passing <code class="docutils literal"><span class="pre">redirect_field_name</span></code> to the view.
By default, the field is called <code class="docutils literal"><span class="pre">next</span></code>.</p>
<p>Here&#8217;s a sample <code class="file docutils literal"><span class="pre">registration/login.html</span></code> template you can use as a
starting point. It assumes you have a <code class="file docutils literal"><span class="pre">base.html</span></code> template that
defines a <code class="docutils literal"><span class="pre">content</span></code> block:</p>
<div class="highlight-html+django"><div class="highlight"><pre><span class="cp">{%</span> <span class="k">extends</span> <span class="s2">&quot;base.html&quot;</span> <span class="cp">%}</span>

<span class="cp">{%</span> <span class="k">block</span> <span class="nv">content</span> <span class="cp">%}</span>

<span class="cp">{%</span> <span class="k">if</span> <span class="nv">form.errors</span> <span class="cp">%}</span>
<span class="nt">&lt;p&gt;</span>Your username and password didn&#39;t match. Please try again.<span class="nt">&lt;/p&gt;</span>
<span class="cp">{%</span> <span class="k">endif</span> <span class="cp">%}</span>

<span class="nt">&lt;form</span> <span class="na">method=</span><span class="s">&quot;post&quot;</span> <span class="na">action=</span><span class="s">&quot;</span><span class="cp">{%</span> <span class="k">url</span> <span class="s1">&#39;django.contrib.auth.views.login&#39;</span> <span class="cp">%}</span><span class="s">&quot;</span><span class="nt">&gt;</span>
<span class="cp">{%</span> <span class="k">csrf_token</span> <span class="cp">%}</span>
<span class="nt">&lt;table&gt;</span>
<span class="nt">&lt;tr&gt;</span>
    <span class="nt">&lt;td&gt;</span><span class="cp">{{</span> <span class="nv">form.username.label_tag</span> <span class="cp">}}</span><span class="nt">&lt;/td&gt;</span>
    <span class="nt">&lt;td&gt;</span><span class="cp">{{</span> <span class="nv">form.username</span> <span class="cp">}}</span><span class="nt">&lt;/td&gt;</span>
<span class="nt">&lt;/tr&gt;</span>
<span class="nt">&lt;tr&gt;</span>
    <span class="nt">&lt;td&gt;</span><span class="cp">{{</span> <span class="nv">form.password.label_tag</span> <span class="cp">}}</span><span class="nt">&lt;/td&gt;</span>
    <span class="nt">&lt;td&gt;</span><span class="cp">{{</span> <span class="nv">form.password</span> <span class="cp">}}</span><span class="nt">&lt;/td&gt;</span>
<span class="nt">&lt;/tr&gt;</span>
<span class="nt">&lt;/table&gt;</span>

<span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">&quot;submit&quot;</span> <span class="na">value=</span><span class="s">&quot;login&quot;</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">&quot;hidden&quot;</span> <span class="na">name=</span><span class="s">&quot;next&quot;</span> <span class="na">value=</span><span class="s">&quot;</span><span class="cp">{{</span> <span class="nv">next</span> <span class="cp">}}</span><span class="s">&quot;</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;/form&gt;</span>

<span class="cp">{%</span> <span class="k">endblock</span> <span class="cp">%}</span>
</pre></div>
</div>
<p>If you have customized authentication you can pass a custom authentication form
to the login view via the <code class="docutils literal"><span class="pre">authentication_form</span></code> parameter. This form must
accept a <code class="docutils literal"><span class="pre">request</span></code> keyword argument in its <code class="docutils literal"><span class="pre">__init__</span></code> method, and
provide a <code class="docutils literal"><span class="pre">get_user</span></code> method which returns the authenticated user object
(this method is only ever called after successful form validation).</p>
</div>
<div class="section" id="id6">
<h3><code class="docutils literal"><span class="pre">logout</span></code><a class="headerlink" href="#id6" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="django.contrib.auth.views.logout">
<code class="descclassname">django.contrib.auth.views.</code><code class="descname">logout</code><span class="sig-paren">(</span><em>request</em><span class="optional">[</span>, <em>next_page</em>, <em>template_name</em>, <em>redirect_field_name</em>, <em>current_app</em>, <em>extra_context</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#django.contrib.auth.views.logout" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Logs a user out.</p>
<p><strong>Default URL:</strong> /logout/</p>
<p><strong>Optional arguments:</strong></p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">next_page</span></code>: The URL to redirect to after logout.</li>
<li><code class="docutils literal"><span class="pre">template_name</span></code>: The full name of a template to display after
logging the user out. Defaults to
<code class="file docutils literal"><span class="pre">registration/logged_out.html</span></code> if no argument is supplied.</li>
<li><code class="docutils literal"><span class="pre">redirect_field_name</span></code>: The name of a <code class="docutils literal"><span class="pre">GET</span></code> field containing the
URL to redirect to after log out. Defaults to <code class="docutils literal"><span class="pre">next</span></code>. Overrides the
<code class="docutils literal"><span class="pre">next_page</span></code> URL if the given <code class="docutils literal"><span class="pre">GET</span></code> parameter is passed.</li>
<li><code class="docutils literal"><span class="pre">current_app</span></code>: A hint indicating which application contains the current
view. See the namespaced URL resolution strategy for more information.</li>
<li><code class="docutils literal"><span class="pre">extra_context</span></code>: A dictionary of context data that will be added to the
default context data passed to the template.</li>
</ul>
<p><strong>Template context:</strong></p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">title</span></code>: The string &#8220;Logged out&#8221;, localized.</li>
<li><code class="docutils literal"><span class="pre">site</span></code>: The current <code class="xref py py-class docutils literal"><span class="pre">Site</span></code>,
according to the <code class="docutils literal"><span class="pre">SITE_ID</span></code> setting. If you don&#8217;t have the
site framework installed, this will be set to an instance of
<code class="xref py py-class docutils literal"><span class="pre">RequestSite</span></code>, which derives the
site name and domain from the current
<code class="xref py py-class docutils literal"><span class="pre">HttpRequest</span></code>.</li>
<li><code class="docutils literal"><span class="pre">site_name</span></code>: An alias for <code class="docutils literal"><span class="pre">site.name</span></code>. If you don&#8217;t have the site
framework installed, this will be set to the value of
<code class="xref py py-attr docutils literal"><span class="pre">request.META['SERVER_NAME']</span></code>.</li>
<li><code class="docutils literal"><span class="pre">current_app</span></code>: A hint indicating which application contains the current
view. See the namespaced URL resolution strategy for more information.</li>
<li><code class="docutils literal"><span class="pre">extra_context</span></code>: A dictionary of context data that will be added to the
default context data passed to the template.</li>
</ul>
</div>
<div class="section" id="logout-then-login">
<h3><code class="docutils literal"><span class="pre">logout_then_login</span></code><a class="headerlink" href="#logout-then-login" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="django.contrib.auth.views.logout_then_login">
<code class="descclassname">django.contrib.auth.views.</code><code class="descname">logout_then_login</code><span class="sig-paren">(</span><em>request</em><span class="optional">[</span>, <em>login_url</em>, <em>current_app</em>, <em>extra_context</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#django.contrib.auth.views.logout_then_login" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Logs a user out, then redirects to the login page.</p>
<p><strong>Default URL:</strong> None provided.</p>
<p><strong>Optional arguments:</strong></p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">login_url</span></code>: The URL of the login page to redirect to.
Defaults to <code class="docutils literal"><span class="pre">LOGIN_URL</span></code> if not supplied.</li>
<li><code class="docutils literal"><span class="pre">current_app</span></code>: A hint indicating which application contains the current
view. See the namespaced URL resolution strategy for more information.</li>
<li><code class="docutils literal"><span class="pre">extra_context</span></code>: A dictionary of context data that will be added to the
default context data passed to the template.</li>
</ul>
</div>
<div class="section" id="password-change">
<h3><code class="docutils literal"><span class="pre">password_change</span></code><a class="headerlink" href="#password-change" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="django.contrib.auth.views.password_change">
<code class="descclassname">django.contrib.auth.views.</code><code class="descname">password_change</code><span class="sig-paren">(</span><em>request</em><span class="optional">[</span>, <em>template_name</em>, <em>post_change_redirect</em>, <em>password_change_form</em>, <em>current_app</em>, <em>extra_context</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#django.contrib.auth.views.password_change" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Allows a user to change their password.</p>
<p><strong>Default URL:</strong> /password_change/</p>
<p><strong>Optional arguments:</strong></p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">template_name</span></code>: The full name of a template to use for
displaying the password change form. Defaults to
<code class="file docutils literal"><span class="pre">registration/password_change_form.html</span></code> if not supplied.</li>
<li><code class="docutils literal"><span class="pre">post_change_redirect</span></code>: The URL to redirect to after a successful
password change.</li>
<li><code class="docutils literal"><span class="pre">password_change_form</span></code>: A custom &#8220;change password&#8221; form which must
accept a <code class="docutils literal"><span class="pre">user</span></code> keyword argument. The form is responsible for
actually changing the user&#8217;s password. Defaults to
<code class="xref py py-class docutils literal"><span class="pre">PasswordChangeForm</span></code>.</li>
<li><code class="docutils literal"><span class="pre">current_app</span></code>: A hint indicating which application contains the current
view. See the namespaced URL resolution strategy for more information.</li>
<li><code class="docutils literal"><span class="pre">extra_context</span></code>: A dictionary of context data that will be added to the
default context data passed to the template.</li>
</ul>
<p><strong>Template context:</strong></p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">form</span></code>: The password change form (see <code class="docutils literal"><span class="pre">password_change_form</span></code> above).</li>
</ul>
</div>
<div class="section" id="password-change-done">
<h3><code class="docutils literal"><span class="pre">password_change_done</span></code><a class="headerlink" href="#password-change-done" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="django.contrib.auth.views.password_change_done">
<code class="descclassname">django.contrib.auth.views.</code><code class="descname">password_change_done</code><span class="sig-paren">(</span><em>request</em><span class="optional">[</span>, <em>template_name</em>, <em>current_app</em>, <em>extra_context</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#django.contrib.auth.views.password_change_done" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>The page shown after a user has changed their password.</p>
<p><strong>Default URL:</strong> /password_change_done/</p>
<p><strong>Optional arguments:</strong></p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">template_name</span></code>: The full name of a template to use.
Defaults to <code class="file docutils literal"><span class="pre">registration/password_change_done.html</span></code> if not
supplied.</li>
<li><code class="docutils literal"><span class="pre">current_app</span></code>: A hint indicating which application contains the current
view. See the namespaced URL resolution strategy for more information.</li>
<li><code class="docutils literal"><span class="pre">extra_context</span></code>: A dictionary of context data that will be added to the
default context data passed to the template.</li>
</ul>
</div>
<div class="section" id="password-reset">
<h3><code class="docutils literal"><span class="pre">password_reset</span></code><a class="headerlink" href="#password-reset" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="django.contrib.auth.views.password_reset">
<code class="descclassname">django.contrib.auth.views.</code><code class="descname">password_reset</code><span class="sig-paren">(</span><em>request</em><span class="optional">[</span>, <em>template_name</em>, <em>email_template_name</em>, <em>password_reset_form</em>, <em>token_generator</em>, <em>post_reset_redirect</em>, <em>from_email</em>, <em>current_app</em>, <em>extra_context</em>, <em>html_email_template_name</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#django.contrib.auth.views.password_reset" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Allows a user to reset their password by generating a one-time use link
that can be used to reset the password, and sending that link to the
user&#8217;s registered email address.</p>
<p>If the email address provided does not exist in the system, this view
won&#8217;t send an email, but the user won&#8217;t receive any error message either.
This prevents information leaking to potential attackers. If you want to
provide an error message in this case, you can subclass
<code class="xref py py-class docutils literal"><span class="pre">PasswordResetForm</span></code> and use the
<code class="docutils literal"><span class="pre">password_reset_form</span></code> argument.</p>
<p>Users flagged with an unusable password (see
<code class="xref py py-meth docutils literal"><span class="pre">set_unusable_password()</span></code> aren&#8217;t
allowed to request a password reset to prevent misuse when using an
external authentication source like LDAP. Note that they won&#8217;t receive any
error message since this would expose their account&#8217;s existence but no
mail will be sent either.</p>
<p><strong>Default URL:</strong> /password_reset/</p>
<p><strong>Optional arguments:</strong></p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">template_name</span></code>: The full name of a template to use for
displaying the password reset form. Defaults to
<code class="file docutils literal"><span class="pre">registration/password_reset_form.html</span></code> if not supplied.</li>
<li><code class="docutils literal"><span class="pre">email_template_name</span></code>: The full name of a template to use for
generating the email with the reset password link. Defaults to
<code class="file docutils literal"><span class="pre">registration/password_reset_email.html</span></code> if not supplied.</li>
<li><code class="docutils literal"><span class="pre">subject_template_name</span></code>: The full name of a template to use for
the subject of the email with the reset password link. Defaults
to <code class="file docutils literal"><span class="pre">registration/password_reset_subject.txt</span></code> if not supplied.</li>
<li><code class="docutils literal"><span class="pre">password_reset_form</span></code>: Form that will be used to get the email of
the user to reset the password for. Defaults to
<code class="xref py py-class docutils literal"><span class="pre">PasswordResetForm</span></code>.</li>
<li><code class="docutils literal"><span class="pre">token_generator</span></code>: Instance of the class to check the one time link.
This will default to <code class="docutils literal"><span class="pre">default_token_generator</span></code>, it&#8217;s an instance of
<code class="docutils literal"><span class="pre">django.contrib.auth.tokens.PasswordResetTokenGenerator</span></code>.</li>
<li><code class="docutils literal"><span class="pre">post_reset_redirect</span></code>: The URL to redirect to after a successful
password reset request.</li>
<li><code class="docutils literal"><span class="pre">from_email</span></code>: A valid email address. By default Django uses
the <code class="docutils literal"><span class="pre">DEFAULT_FROM_EMAIL</span></code>.</li>
<li><code class="docutils literal"><span class="pre">current_app</span></code>: A hint indicating which application contains the current
view. See the namespaced URL resolution strategy for more information.</li>
<li><code class="docutils literal"><span class="pre">extra_context</span></code>: A dictionary of context data that will be added to the
default context data passed to the template.</li>
<li><code class="docutils literal"><span class="pre">html_email_template_name</span></code>: The full name of a template to use
for generating a <code class="docutils literal"><span class="pre">text/html</span></code> multipart email with the password reset
link. By default, HTML email is not sent.</li>
</ul>
<p><strong>Template context:</strong></p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">form</span></code>: The form (see <code class="docutils literal"><span class="pre">password_reset_form</span></code> above) for resetting
the user&#8217;s password.</li>
</ul>
<p><strong>Email template context:</strong></p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">email</span></code>: An alias for <code class="docutils literal"><span class="pre">user.email</span></code></li>
<li><code class="docutils literal"><span class="pre">user</span></code>: The current <code class="xref py py-class docutils literal"><span class="pre">User</span></code>,
according to the <code class="docutils literal"><span class="pre">email</span></code> form field. Only active users are able to
reset their passwords (<code class="docutils literal"><span class="pre">User.is_active</span> <span class="pre">is</span> <span class="pre">True</span></code>).</li>
<li><code class="docutils literal"><span class="pre">site_name</span></code>: An alias for <code class="docutils literal"><span class="pre">site.name</span></code>. If you don&#8217;t have the site
framework installed, this will be set to the value of
<code class="xref py py-attr docutils literal"><span class="pre">request.META['SERVER_NAME']</span></code>.</li>
<li><code class="docutils literal"><span class="pre">domain</span></code>: An alias for <code class="docutils literal"><span class="pre">site.domain</span></code>. If you don&#8217;t have the site
framework installed, this will be set to the value of
<code class="docutils literal"><span class="pre">request.get_host()</span></code>.</li>
<li><code class="docutils literal"><span class="pre">protocol</span></code>: http or https</li>
<li><code class="docutils literal"><span class="pre">uid</span></code>: The user&#8217;s primary key encoded in base 64.</li>
<li><code class="docutils literal"><span class="pre">token</span></code>: Token to check that the reset link is valid.</li>
</ul>
<p>Sample <code class="docutils literal"><span class="pre">registration/password_reset_email.html</span></code> (email body template):</p>
<div class="highlight-html+django"><div class="highlight"><pre>Someone asked for password reset for email <span class="cp">{{</span> <span class="nv">email</span> <span class="cp">}}</span>. Follow the link below:
<span class="cp">{{</span> <span class="nv">protocol</span><span class="cp">}}</span>://<span class="cp">{{</span> <span class="nv">domain</span> <span class="cp">}}{%</span> <span class="k">url</span> <span class="s1">&#39;password_reset_confirm&#39;</span> <span class="nv">uidb64</span><span class="o">=</span><span class="nv">uid</span> <span class="nv">token</span><span class="o">=</span><span class="nv">token</span> <span class="cp">%}</span>
</pre></div>
</div>
<p>The same template context is used for subject template. Subject must be
single line plain text string.</p>
</div>
<div class="section" id="password-reset-done">
<h3><code class="docutils literal"><span class="pre">password_reset_done</span></code><a class="headerlink" href="#password-reset-done" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="django.contrib.auth.views.password_reset_done">
<code class="descclassname">django.contrib.auth.views.</code><code class="descname">password_reset_done</code><span class="sig-paren">(</span><em>request</em><span class="optional">[</span>, <em>template_name</em>, <em>current_app</em>, <em>extra_context</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#django.contrib.auth.views.password_reset_done" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>The page shown after a user has been emailed a link to reset their
password. This view is called by default if the <a class="reference internal" href="#django.contrib.auth.views.password_reset" title="django.contrib.auth.views.password_reset"><code class="xref py py-func docutils literal"><span class="pre">password_reset()</span></code></a> view
doesn&#8217;t have an explicit <code class="docutils literal"><span class="pre">post_reset_redirect</span></code> URL set.</p>
<p><strong>Default URL:</strong> /password_reset_done/</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">If the email address provided does not exist in the system, the user is inactive, or has an unusable password,
the user will still be redirected to this view but no email will be sent.</p>
</div>
<p><strong>Optional arguments:</strong></p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">template_name</span></code>: The full name of a template to use.
Defaults to <code class="file docutils literal"><span class="pre">registration/password_reset_done.html</span></code> if not
supplied.</li>
<li><code class="docutils literal"><span class="pre">current_app</span></code>: A hint indicating which application contains the current
view. See the namespaced URL resolution strategy for more information.</li>
<li><code class="docutils literal"><span class="pre">extra_context</span></code>: A dictionary of context data that will be added to the
default context data passed to the template.</li>
</ul>
</div>
<div class="section" id="password-reset-confirm">
<h3><code class="docutils literal"><span class="pre">password_reset_confirm</span></code><a class="headerlink" href="#password-reset-confirm" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="django.contrib.auth.views.password_reset_confirm">
<code class="descclassname">django.contrib.auth.views.</code><code class="descname">password_reset_confirm</code><span class="sig-paren">(</span><em>request</em><span class="optional">[</span>, <em>uidb64</em>, <em>token</em>, <em>template_name</em>, <em>token_generator</em>, <em>set_password_form</em>, <em>post_reset_redirect</em>, <em>current_app</em>, <em>extra_context</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#django.contrib.auth.views.password_reset_confirm" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Presents a form for entering a new password.</p>
<p><strong>Default URL:</strong> /password_reset_confirm/</p>
<p><strong>Optional arguments:</strong></p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">uidb64</span></code>: The user&#8217;s id encoded in base 64. Defaults to <code class="docutils literal"><span class="pre">None</span></code>.</li>
<li><code class="docutils literal"><span class="pre">token</span></code>: Token to check that the password is valid. Defaults to
<code class="docutils literal"><span class="pre">None</span></code>.</li>
<li><code class="docutils literal"><span class="pre">template_name</span></code>: The full name of a template to display the confirm
password view. Default value is <code class="file docutils literal"><span class="pre">registration/password_reset_confirm.html</span></code>.</li>
<li><code class="docutils literal"><span class="pre">token_generator</span></code>: Instance of the class to check the password. This
will default to <code class="docutils literal"><span class="pre">default_token_generator</span></code>, it&#8217;s an instance of
<code class="docutils literal"><span class="pre">django.contrib.auth.tokens.PasswordResetTokenGenerator</span></code>.</li>
<li><code class="docutils literal"><span class="pre">set_password_form</span></code>: Form that will be used to set the password.
Defaults to <code class="xref py py-class docutils literal"><span class="pre">SetPasswordForm</span></code></li>
<li><code class="docutils literal"><span class="pre">post_reset_redirect</span></code>: URL to redirect after the password reset
done. Defaults to <code class="docutils literal"><span class="pre">None</span></code>.</li>
<li><code class="docutils literal"><span class="pre">current_app</span></code>: A hint indicating which application contains the current
view. See the namespaced URL resolution strategy for more information.</li>
<li><code class="docutils literal"><span class="pre">extra_context</span></code>: A dictionary of context data that will be added to the
default context data passed to the template.</li>
</ul>
<p><strong>Template context:</strong></p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">form</span></code>: The form (see <code class="docutils literal"><span class="pre">set_password_form</span></code> above) for setting the
new user&#8217;s password.</li>
<li><code class="docutils literal"><span class="pre">validlink</span></code>: Boolean, True if the link (combination of <code class="docutils literal"><span class="pre">uidb64</span></code> and
<code class="docutils literal"><span class="pre">token</span></code>) is valid or unused yet.</li>
</ul>
</div>
<div class="section" id="password-reset-complete">
<h3><code class="docutils literal"><span class="pre">password_reset_complete</span></code><a class="headerlink" href="#password-reset-complete" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="django.contrib.auth.views.password_reset_complete">
<code class="descclassname">django.contrib.auth.views.</code><code class="descname">password_reset_complete</code><span class="sig-paren">(</span><em>request</em><span class="optional">[</span>, <em>template_name</em>, <em>current_app</em>, <em>extra_context</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#django.contrib.auth.views.password_reset_complete" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Presents a view which informs the user that the password has been
successfully changed.</p>
<p><strong>Default URL:</strong> /password_reset_complete/</p>
<p><strong>Optional arguments:</strong></p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">template_name</span></code>: The full name of a template to display the view.
Defaults to <code class="file docutils literal"><span class="pre">registration/password_reset_complete.html</span></code>.</li>
<li><code class="docutils literal"><span class="pre">current_app</span></code>: A hint indicating which application contains the current
view. See the namespaced URL resolution strategy for more information.</li>
<li><code class="docutils literal"><span class="pre">extra_context</span></code>: A dictionary of context data that will be added to the
default context data passed to the template.</li>
</ul>
</div>
<div class="section" id="the-redirect-to-login-helper-function">
<h3>The <code class="docutils literal"><span class="pre">redirect_to_login</span></code> helper function<a class="headerlink" href="#the-redirect-to-login-helper-function" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="django.contrib.auth.views.redirect_to_login">
<code class="descclassname">django.contrib.auth.views.</code><code class="descname">redirect_to_login</code><span class="sig-paren">(</span><em>next</em><span class="optional">[</span>, <em>login_url</em>, <em>redirect_field_name</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#django.contrib.auth.views.redirect_to_login" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Django provides a convenient function, <code class="docutils literal"><span class="pre">redirect_to_login</span></code> that can be
used in a view for implementing custom access control. It redirects to the
login page, and then back to another URL after a successful login.</p>
<p><strong>Required arguments:</strong></p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">next</span></code>: The URL to redirect to after a successful login.</li>
</ul>
<p><strong>Optional arguments:</strong></p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">login_url</span></code>: The URL of the login page to redirect to.
Defaults to <code class="docutils literal"><span class="pre">LOGIN_URL</span></code> if not supplied.</li>
<li><code class="docutils literal"><span class="pre">redirect_field_name</span></code>: The name of a <code class="docutils literal"><span class="pre">GET</span></code> field containing the
URL to redirect to after log out. Overrides <code class="docutils literal"><span class="pre">next</span></code> if the given
<code class="docutils literal"><span class="pre">GET</span></code> parameter is passed.</li>
</ul>
</div>
</div>
<div class="section" id="built-in-forms">
<span id="built-in-auth-forms"></span><h2>Built-in forms<a class="headerlink" href="#built-in-forms" title="Permalink to this headline">¶</a></h2>
<p>If you don&#8217;t want to use the built-in views, but want the convenience of not
having to write forms for this functionality, the authentication system
provides several built-in forms located in <code class="xref py py-mod docutils literal"><span class="pre">django.contrib.auth.forms</span></code>:</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The built-in authentication forms make certain assumptions about the user
model that they are working with. If you&#8217;re using a custom User model
, it may be necessary to define your own forms for the
authentication system.</p>
</div>
<div class="section" id="adminpasswordchangeform">
<h3>AdminPasswordChangeForm<a class="headerlink" href="#adminpasswordchangeform" title="Permalink to this headline">¶</a></h3>
<p>A form used in the admin interface to change a user&#8217;s password.</p>
<p>Takes the <code class="docutils literal"><span class="pre">user</span></code> as the first positional argument.</p>
</div>
<div class="section" id="authenticationform">
<h3>AuthenticationForm<a class="headerlink" href="#authenticationform" title="Permalink to this headline">¶</a></h3>
<p>A form for logging a user in.</p>
<p>Takes <code class="docutils literal"><span class="pre">request</span></code> as its first positional argument, which is stored on the
form instance for use by sub-classes.</p>
<dl class="method">
<dt id="django.contrib.auth.views.confirm_login_allowed">
<code class="descclassname">django.contrib.auth.views.</code><code class="descname">confirm_login_allowed</code><span class="sig-paren">(</span><em>user</em><span class="sig-paren">)</span><a class="headerlink" href="#django.contrib.auth.views.confirm_login_allowed" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>By default, <code class="docutils literal"><span class="pre">AuthenticationForm</span></code> rejects users whose <code class="docutils literal"><span class="pre">is_active</span></code> flag
is set to <code class="docutils literal"><span class="pre">False</span></code>. You may override this behavior with a custom policy to
determine which users can log in. Do this with a custom form that subclasses
<code class="docutils literal"><span class="pre">AuthenticationForm</span></code> and overrides the <code class="docutils literal"><span class="pre">confirm_login_allowed</span></code> method.
This method should raise a <code class="xref py py-exc docutils literal"><span class="pre">ValidationError</span></code>
if the given user may not log in.</p>
<p>For example, to allow all users to log in, regardless of &#8220;active&#8221; status:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">django.contrib.auth.forms</span> <span class="kn">import</span> <span class="n">AuthenticationForm</span>

<span class="k">class</span> <span class="nc">AuthenticationFormWithInactiveUsersOkay</span><span class="p">(</span><span class="n">AuthenticationForm</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">confirm_login_allowed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">user</span><span class="p">):</span>
        <span class="k">pass</span>
</pre></div>
</div>
<p>Or to allow only some active users to log in:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">class</span> <span class="nc">PickyAuthenticationForm</span><span class="p">(</span><span class="n">AuthenticationForm</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">confirm_login_allowed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">user</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">user</span><span class="o">.</span><span class="n">is_active</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">forms</span><span class="o">.</span><span class="n">ValidationError</span><span class="p">(</span>
                <span class="n">_</span><span class="p">(</span><span class="s">&quot;This account is inactive.&quot;</span><span class="p">),</span>
                <span class="n">code</span><span class="o">=</span><span class="s">&#39;inactive&#39;</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="k">if</span> <span class="n">user</span><span class="o">.</span><span class="n">username</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s">&#39;b&#39;</span><span class="p">):</span>
            <span class="k">raise</span> <span class="n">forms</span><span class="o">.</span><span class="n">ValidationError</span><span class="p">(</span>
                <span class="n">_</span><span class="p">(</span><span class="s">&quot;Sorry, accounts starting with &#39;b&#39; aren&#39;t welcome here.&quot;</span><span class="p">),</span>
                <span class="n">code</span><span class="o">=</span><span class="s">&#39;no_b_users&#39;</span><span class="p">,</span>
            <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="passwordchangeform">
<h3>PasswordChangeForm<a class="headerlink" href="#passwordchangeform" title="Permalink to this headline">¶</a></h3>
<p>A form for allowing a user to change their password.</p>
</div>
<div class="section" id="passwordresetform">
<h3>PasswordResetForm<a class="headerlink" href="#passwordresetform" title="Permalink to this headline">¶</a></h3>
<p>A form for generating and emailing a one-time use link to reset a
user&#8217;s password.</p>
<dl class="method">
<dt id="django.contrib.auth.views.send_email">
<code class="descclassname">django.contrib.auth.views.</code><code class="descname">send_email</code><span class="sig-paren">(</span><em>subject_template_name</em>, <em>email_template_name</em>, <em>context</em>, <em>from_email</em>, <em>to_email</em><span class="optional">[</span>, <em>html_email_template_name=None</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#django.contrib.auth.views.send_email" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Uses the arguments to send an <code class="docutils literal"><span class="pre">EmailMultiAlternatives</span></code>.
Can be overridden to customize how the email is sent to the user.</p>
<ul>
<li><p class="first"><strong>subject_template_name:</strong> the template for the subject.</p>
</li>
<li><p class="first"><strong>email_template_name:</strong> the template for the email body.</p>
</li>
<li><dl class="first docutils">
<dt><strong>context:</strong> context passed to the <code class="docutils literal"><span class="pre">subject_template</span></code>, <code class="docutils literal"><span class="pre">email_template</span></code>,</dt>
<dd><p class="first last">and <code class="docutils literal"><span class="pre">html_email_template</span></code> (if it is not <code class="docutils literal"><span class="pre">None</span></code>).</p>
</dd>
</dl>
</li>
<li><p class="first"><strong>from_email:</strong> the sender&#8217;s email.</p>
</li>
<li><p class="first"><strong>to_email:</strong> the email of the requester.</p>
</li>
<li><dl class="first docutils">
<dt><strong>html_email_template_name:</strong> the template for the HTML body;</dt>
<dd><p class="first last">defaults to <code class="docutils literal"><span class="pre">None</span></code>, in which case a plain text email is sent.</p>
</dd>
</dl>
</li>
</ul>
<p>By default, <code class="docutils literal"><span class="pre">save()</span></code> populates the <code class="docutils literal"><span class="pre">context</span></code> with the
same variables that <a class="reference internal" href="#django.contrib.auth.views.password_reset" title="django.contrib.auth.views.password_reset"><code class="xref py py-func docutils literal"><span class="pre">password_reset()</span></code></a>
passes to its email context.</p>
</div>
<div class="section" id="setpasswordform">
<h3>SetPasswordForm<a class="headerlink" href="#setpasswordform" title="Permalink to this headline">¶</a></h3>
<p>A form that lets a user change their password without entering the old
password.</p>
</div>
<div class="section" id="userchangeform">
<h3>UserChangeForm<a class="headerlink" href="#userchangeform" title="Permalink to this headline">¶</a></h3>
<p>A form used in the admin interface to change a user&#8217;s information and
permissions.</p>
</div>
<div class="section" id="usercreationform">
<h3>UserCreationForm<a class="headerlink" href="#usercreationform" title="Permalink to this headline">¶</a></h3>
<p>A form for creating a new user.</p>
</div>
<div class="section" id="authentication-data-in-templates">
<h3>Authentication data in templates<a class="headerlink" href="#authentication-data-in-templates" title="Permalink to this headline">¶</a></h3>
<p>The currently logged-in user and their permissions are made available in the
template context when you use
<code class="xref py py-class docutils literal"><span class="pre">RequestContext</span></code>.</p>
<div class="section" id="users">
<h4>Users<a class="headerlink" href="#users" title="Permalink to this headline">¶</a></h4>
<p>When rendering a template <code class="xref py py-class docutils literal"><span class="pre">RequestContext</span></code>, the
currently logged-in user, either a  <code class="xref py py-class docutils literal"><span class="pre">User</span></code>
instance or an <code class="xref py py-class docutils literal"><span class="pre">AnonymousUser</span></code> instance, is
stored in the template variable <code class="docutils literal"><span class="pre">{{</span> <span class="pre">user</span> <span class="pre">}}</span></code>:</p>
<div class="highlight-html+django"><div class="highlight"><pre><span class="cp">{%</span> <span class="k">if</span> <span class="nv">user.is_authenticated</span> <span class="cp">%}</span>
    <span class="nt">&lt;p&gt;</span>Welcome, <span class="cp">{{</span> <span class="nv">user.username</span> <span class="cp">}}</span>. Thanks for logging in.<span class="nt">&lt;/p&gt;</span>
<span class="cp">{%</span> <span class="k">else</span> <span class="cp">%}</span>
    <span class="nt">&lt;p&gt;</span>Welcome, new user. Please log in.<span class="nt">&lt;/p&gt;</span>
<span class="cp">{%</span> <span class="k">endif</span> <span class="cp">%}</span>
</pre></div>
</div>
<p>This template context variable is not available if a <code class="docutils literal"><span class="pre">RequestContext</span></code> is not
being used.</p>
</div>
<div class="section" id="permissions">
<h4>Permissions<a class="headerlink" href="#permissions" title="Permalink to this headline">¶</a></h4>
<p>The currently logged-in user&#8217;s permissions are stored in the template variable
<code class="docutils literal"><span class="pre">{{</span> <span class="pre">perms</span> <span class="pre">}}</span></code>. This is an instance of
<code class="docutils literal"><span class="pre">django.contrib.auth.context_processors.PermWrapper</span></code>, which is a
template-friendly proxy of permissions.</p>
<p>In the <code class="docutils literal"><span class="pre">{{</span> <span class="pre">perms</span> <span class="pre">}}</span></code> object, single-attribute lookup is a proxy to
<code class="xref py py-meth docutils literal"><span class="pre">User.has_module_perms</span></code>.
This example would display <code class="docutils literal"><span class="pre">True</span></code> if the logged-in user had any permissions
in the <code class="docutils literal"><span class="pre">foo</span></code> app:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="p">{{</span> <span class="n">perms</span><span class="o">.</span><span class="n">foo</span> <span class="p">}}</span>
</pre></div>
</div>
<p>Two-level-attribute lookup is a proxy to
<code class="xref py py-meth docutils literal"><span class="pre">User.has_perm</span></code>. This example
would display <code class="docutils literal"><span class="pre">True</span></code> if the logged-in user had the permission
<code class="docutils literal"><span class="pre">foo.can_vote</span></code>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="p">{{</span> <span class="n">perms</span><span class="o">.</span><span class="n">foo</span><span class="o">.</span><span class="n">can_vote</span> <span class="p">}}</span>
</pre></div>
</div>
<p>Thus, you can check permissions in template <code class="docutils literal"><span class="pre">{%</span> <span class="pre">if</span> <span class="pre">%}</span></code> statements:</p>
<div class="highlight-html+django"><div class="highlight"><pre><span class="cp">{%</span> <span class="k">if</span> <span class="nv">perms.foo</span> <span class="cp">%}</span>
    <span class="nt">&lt;p&gt;</span>You have permission to do something in the foo app.<span class="nt">&lt;/p&gt;</span>
    <span class="cp">{%</span> <span class="k">if</span> <span class="nv">perms.foo.can_vote</span> <span class="cp">%}</span>
        <span class="nt">&lt;p&gt;</span>You can vote!<span class="nt">&lt;/p&gt;</span>
    <span class="cp">{%</span> <span class="k">endif</span> <span class="cp">%}</span>
    <span class="cp">{%</span> <span class="k">if</span> <span class="nv">perms.foo.can_drive</span> <span class="cp">%}</span>
        <span class="nt">&lt;p&gt;</span>You can drive!<span class="nt">&lt;/p&gt;</span>
    <span class="cp">{%</span> <span class="k">endif</span> <span class="cp">%}</span>
<span class="cp">{%</span> <span class="k">else</span> <span class="cp">%}</span>
    <span class="nt">&lt;p&gt;</span>You don&#39;t have permission to do anything in the foo app.<span class="nt">&lt;/p&gt;</span>
<span class="cp">{%</span> <span class="k">endif</span> <span class="cp">%}</span>
</pre></div>
</div>
<p>It is possible to also look permissions up by <code class="docutils literal"><span class="pre">{%</span> <span class="pre">if</span> <span class="pre">in</span> <span class="pre">%}</span></code> statements.
For example:</p>
<div class="highlight-html+django"><div class="highlight"><pre><span class="cp">{%</span> <span class="k">if</span> <span class="s1">&#39;foo&#39;</span> <span class="k">in</span> <span class="nv">perms</span> <span class="cp">%}</span>
    <span class="cp">{%</span> <span class="k">if</span> <span class="s1">&#39;foo.can_vote&#39;</span> <span class="k">in</span> <span class="nv">perms</span> <span class="cp">%}</span>
        <span class="nt">&lt;p&gt;</span>In lookup works, too.<span class="nt">&lt;/p&gt;</span>
    <span class="cp">{%</span> <span class="k">endif</span> <span class="cp">%}</span>
<span class="cp">{%</span> <span class="k">endif</span> <span class="cp">%}</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="managing-users-in-the-admin">
<span id="auth-admin"></span><h2>Managing users in the admin<a class="headerlink" href="#managing-users-in-the-admin" title="Permalink to this headline">¶</a></h2>
<p>When you have both <code class="docutils literal"><span class="pre">django.contrib.admin</span></code> and <code class="docutils literal"><span class="pre">django.contrib.auth</span></code>
installed, the admin provides a convenient way to view and manage users,
groups, and permissions. Users can be created and deleted like any Django
model. Groups can be created, and permissions can be assigned to users or
groups. A log of user edits to models made within the admin is also stored and
displayed.</p>
<div class="section" id="id7">
<h3>Creating Users<a class="headerlink" href="#id7" title="Permalink to this headline">¶</a></h3>
<p>You should see a link to &#8220;Users&#8221; in the &#8220;Auth&#8221;
section of the main admin index page.</p>
<div class="figure" id="id11">
<img alt="_images/admin_users.png" src="_images/admin_users.png" />
<p class="caption"><span class="caption-text">Figure 11-1: Django admin user management screen</span></p>
</div>
<p>The &#8220;Add user&#8221; admin page is different
than standard admin pages in that it requires you to choose a username and
password before allowing you to edit the rest of the user&#8217;s fields.</p>
<div class="figure" id="id12">
<img alt="_images/admin_adduser.png" src="_images/admin_adduser.png" />
<p class="caption"><span class="caption-text">Figure 11-2: Django admin add user screen</span></p>
</div>
<p>Also note: if you want a user account to be able to create users using the
Django admin site, you&#8217;ll need to give them permission to add users <em>and</em>
change users (i.e., the &#8220;Add user&#8221; and &#8220;Change user&#8221; permissions). If an
account has permission to add users but not to change them, that account won&#8217;t
be able to add users. Why? Because if you have permission to add users, you
have the power to create superusers, which can then, in turn, change other
users. So Django requires add <em>and</em> change permissions as a slight security
measure.</p>
</div>
<div class="section" id="id8">
<h3>Changing Passwords<a class="headerlink" href="#id8" title="Permalink to this headline">¶</a></h3>
<p>User passwords are not displayed in the admin (nor stored in the database), but
the password storage details are displayed.
Included in the display of this information is a link to
a password change form that allows admins to change user passwords.</p>
<div class="figure" id="id13">
<img alt="_images/admin_changeuser.png" src="_images/admin_changeuser.png" />
<p class="caption"><span class="caption-text">Figure 11-3: Link to change password (circled)</span></p>
</div>
<div class="figure" id="id14">
<img alt="_images/admin_changepassword.png" src="_images/admin_changepassword.png" />
<p class="caption"><span class="caption-text">Figure 11-4: Django admin change password form</span></p>
</div>
</div>
</div>
<div class="section" id="password-management-in-django">
<h2>Password management in Django<a class="headerlink" href="#password-management-in-django" title="Permalink to this headline">¶</a></h2>
<p>Password management is something that should generally not be reinvented
unnecessarily, and Django endeavors to provide a secure and flexible set of
tools for managing user passwords. This document describes how Django stores
passwords, how the storage hashing can be configured, and some utilities to
work with hashed passwords.</p>
<div class="section" id="how-django-stores-passwords">
<span id="auth-password-storage"></span><h3>How Django stores passwords<a class="headerlink" href="#how-django-stores-passwords" title="Permalink to this headline">¶</a></h3>
<p>Django provides a flexible password storage system and uses PBKDF2 by default.</p>
<p>The <code class="xref py py-attr docutils literal"><span class="pre">password</span></code> attribute of a
<code class="xref py py-class docutils literal"><span class="pre">User</span></code> object is a string in this format:</p>
<div class="highlight-python"><div class="highlight"><pre>&lt;algorithm&gt;$&lt;iterations&gt;$&lt;salt&gt;$&lt;hash&gt;
</pre></div>
</div>
<p>Those are the components used for storing a User&#8217;s password, separated by the
dollar-sign character and consist of: the hashing algorithm, the number of
algorithm iterations (work factor), the random salt, and the resulting password
hash.  The algorithm is one of a number of one-way hashing or password storage
algorithms Django can use; see below. Iterations describe the number of times
the algorithm is run over the hash. Salt is the random seed used and the hash
is the result of the one-way function.</p>
<p>By default, Django uses the <a class="reference external" href="http://en.wikipedia.org/wiki/PBKDF2">PBKDF2</a> algorithm with a SHA256 hash, a
password stretching mechanism recommended by <a class="reference external" href="http://csrc.nist.gov/publications/nistpubs/800-132/nist-sp800-132.pdf">NIST</a>. This should be
sufficient for most users: it&#8217;s quite secure, requiring massive
amounts of computing time to break.</p>
<p>However, depending on your requirements, you may choose a different
algorithm, or even use a custom algorithm to match your specific
security situation. Again, most users shouldn&#8217;t need to do this &#8211; if
you&#8217;re not sure, you probably don&#8217;t.  If you do, please read on:</p>
<p>Django chooses the algorithm to use by consulting the
<code class="docutils literal"><span class="pre">PASSWORD_HASHERS</span></code> setting. This is a list of hashing algorithm
classes that this Django installation supports. The first entry in this list
(that is, <code class="docutils literal"><span class="pre">settings.PASSWORD_HASHERS[0]</span></code>) will be used to store passwords,
and all the other entries are valid hashers that can be used to check existing
passwords.  This means that if you want to use a different algorithm, you&#8217;ll
need to modify <code class="docutils literal"><span class="pre">PASSWORD_HASHERS</span></code> to list your preferred algorithm
first in the list.</p>
<p>The default for <code class="docutils literal"><span class="pre">PASSWORD_HASHERS</span></code> is:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">PASSWORD_HASHERS</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s">&#39;django.contrib.auth.hashers.PBKDF2PasswordHasher&#39;</span><span class="p">,</span>
    <span class="s">&#39;django.contrib.auth.hashers.PBKDF2SHA1PasswordHasher&#39;</span><span class="p">,</span>
    <span class="s">&#39;django.contrib.auth.hashers.BCryptSHA256PasswordHasher&#39;</span><span class="p">,</span>
    <span class="s">&#39;django.contrib.auth.hashers.BCryptPasswordHasher&#39;</span><span class="p">,</span>
    <span class="s">&#39;django.contrib.auth.hashers.SHA1PasswordHasher&#39;</span><span class="p">,</span>
    <span class="s">&#39;django.contrib.auth.hashers.MD5PasswordHasher&#39;</span><span class="p">,</span>
    <span class="s">&#39;django.contrib.auth.hashers.CryptPasswordHasher&#39;</span><span class="p">,</span>
<span class="p">]</span>
</pre></div>
</div>
<p>This means that Django will use <a class="reference external" href="http://en.wikipedia.org/wiki/PBKDF2">PBKDF2</a> to store all passwords, but will support
checking passwords stored with PBKDF2SHA1, <a class="reference external" href="http://en.wikipedia.org/wiki/Bcrypt">bcrypt</a>, <a class="reference external" href="http://en.wikipedia.org/wiki/SHA1">SHA1</a>, etc. The next few
sections describe a couple of common ways advanced users may want to modify this
setting.</p>
</div>
<div class="section" id="using-bcrypt-with-django">
<span id="bcrypt-usage"></span><h3>Using bcrypt with Django<a class="headerlink" href="#using-bcrypt-with-django" title="Permalink to this headline">¶</a></h3>
<p><a class="reference external" href="http://en.wikipedia.org/wiki/Bcrypt">Bcrypt</a> is a popular password storage algorithm that&#8217;s specifically designed
for long-term password storage. It&#8217;s not the default used by Django since it
requires the use of third-party libraries, but since many people may want to
use it Django supports bcrypt with minimal effort.</p>
<p>To use Bcrypt as your default storage algorithm, do the following:</p>
<ol class="arabic">
<li><p class="first">Install the <a class="reference external" href="https://pypi.python.org/pypi/bcrypt/">bcrypt library</a>. This can be done by running <code class="docutils literal"><span class="pre">pip</span> <span class="pre">install</span>
<span class="pre">django[bcrypt]</span></code>, or by downloading the library and installing it with
<code class="docutils literal"><span class="pre">python</span> <span class="pre">setup.py</span> <span class="pre">install</span></code>.</p>
</li>
<li><p class="first">Modify <code class="docutils literal"><span class="pre">PASSWORD_HASHERS</span></code> to list <code class="docutils literal"><span class="pre">BCryptSHA256PasswordHasher</span></code>
first. That is, in your settings file, you&#8217;d put:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">PASSWORD_HASHERS</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s">&#39;django.contrib.auth.hashers.BCryptSHA256PasswordHasher&#39;</span><span class="p">,</span>
    <span class="s">&#39;django.contrib.auth.hashers.BCryptPasswordHasher&#39;</span><span class="p">,</span>
    <span class="s">&#39;django.contrib.auth.hashers.PBKDF2PasswordHasher&#39;</span><span class="p">,</span>
    <span class="s">&#39;django.contrib.auth.hashers.PBKDF2SHA1PasswordHasher&#39;</span><span class="p">,</span>
    <span class="s">&#39;django.contrib.auth.hashers.SHA1PasswordHasher&#39;</span><span class="p">,</span>
    <span class="s">&#39;django.contrib.auth.hashers.MD5PasswordHasher&#39;</span><span class="p">,</span>
    <span class="s">&#39;django.contrib.auth.hashers.CryptPasswordHasher&#39;</span><span class="p">,</span>
<span class="p">]</span>
</pre></div>
</div>
<p>(You need to keep the other entries in this list, or else Django won&#8217;t
be able to upgrade passwords; see below).</p>
</li>
</ol>
<p>That&#8217;s it &#8211; now your Django install will use bcrypt as the default storage
algorithm.</p>
<div class="admonition-password-truncation-with-bcryptpasswordhasher admonition">
<p class="first admonition-title">Password truncation with BCryptPasswordHasher</p>
<p class="last">The designers of bcrypt truncate all passwords at 72 characters which means
that <code class="docutils literal"><span class="pre">bcrypt(password_with_100_chars)</span> <span class="pre">==</span> <span class="pre">bcrypt(password_with_100_chars[:72])</span></code>.
The original <code class="docutils literal"><span class="pre">BCryptPasswordHasher</span></code> does not have any special handling and
thus is also subject to this hidden password length limit.
<code class="docutils literal"><span class="pre">BCryptSHA256PasswordHasher</span></code> fixes this by first first hashing the
password using sha256. This prevents the password truncation and so should
be preferred over the <code class="docutils literal"><span class="pre">BCryptPasswordHasher</span></code>. The practical ramification
of this truncation is pretty marginal as the average user does not have a
password greater than 72 characters in length and even being truncated at 72
the compute powered required to brute force bcrypt in any useful amount of
time is still astronomical. Nonetheless, we recommend you use
<code class="docutils literal"><span class="pre">BCryptSHA256PasswordHasher</span></code> anyway on the principle of &#8220;better safe than
sorry&#8221;.</p>
</div>
<div class="admonition-other-bcrypt-implementations admonition">
<p class="first admonition-title">Other bcrypt implementations</p>
<p class="last">There are several other implementations that allow bcrypt to be
used with Django. Django&#8217;s bcrypt support is NOT directly
compatible with these. To upgrade, you will need to modify the
hashes in your database to be in the form <code class="docutils literal"><span class="pre">bcrypt$(raw</span> <span class="pre">bcrypt</span>
<span class="pre">output)</span></code>. For example:
<code class="docutils literal"><span class="pre">bcrypt$$2a$12$NT0I31Sa7ihGEWpka9ASYrEFkhuTNeBQ2xfZskIiiJeyFXhRgS.Sy</span></code>.</p>
</div>
</div>
<div class="section" id="increasing-the-work-factor">
<span id="increasing-password-algorithm-work-factor"></span><h3>Increasing the work factor<a class="headerlink" href="#increasing-the-work-factor" title="Permalink to this headline">¶</a></h3>
<p>The PBKDF2 and bcrypt algorithms use a number of iterations or rounds of
hashing. This deliberately slows down attackers, making attacks against hashed
passwords harder. However, as computing power increases, the number of
iterations needs to be increased. We&#8217;ve chosen a reasonable default (and will
increase it with each release of Django), but you may wish to tune it up or
down, depending on your security needs and available processing power. To do so,
you&#8217;ll subclass the appropriate algorithm and override the <code class="docutils literal"><span class="pre">iterations</span></code>
parameters. For example, to increase the number of iterations used by the
default PBKDF2 algorithm:</p>
<ol class="arabic">
<li><p class="first">Create a subclass of <code class="docutils literal"><span class="pre">django.contrib.auth.hashers.PBKDF2PasswordHasher</span></code>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">django.contrib.auth.hashers</span> <span class="kn">import</span> <span class="n">PBKDF2PasswordHasher</span>

<span class="k">class</span> <span class="nc">MyPBKDF2PasswordHasher</span><span class="p">(</span><span class="n">PBKDF2PasswordHasher</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A subclass of PBKDF2PasswordHasher that uses 100 times more iterations.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">iterations</span> <span class="o">=</span> <span class="n">PBKDF2PasswordHasher</span><span class="o">.</span><span class="n">iterations</span> <span class="o">*</span> <span class="mi">100</span>
</pre></div>
</div>
<p>Save this somewhere in your project. For example, you might put this in
a file like <code class="docutils literal"><span class="pre">myproject/hashers.py</span></code>.</p>
</li>
<li><p class="first">Add your new hasher as the first entry in <code class="docutils literal"><span class="pre">PASSWORD_HASHERS</span></code>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">PASSWORD_HASHERS</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s">&#39;myproject.hashers.MyPBKDF2PasswordHasher&#39;</span><span class="p">,</span>
    <span class="s">&#39;django.contrib.auth.hashers.PBKDF2PasswordHasher&#39;</span><span class="p">,</span>
    <span class="s">&#39;django.contrib.auth.hashers.PBKDF2SHA1PasswordHasher&#39;</span><span class="p">,</span>
    <span class="s">&#39;django.contrib.auth.hashers.BCryptSHA256PasswordHasher&#39;</span><span class="p">,</span>
    <span class="s">&#39;django.contrib.auth.hashers.BCryptPasswordHasher&#39;</span><span class="p">,</span>
    <span class="s">&#39;django.contrib.auth.hashers.SHA1PasswordHasher&#39;</span><span class="p">,</span>
    <span class="s">&#39;django.contrib.auth.hashers.MD5PasswordHasher&#39;</span><span class="p">,</span>
    <span class="s">&#39;django.contrib.auth.hashers.CryptPasswordHasher&#39;</span><span class="p">,</span>
<span class="p">]</span>
</pre></div>
</div>
</li>
</ol>
<p>That&#8217;s it &#8211; now your Django install will use more iterations when it
stores passwords using PBKDF2.</p>
</div>
<div class="section" id="password-upgrading">
<span id="password-upgrades"></span><h3>Password upgrading<a class="headerlink" href="#password-upgrading" title="Permalink to this headline">¶</a></h3>
<p>When users log in, if their passwords are stored with anything other than
the preferred algorithm, Django will automatically upgrade the algorithm
to the preferred one. This means that old installs of Django will get
automatically more secure as users log in, and it also means that you
can switch to new (and better) storage algorithms as they get invented.</p>
<p>However, Django can only upgrade passwords that use algorithms mentioned in
<code class="docutils literal"><span class="pre">PASSWORD_HASHERS</span></code>, so as you upgrade to new systems you should make
sure never to <em>remove</em> entries from this list. If you do, users using
unmentioned algorithms won&#8217;t be able to upgrade. Passwords will be upgraded
when changing the PBKDF2 iteration count.</p>
</div>
</div>
<div class="section" id="module-django.contrib.auth.hashers">
<span id="manually-managing-a-user-s-password"></span><h2>Manually managing a user&#8217;s password<a class="headerlink" href="#module-django.contrib.auth.hashers" title="Permalink to this headline">¶</a></h2>
<p>The <a class="reference internal" href="#module-django.contrib.auth.hashers" title="django.contrib.auth.hashers"><code class="xref py py-mod docutils literal"><span class="pre">django.contrib.auth.hashers</span></code></a> module provides a set of functions
to create and validate hashed password. You can use them independently
from the <code class="docutils literal"><span class="pre">User</span></code> model.</p>
<dl class="function">
<dt id="django.contrib.auth.hashers.check_password">
<code class="descclassname">django.contrib.auth.hashers.</code><code class="descname">check_password</code><span class="sig-paren">(</span><em>password</em>, <em>encoded</em><span class="sig-paren">)</span><a class="headerlink" href="#django.contrib.auth.hashers.check_password" title="Permalink to this definition">¶</a></dt>
<dd><p>If you&#8217;d like to manually authenticate a user by comparing a plain-text
password to the hashed password in the database, use the convenience
function <a class="reference internal" href="#django.contrib.auth.hashers.check_password" title="django.contrib.auth.hashers.check_password"><code class="xref py py-func docutils literal"><span class="pre">check_password()</span></code></a>. It takes two arguments: the plain-text
password to check, and the full value of a user&#8217;s <code class="docutils literal"><span class="pre">password</span></code> field in the
database to check against, and returns <code class="docutils literal"><span class="pre">True</span></code> if they match, <code class="docutils literal"><span class="pre">False</span></code>
otherwise.</p>
</dd></dl>

<dl class="function">
<dt id="django.contrib.auth.hashers.make_password">
<code class="descclassname">django.contrib.auth.hashers.</code><code class="descname">make_password</code><span class="sig-paren">(</span><em>password</em>, <em>salt=None</em>, <em>hasher='default'</em><span class="sig-paren">)</span><a class="headerlink" href="#django.contrib.auth.hashers.make_password" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a hashed password in the format used by this application. It takes
one mandatory argument: the password in plain-text. Optionally, you can
provide a salt and a hashing algorithm to use, if you don&#8217;t want to use the
defaults (first entry of <code class="docutils literal"><span class="pre">PASSWORD_HASHERS</span></code> setting).
Currently supported algorithms are: <code class="docutils literal"><span class="pre">'pbkdf2_sha256'</span></code>, <code class="docutils literal"><span class="pre">'pbkdf2_sha1'</span></code>,
<code class="docutils literal"><span class="pre">'bcrypt_sha256'</span></code>, <code class="docutils literal"><span class="pre">'bcrypt'</span></code>, <code class="docutils literal"><span class="pre">'sha1'</span></code>,
<code class="docutils literal"><span class="pre">'md5'</span></code>, <code class="docutils literal"><span class="pre">'unsalted_md5'</span></code> (only for backward compatibility) and <code class="docutils literal"><span class="pre">'crypt'</span></code>
if you have the <code class="docutils literal"><span class="pre">crypt</span></code> library installed. If the password argument is
<code class="docutils literal"><span class="pre">None</span></code>, an unusable password is returned (a one that will be never
accepted by <a class="reference internal" href="#django.contrib.auth.hashers.check_password" title="django.contrib.auth.hashers.check_password"><code class="xref py py-func docutils literal"><span class="pre">check_password()</span></code></a>).</p>
</dd></dl>

<dl class="function">
<dt id="django.contrib.auth.hashers.is_password_usable">
<code class="descclassname">django.contrib.auth.hashers.</code><code class="descname">is_password_usable</code><span class="sig-paren">(</span><em>encoded_password</em><span class="sig-paren">)</span><a class="headerlink" href="#django.contrib.auth.hashers.is_password_usable" title="Permalink to this definition">¶</a></dt>
<dd><p>Checks if the given string is a hashed password that has a chance
of being verified against <a class="reference internal" href="#django.contrib.auth.hashers.check_password" title="django.contrib.auth.hashers.check_password"><code class="xref py py-func docutils literal"><span class="pre">check_password()</span></code></a>.</p>
</dd></dl>

</div>
<div class="section" id="customizing-authentication-in-django">
<h2>Customizing authentication in Django<a class="headerlink" href="#customizing-authentication-in-django" title="Permalink to this headline">¶</a></h2>
<p>The authentication that comes with Django is good enough for most common cases,
but you may have needs not met by the out-of-the-box defaults. To customize
authentication to your projects needs involves understanding what points of the
provided system are extensible or replaceable. This document provides details
about how the auth system can be customized.</p>
<p><cite>Authentication backends</cite> provide an extensible
system for when a username and password stored with the User model need
to be authenticated against a different service than Django&#8217;s default.</p>
<p>You can give your models custom permissions that can be
checked through Django&#8217;s authorization system.</p>
<p>You can extend the default User model, or substitute
a completely customized model.</p>
</div>
<div class="section" id="other-authentication-sources">
<span id="authentication-backends"></span><h2>Other authentication sources<a class="headerlink" href="#other-authentication-sources" title="Permalink to this headline">¶</a></h2>
<p>There may be times you have the need to hook into another authentication source
&#8211; that is, another source of usernames and passwords or authentication
methods.</p>
<p>For example, your company may already have an LDAP setup that stores a username
and password for every employee. It&#8217;d be a hassle for both the network
administrator and the users themselves if users had separate accounts in LDAP
and the Django-based applications.</p>
<p>So, to handle situations like this, the Django authentication system lets you
plug in other authentication sources. You can override Django&#8217;s default
database-based scheme, or you can use the default system in tandem with other
systems.</p>
<div class="section" id="specifying-authentication-backends">
<h3>Specifying authentication backends<a class="headerlink" href="#specifying-authentication-backends" title="Permalink to this headline">¶</a></h3>
<p>Behind the scenes, Django maintains a list of &#8220;authentication backends&#8221; that it
checks for authentication. When somebody calls
<code class="xref py py-func docutils literal"><span class="pre">django.contrib.auth.authenticate()</span></code> &#8211; as described in the previous
section on logging a user in &#8211; Django tries authenticating across
all of its authentication backends. If the first authentication method fails,
Django tries the second one, and so on, until all backends have been attempted.</p>
<p>The list of authentication backends to use is specified in the
<code class="docutils literal"><span class="pre">AUTHENTICATION_BACKENDS</span></code> setting. This should be a list of Python
path names that point to Python classes that know how to authenticate. These
classes can be anywhere on your Python path.</p>
<p>By default, <code class="docutils literal"><span class="pre">AUTHENTICATION_BACKENDS</span></code> is set to:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="p">[</span><span class="s">&#39;django.contrib.auth.backends.ModelBackend&#39;</span><span class="p">]</span>
</pre></div>
</div>
<p>That&#8217;s the basic authentication backend that checks the Django users database
and queries the built-in permissions. It does not provide protection against
brute force attacks via any rate limiting mechanism. You may either implement
your own rate limiting mechanism in a custom auth backend, or use the
mechanisms provided by most Web servers.</p>
<p>The order of <code class="docutils literal"><span class="pre">AUTHENTICATION_BACKENDS</span></code> matters, so if the same
username and password is valid in multiple backends, Django will stop
processing at the first positive match.</p>
<p>If a backend raises a <code class="xref py py-class docutils literal"><span class="pre">PermissionDenied</span></code>
exception, authentication will immediately fail. Django won&#8217;t check the
backends that follow.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Once a user has authenticated, Django stores which backend was used to
authenticate the user in the user&#8217;s session, and re-uses the same backend
for the duration of that session whenever access to the currently
authenticated user is needed. This effectively means that authentication
sources are cached on a per-session basis, so if you change
<code class="docutils literal"><span class="pre">AUTHENTICATION_BACKENDS</span></code>, you&#8217;ll need to clear out session data if
you need to force users to re-authenticate using different methods. A simple
way to do that is simply to execute <code class="docutils literal"><span class="pre">Session.objects.all().delete()</span></code>.</p>
</div>
</div>
<div class="section" id="writing-an-authentication-backend">
<h3>Writing an authentication backend<a class="headerlink" href="#writing-an-authentication-backend" title="Permalink to this headline">¶</a></h3>
<p>An authentication backend is a class that implements two required methods:
<code class="docutils literal"><span class="pre">get_user(user_id)</span></code> and <code class="docutils literal"><span class="pre">authenticate(**credentials)</span></code>, as well as a set of
optional permission related authorization methods.</p>
<p>The <code class="docutils literal"><span class="pre">get_user</span></code> method takes a <code class="docutils literal"><span class="pre">user_id</span></code> &#8211; which could be a username,
database ID or whatever, but has to be the primary key of your <code class="docutils literal"><span class="pre">User</span></code> object
&#8211; and returns a <code class="docutils literal"><span class="pre">User</span></code> object.</p>
<p>The <code class="docutils literal"><span class="pre">authenticate</span></code> method takes credentials as keyword arguments. Most of
the time, it&#8217;ll just look like this:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">class</span> <span class="nc">MyBackend</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">authenticate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">username</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="c"># Check the username/password and return a User.</span>
        <span class="o">...</span>
</pre></div>
</div>
<p>But it could also authenticate a token, like so:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">class</span> <span class="nc">MyBackend</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">authenticate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">token</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="c"># Check the token and return a User.</span>
        <span class="o">...</span>
</pre></div>
</div>
<p>Either way, <code class="docutils literal"><span class="pre">authenticate</span></code> should check the credentials it gets, and it
should return a <code class="docutils literal"><span class="pre">User</span></code> object that matches those credentials, if the
credentials are valid. If they&#8217;re not valid, it should return <code class="docutils literal"><span class="pre">None</span></code>.</p>
<p>The Django admin system is tightly coupled to the Django <code class="docutils literal"><span class="pre">User</span></code> object
described at the beginning of this document. For now, the best way to deal with
this is to create a Django <code class="docutils literal"><span class="pre">User</span></code> object for each user that exists for your
backend (e.g., in your LDAP directory, your external SQL database, etc.) You
can either write a script to do this in advance, or your <code class="docutils literal"><span class="pre">authenticate</span></code>
method can do it the first time a user logs in.</p>
<p>Here&#8217;s an example backend that authenticates against a username and password
variable defined in your <code class="docutils literal"><span class="pre">settings.py</span></code> file and creates a Django <code class="docutils literal"><span class="pre">User</span></code>
object the first time a user authenticates:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">django.conf</span> <span class="kn">import</span> <span class="n">settings</span>
<span class="kn">from</span> <span class="nn">django.contrib.auth.models</span> <span class="kn">import</span> <span class="n">User</span><span class="p">,</span> <span class="n">check_password</span>

<span class="k">class</span> <span class="nc">SettingsBackend</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Authenticate against the settings ADMIN_LOGIN and ADMIN_PASSWORD.</span>

<span class="sd">    Use the login name, and a hash of the password. For example:</span>

<span class="sd">    ADMIN_LOGIN = &#39;admin&#39;</span>
<span class="sd">    ADMIN_PASSWORD = &#39;sha1$4e987$afbcf42e21bd417fb71db8c66b321e9fc33051de&#39;</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">authenticate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">username</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="n">login_valid</span> <span class="o">=</span> <span class="p">(</span><span class="n">settings</span><span class="o">.</span><span class="n">ADMIN_LOGIN</span> <span class="o">==</span> <span class="n">username</span><span class="p">)</span>
        <span class="n">pwd_valid</span> <span class="o">=</span> <span class="n">check_password</span><span class="p">(</span><span class="n">password</span><span class="p">,</span> <span class="n">settings</span><span class="o">.</span><span class="n">ADMIN_PASSWORD</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">login_valid</span> <span class="ow">and</span> <span class="n">pwd_valid</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">user</span> <span class="o">=</span> <span class="n">User</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">username</span><span class="o">=</span><span class="n">username</span><span class="p">)</span>
            <span class="k">except</span> <span class="n">User</span><span class="o">.</span><span class="n">DoesNotExist</span><span class="p">:</span>
                <span class="c"># Create a new user. Note that we can set password</span>
                <span class="c"># to anything, because it won&#39;t be checked; the password</span>
                <span class="c"># from settings.py will.</span>
                <span class="n">user</span> <span class="o">=</span> <span class="n">User</span><span class="p">(</span><span class="n">username</span><span class="o">=</span><span class="n">username</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="s">&#39;get from settings.py&#39;</span><span class="p">)</span>
                <span class="n">user</span><span class="o">.</span><span class="n">is_staff</span> <span class="o">=</span> <span class="bp">True</span>
                <span class="n">user</span><span class="o">.</span><span class="n">is_superuser</span> <span class="o">=</span> <span class="bp">True</span>
                <span class="n">user</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
            <span class="k">return</span> <span class="n">user</span>
        <span class="k">return</span> <span class="bp">None</span>

    <span class="k">def</span> <span class="nf">get_user</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">user_id</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">User</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">pk</span><span class="o">=</span><span class="n">user_id</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">User</span><span class="o">.</span><span class="n">DoesNotExist</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">None</span>
</pre></div>
</div>
</div>
<div class="section" id="handling-authorization-in-custom-backends">
<span id="authorization-methods"></span><h3>Handling authorization in custom backends<a class="headerlink" href="#handling-authorization-in-custom-backends" title="Permalink to this headline">¶</a></h3>
<p>Custom auth backends can provide their own permissions.</p>
<p>The user model will delegate permission lookup functions
(<code class="xref py py-meth docutils literal"><span class="pre">get_group_permissions()</span></code>,
<code class="xref py py-meth docutils literal"><span class="pre">get_all_permissions()</span></code>,
<code class="xref py py-meth docutils literal"><span class="pre">has_perm()</span></code>, and
<code class="xref py py-meth docutils literal"><span class="pre">has_module_perms()</span></code>) to any
authentication backend that implements these functions.</p>
<p>The permissions given to the user will be the superset of all permissions
returned by all backends. That is, Django grants a permission to a user that
any one backend grants.</p>
<p>If a backend raises a <code class="xref py py-class docutils literal"><span class="pre">PermissionDenied</span></code>
exception in <code class="xref py py-meth docutils literal"><span class="pre">has_perm()</span></code> or
<code class="xref py py-meth docutils literal"><span class="pre">has_module_perms()</span></code>,
the authorization will immediately fail and Django
won&#8217;t check the backends that follow.</p>
<p>The simple backend above could implement permissions for the magic admin
fairly simply:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">class</span> <span class="nc">SettingsBackend</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="o">...</span>
    <span class="k">def</span> <span class="nf">has_perm</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">user_obj</span><span class="p">,</span> <span class="n">perm</span><span class="p">,</span> <span class="n">obj</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">user_obj</span><span class="o">.</span><span class="n">username</span> <span class="o">==</span> <span class="n">settings</span><span class="o">.</span><span class="n">ADMIN_LOGIN</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">False</span>
</pre></div>
</div>
<p>This gives full permissions to the user granted access in the above example.
Notice that in addition to the same arguments given to the associated
<code class="xref py py-class docutils literal"><span class="pre">django.contrib.auth.models.User</span></code> functions, the backend auth functions
all take the user object, which may be an anonymous user, as an argument.</p>
<p>A full authorization implementation can be found in the <code class="docutils literal"><span class="pre">ModelBackend</span></code> class
in <a class="reference external" href="https://github.com/django/django/blob/master/django/contrib/auth/backends.py">django/contrib/auth/backends.py</a>, which is the default backend and queries
the <code class="docutils literal"><span class="pre">auth_permission</span></code> table most of the time. If you wish to provide
custom behavior for only part of the backend API, you can take advantage of
Python inheritance and subclass <code class="docutils literal"><span class="pre">ModelBackend</span></code> instead of implementing the
complete API in a custom backend.</p>
<div class="section" id="authorization-for-anonymous-users">
<span id="anonymous-auth"></span><h4>Authorization for anonymous users<a class="headerlink" href="#authorization-for-anonymous-users" title="Permalink to this headline">¶</a></h4>
<p>An anonymous user is one that is not authenticated i.e. they have provided no
valid authentication details. However, that does not necessarily mean they are
not authorized to do anything. At the most basic level, most Web sites
authorize anonymous users to browse most of the site, and many allow anonymous
posting of comments etc.</p>
<p>Django&#8217;s permission framework does not have a place to store permissions for
anonymous users. However, the user object passed to an authentication backend
may be an <code class="xref py py-class docutils literal"><span class="pre">django.contrib.auth.models.AnonymousUser</span></code> object, allowing
the backend to specify custom authorization behavior for anonymous users. This
is especially useful for the authors of re-usable apps, who can delegate all
questions of authorization to the auth backend, rather than needing settings,
for example, to control anonymous access.</p>
</div>
<div class="section" id="authorization-for-inactive-users">
<span id="inactive-auth"></span><h4>Authorization for inactive users<a class="headerlink" href="#authorization-for-inactive-users" title="Permalink to this headline">¶</a></h4>
<p>An inactive user is a one that is authenticated but has its attribute
<code class="docutils literal"><span class="pre">is_active</span></code> set to <code class="docutils literal"><span class="pre">False</span></code>. However this does not mean they are not
authorized to do anything. For example they are allowed to activate their
account.</p>
<p>The support for anonymous users in the permission system allows for a scenario
where anonymous users have permissions to do something while inactive
authenticated users do not.</p>
<p>Do not forget to test for the <code class="docutils literal"><span class="pre">is_active</span></code> attribute of the user in your own
backend permission methods.</p>
</div>
<div class="section" id="handling-object-permissions">
<h4>Handling object permissions<a class="headerlink" href="#handling-object-permissions" title="Permalink to this headline">¶</a></h4>
<p>Django&#8217;s permission framework has a foundation for object permissions, though
there is no implementation for it in the core. That means that checking for
object permissions will always return <code class="docutils literal"><span class="pre">False</span></code> or an empty list (depending on
the check performed). An authentication backend will receive the keyword
parameters <code class="docutils literal"><span class="pre">obj</span></code> and <code class="docutils literal"><span class="pre">user_obj</span></code> for each object related authorization
method and can return the object level permission as appropriate.</p>
</div>
</div>
</div>
<div class="section" id="custom-permissions">
<span id="id9"></span><h2>Custom permissions<a class="headerlink" href="#custom-permissions" title="Permalink to this headline">¶</a></h2>
<p>To create custom permissions for a given model object, use the <code class="docutils literal"><span class="pre">permissions</span></code>
model Meta attribute.</p>
<p>This example Task model creates three custom permissions, i.e., actions users
can or cannot do with Task instances, specific to your application:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">class</span> <span class="nc">Task</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="o">...</span>
    <span class="k">class</span> <span class="nc">Meta</span><span class="p">:</span>
        <span class="n">permissions</span> <span class="o">=</span> <span class="p">(</span>
            <span class="p">(</span><span class="s">&quot;view_task&quot;</span><span class="p">,</span> <span class="s">&quot;Can see available tasks&quot;</span><span class="p">),</span>
            <span class="p">(</span><span class="s">&quot;change_task_status&quot;</span><span class="p">,</span> <span class="s">&quot;Can change the status of tasks&quot;</span><span class="p">),</span>
            <span class="p">(</span><span class="s">&quot;close_task&quot;</span><span class="p">,</span> <span class="s">&quot;Can remove a task by setting its status as closed&quot;</span><span class="p">),</span>
        <span class="p">)</span>
</pre></div>
</div>
<p>The only thing this does is create those extra permissions when you run
<code class="docutils literal"><span class="pre">manage.py</span> <span class="pre">migrate</span></code>. Your code is in charge of checking the
value of these permissions when a user is trying to access the functionality
provided by the application (viewing tasks, changing the status of tasks,
closing tasks.) Continuing the above example, the following checks if a user may
view tasks:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">user</span><span class="o">.</span><span class="n">has_perm</span><span class="p">(</span><span class="s">&#39;app.view_task&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="extending-the-existing-user-model">
<span id="extending-user"></span><h2>Extending the existing User model<a class="headerlink" href="#extending-the-existing-user-model" title="Permalink to this headline">¶</a></h2>
<p>There are two ways to extend the default
<code class="xref py py-class docutils literal"><span class="pre">User</span></code> model without substituting your own
model. If the changes you need are purely behavioral, and don&#8217;t require any
change to what is stored in the database, you can create a proxy model based
on <code class="xref py py-class docutils literal"><span class="pre">User</span></code>. This allows for any of the
features offered by proxy models including default
ordering, custom managers, or custom model methods.</p>
<p>If you wish to store information related to <code class="docutils literal"><span class="pre">User</span></code>, you can use a one-to-one
relationship to a model containing the fields for
additional information. This one-to-one model is often called a profile model,
as it might store non-auth related information about a site user. For example
you might create an Employee model:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">django.contrib.auth.models</span> <span class="kn">import</span> <span class="n">User</span>

<span class="k">class</span> <span class="nc">Employee</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">user</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">OneToOneField</span><span class="p">(</span><span class="n">User</span><span class="p">)</span>
    <span class="n">department</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
</pre></div>
</div>
<p>Assuming an existing Employee Fred Smith who has both a User and Employee
model, you can access the related information using Django&#8217;s standard related
model conventions:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">u</span> <span class="o">=</span> <span class="n">User</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">username</span><span class="o">=</span><span class="s">&#39;fsmith&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">freds_department</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">employee</span><span class="o">.</span><span class="n">department</span>
</pre></div>
</div>
<p>To add a profile model&#8217;s fields to the user page in the admin, define an
<code class="xref py py-class docutils literal"><span class="pre">InlineModelAdmin</span></code> (for this example, we&#8217;ll use a
<code class="xref py py-class docutils literal"><span class="pre">StackedInline</span></code>) in your app&#8217;s <code class="docutils literal"><span class="pre">admin.py</span></code> and
add it to a <code class="docutils literal"><span class="pre">UserAdmin</span></code> class which is registered with the
<code class="xref py py-class docutils literal"><span class="pre">User</span></code> class:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">django.contrib</span> <span class="kn">import</span> <span class="n">admin</span>
<span class="kn">from</span> <span class="nn">django.contrib.auth.admin</span> <span class="kn">import</span> <span class="n">UserAdmin</span>
<span class="kn">from</span> <span class="nn">django.contrib.auth.models</span> <span class="kn">import</span> <span class="n">User</span>

<span class="kn">from</span> <span class="nn">my_user_profile_app.models</span> <span class="kn">import</span> <span class="n">Employee</span>

<span class="c"># Define an inline admin descriptor for Employee model</span>
<span class="c"># which acts a bit like a singleton</span>
<span class="k">class</span> <span class="nc">EmployeeInline</span><span class="p">(</span><span class="n">admin</span><span class="o">.</span><span class="n">StackedInline</span><span class="p">):</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">Employee</span>
    <span class="n">can_delete</span> <span class="o">=</span> <span class="bp">False</span>
    <span class="n">verbose_name_plural</span> <span class="o">=</span> <span class="s">&#39;employee&#39;</span>

<span class="c"># Define a new User admin</span>
<span class="k">class</span> <span class="nc">UserAdmin</span><span class="p">(</span><span class="n">UserAdmin</span><span class="p">):</span>
    <span class="n">inlines</span> <span class="o">=</span> <span class="p">(</span><span class="n">EmployeeInline</span><span class="p">,</span> <span class="p">)</span>

<span class="c"># Re-register UserAdmin</span>
<span class="n">admin</span><span class="o">.</span><span class="n">site</span><span class="o">.</span><span class="n">unregister</span><span class="p">(</span><span class="n">User</span><span class="p">)</span>
<span class="n">admin</span><span class="o">.</span><span class="n">site</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">User</span><span class="p">,</span> <span class="n">UserAdmin</span><span class="p">)</span>
</pre></div>
</div>
<p>These profile models are not special in any way - they are just Django models that
happen to have a one-to-one link with a User model. As such, they do not get
auto created when a user is created, but
a <code class="xref py py-attr docutils literal"><span class="pre">django.db.models.signals.post_save</span></code> could be used to create or update
related models as appropriate.</p>
<p>Note that using related models results in additional queries or joins to
retrieve the related data, and depending on your needs substituting the User
model and adding the related fields may be your better option.  However
existing links to the default User model within your project&#8217;s apps may justify
the extra database load.</p>
</div>
<div class="section" id="substituting-a-custom-user-model">
<span id="auth-custom-user"></span><h2>Substituting a custom User model<a class="headerlink" href="#substituting-a-custom-user-model" title="Permalink to this headline">¶</a></h2>
<p>Some kinds of projects may have authentication requirements for which Django&#8217;s
built-in <code class="xref py py-class docutils literal"><span class="pre">User</span></code> model is not always
appropriate. For instance, on some sites it makes more sense to use an email
address as your identification token instead of a username.</p>
<p>Django allows you to override the default User model by providing a value for
the <code class="docutils literal"><span class="pre">AUTH_USER_MODEL</span></code> setting that references a custom model:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">AUTH_USER_MODEL</span> <span class="o">=</span> <span class="s">&#39;books.MyUser&#39;</span>
</pre></div>
</div>
<p>This dotted pair describes the name of the Django app (which must be in your
<code class="docutils literal"><span class="pre">INSTALLED_APPS</span></code>), and the name of the Django model that you wish to
use as your User model.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p>Changing <code class="docutils literal"><span class="pre">AUTH_USER_MODEL</span></code> has a big effect on your database
structure. It changes the tables that are available, and it will affect the
construction of foreign keys and many-to-many relationships. If you intend
to set <code class="docutils literal"><span class="pre">AUTH_USER_MODEL</span></code>, you should set it before creating
any migrations or running <code class="docutils literal"><span class="pre">manage.py</span> <span class="pre">migrate</span></code> for the first time.</p>
<p class="last">Changing this setting after you have tables created is not supported
by <code class="docutils literal"><span class="pre">makemigrations</span></code> and will result in you having to manually
fix your schema, port your data from the old user table, and possibly
manually reapply some migrations.</p>
</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p>Due to limitations of Django&#8217;s dynamic dependency feature for swappable
models, you must ensure that the model referenced by <code class="docutils literal"><span class="pre">AUTH_USER_MODEL</span></code>
is created in the first migration of its app (usually called <code class="docutils literal"><span class="pre">0001_initial</span></code>);
otherwise, you will have dependency issues.</p>
<p class="last">In addition, you may run into a CircularDependencyError when running your
migrations as Django won&#8217;t be able to automatically break the dependency
loop due to the dynamic dependency. If you see this error, you should
break the loop by moving the models depended on by your User model
into a second migration (you can try making two normal models that
have a ForeignKey to each other and seeing how <code class="docutils literal"><span class="pre">makemigrations</span></code> resolves that
circular dependency if you want to see how it&#8217;s usually done)</p>
</div>
<div class="section" id="referencing-the-user-model">
<h3>Referencing the User model<a class="headerlink" href="#referencing-the-user-model" title="Permalink to this headline">¶</a></h3>
<p>If you reference <code class="xref py py-class docutils literal"><span class="pre">User</span></code> directly (for
example, by referring to it in a foreign key), your code will not work in
projects where the <code class="docutils literal"><span class="pre">AUTH_USER_MODEL</span></code> setting has been changed to a
different User model.</p>
<dl class="function">
<dt id="django.contrib.auth.get_user_model">
<code class="descclassname">django.contrib.auth.</code><code class="descname">get_user_model</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#django.contrib.auth.get_user_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Instead of referring to <code class="xref py py-class docutils literal"><span class="pre">User</span></code> directly,
you should reference the user model using
<code class="docutils literal"><span class="pre">django.contrib.auth.get_user_model()</span></code>. This method will return the
currently active User model &#8211; the custom User model if one is specified, or
<code class="xref py py-class docutils literal"><span class="pre">User</span></code> otherwise.</p>
<p>When you define a foreign key or many-to-many relations to the User model,
you should specify the custom model using the <code class="docutils literal"><span class="pre">AUTH_USER_MODEL</span></code>
setting. For example:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">django.conf</span> <span class="kn">import</span> <span class="n">settings</span>
<span class="kn">from</span> <span class="nn">django.db</span> <span class="kn">import</span> <span class="n">models</span>

<span class="k">class</span> <span class="nc">Article</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">author</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">ForeignKey</span><span class="p">(</span><span class="n">settings</span><span class="o">.</span><span class="n">AUTH_USER_MODEL</span><span class="p">)</span>
</pre></div>
</div>
<p>When connecting to signals sent by the <code class="docutils literal"><span class="pre">User</span></code> model, you should specify
the custom model using the <code class="docutils literal"><span class="pre">AUTH_USER_MODEL</span></code> setting. For example:</p>
<div class="highlight-python"><div class="highlight"><pre>from django.conf import settings
from django.db.models.signals import post_save

def post_save_receiver(signal, sender, instance, \*\*kwargs):
    pass

post_save.connect(post_save_receiver, sender=settings.AUTH_USER_MODEL)
</pre></div>
</div>
<p>Generally speaking, you should reference the User model with the
<code class="docutils literal"><span class="pre">AUTH_USER_MODEL</span></code> setting in code that is executed at import
time. <code class="docutils literal"><span class="pre">get_user_model()</span></code> only works once Django has imported all models.</p>
</dd></dl>

</div>
<div class="section" id="specifying-a-custom-user-model">
<span id="specifying-custom-user-model"></span><h3>Specifying a custom User model<a class="headerlink" href="#specifying-a-custom-user-model" title="Permalink to this headline">¶</a></h3>
<div class="admonition-model-design-considerations admonition">
<p class="first admonition-title">Model design considerations</p>
<p>Think carefully before handling information not directly related to
authentication in your custom User Model.</p>
<p class="last">It may be better to store app-specific user information in a model
that has a relation with the User model. That allows each app to specify
its own user data requirements without risking conflicts with other
apps. On the other hand, queries to retrieve this related information
will involve a database join, which may have an effect on performance.</p>
</div>
<p>Django expects your custom User model to meet some minimum requirements.</p>
<ol class="arabic simple">
<li>Your model must have an integer primary key.</li>
<li>Your model must have a single unique field that can be used for
identification purposes. This can be a username, an email address,
or any other unique attribute.</li>
<li>Your model must provide a way to address the user in a &#8220;short&#8221; and
&#8220;long&#8221; form. The most common interpretation of this would be to use
the user&#8217;s given name as the &#8220;short&#8221; identifier, and the user&#8217;s full
name as the &#8220;long&#8221; identifier. However, there are no constraints on
what these two methods return - if you want, they can return exactly
the same value.</li>
</ol>
<p>The easiest way to construct a compliant custom User model is to inherit from
<a class="reference internal" href="#django.contrib.auth.models.AbstractBaseUser" title="django.contrib.auth.models.AbstractBaseUser"><code class="xref py py-class docutils literal"><span class="pre">AbstractBaseUser</span></code></a>.
<a class="reference internal" href="#django.contrib.auth.models.AbstractBaseUser" title="django.contrib.auth.models.AbstractBaseUser"><code class="xref py py-class docutils literal"><span class="pre">AbstractBaseUser</span></code></a> provides the core
implementation of a <code class="docutils literal"><span class="pre">User</span></code> model, including hashed passwords and tokenized
password resets. You must then provide some key implementation details:</p>
<dl class="class">
<dt id="django.contrib.auth.models.CustomUser">
<em class="property">class </em><code class="descclassname">models.</code><code class="descname">CustomUser</code><a class="headerlink" href="#django.contrib.auth.models.CustomUser" title="Permalink to this definition">¶</a></dt>
<dd><dl class="attribute">
<dt id="django.contrib.auth.models.CustomUser.USERNAME_FIELD">
<code class="descname">USERNAME_FIELD</code><a class="headerlink" href="#django.contrib.auth.models.CustomUser.USERNAME_FIELD" title="Permalink to this definition">¶</a></dt>
<dd><p>A string describing the name of the field on the User model that is
used as the unique identifier. This will usually be a username of
some kind, but it can also be an email address, or any other unique
identifier. The field <em>must</em> be unique (i.e., have <code class="docutils literal"><span class="pre">unique=True</span></code>
set in its definition).</p>
<p>In the following example, the field <code class="docutils literal"><span class="pre">identifier</span></code> is used
as the identifying field:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">class</span> <span class="nc">MyUser</span><span class="p">(</span><span class="n">AbstractBaseUser</span><span class="p">):</span>
    <span class="n">identifier</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span> <span class="n">unique</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="o">...</span>
    <span class="n">USERNAME_FIELD</span> <span class="o">=</span> <span class="s">&#39;identifier&#39;</span>
</pre></div>
</div>
<p><a class="reference internal" href="#django.contrib.auth.models.CustomUser.USERNAME_FIELD" title="django.contrib.auth.models.CustomUser.USERNAME_FIELD"><code class="xref py py-attr docutils literal"><span class="pre">USERNAME_FIELD</span></code></a> supports
<a class="reference internal" href="appendix_A.html#django.db.models.ForeignKey" title="django.db.models.ForeignKey"><code class="xref py py-class docutils literal"><span class="pre">ForeignKey</span></code></a>s. Since there is no way to pass
model instances during the <code class="docutils literal"><span class="pre">createsuperuser</span></code> prompt, expect the
user to enter the value of <a class="reference internal" href="appendix_A.html#django.db.models.ForeignKey.to_field" title="django.db.models.ForeignKey.to_field"><code class="xref py py-attr docutils literal"><span class="pre">to_field</span></code></a>
value (the <a class="reference internal" href="appendix_A.html#django.db.models.Field.primary_key" title="django.db.models.Field.primary_key"><code class="xref py py-attr docutils literal"><span class="pre">primary_key</span></code></a> by default) of an
existing instance.</p>
</dd></dl>

<dl class="attribute">
<dt id="django.contrib.auth.models.CustomUser.REQUIRED_FIELDS">
<code class="descname">REQUIRED_FIELDS</code><a class="headerlink" href="#django.contrib.auth.models.CustomUser.REQUIRED_FIELDS" title="Permalink to this definition">¶</a></dt>
<dd><p>A list of the field names that will be prompted for when creating a
user via the <code class="docutils literal"><span class="pre">createsuperuser</span></code> management command. The user
will be prompted to supply a value for each of these fields. It must
include any field for which <a class="reference internal" href="appendix_A.html#django.db.models.Field.blank" title="django.db.models.Field.blank"><code class="xref py py-attr docutils literal"><span class="pre">blank</span></code></a> is
<code class="docutils literal"><span class="pre">False</span></code> or undefined and may include additional fields you want
prompted for when a user is created interactively.
<code class="docutils literal"><span class="pre">REQUIRED_FIELDS</span></code> has no effect in other parts of Django, like
creating a user in the admin.</p>
<p>For example, here is the partial definition for a <code class="docutils literal"><span class="pre">User</span></code> model that
defines two required fields - a date of birth and height:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">class</span> <span class="nc">MyUser</span><span class="p">(</span><span class="n">AbstractBaseUser</span><span class="p">):</span>
    <span class="o">...</span>
    <span class="n">date_of_birth</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">DateField</span><span class="p">()</span>
    <span class="n">height</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">FloatField</span><span class="p">()</span>
    <span class="o">...</span>
    <span class="n">REQUIRED_FIELDS</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;date_of_birth&#39;</span><span class="p">,</span> <span class="s">&#39;height&#39;</span><span class="p">]</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last"><code class="docutils literal"><span class="pre">REQUIRED_FIELDS</span></code> must contain all required fields on your
<code class="docutils literal"><span class="pre">User</span></code> model, but should <em>not</em> contain the <code class="docutils literal"><span class="pre">USERNAME_FIELD</span></code> or
<code class="docutils literal"><span class="pre">password</span></code> as these fields will always be prompted for.</p>
</div>
<p><a class="reference internal" href="#django.contrib.auth.models.CustomUser.REQUIRED_FIELDS" title="django.contrib.auth.models.CustomUser.REQUIRED_FIELDS"><code class="xref py py-attr docutils literal"><span class="pre">REQUIRED_FIELDS</span></code></a> supports
<a class="reference internal" href="appendix_A.html#django.db.models.ForeignKey" title="django.db.models.ForeignKey"><code class="xref py py-class docutils literal"><span class="pre">ForeignKey</span></code></a>s. Since there is no way to pass
model instances during the <code class="docutils literal"><span class="pre">createsuperuser</span></code> prompt, expect the
user to enter the value of <a class="reference internal" href="appendix_A.html#django.db.models.ForeignKey.to_field" title="django.db.models.ForeignKey.to_field"><code class="xref py py-attr docutils literal"><span class="pre">to_field</span></code></a>
value (the <a class="reference internal" href="appendix_A.html#django.db.models.Field.primary_key" title="django.db.models.Field.primary_key"><code class="xref py py-attr docutils literal"><span class="pre">primary_key</span></code></a> by default) of an
existing instance.</p>
</dd></dl>

<dl class="attribute">
<dt id="django.contrib.auth.models.CustomUser.is_active">
<code class="descname">is_active</code><a class="headerlink" href="#django.contrib.auth.models.CustomUser.is_active" title="Permalink to this definition">¶</a></dt>
<dd><p>A boolean attribute that indicates whether the user is considered
&#8220;active&#8221;.  This attribute is provided as an attribute on
<code class="docutils literal"><span class="pre">AbstractBaseUser</span></code> defaulting to <code class="docutils literal"><span class="pre">True</span></code>. How you choose to
implement it will depend on the details of your chosen auth backends.
See the documentation of the <code class="xref py py-attr docutils literal"><span class="pre">is_active</span> <span class="pre">attribute</span> <span class="pre">on</span> <span class="pre">the</span> <span class="pre">built-in</span>
<span class="pre">user</span> <span class="pre">model</span></code> for details.</p>
</dd></dl>

<dl class="method">
<dt id="django.contrib.auth.models.CustomUser.get_full_name">
<code class="descname">get_full_name</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#django.contrib.auth.models.CustomUser.get_full_name" title="Permalink to this definition">¶</a></dt>
<dd><p>A longer formal identifier for the user. A common interpretation
would be the full name of the user, but it can be any string that
identifies the user.</p>
</dd></dl>

<dl class="method">
<dt id="django.contrib.auth.models.CustomUser.get_short_name">
<code class="descname">get_short_name</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#django.contrib.auth.models.CustomUser.get_short_name" title="Permalink to this definition">¶</a></dt>
<dd><p>A short, informal identifier for the user. A common interpretation
would be the first name of the user, but it can be any string that
identifies the user in an informal way. It may also return the same
value as <code class="xref py py-meth docutils literal"><span class="pre">django.contrib.auth.models.User.get_full_name()</span></code>.</p>
</dd></dl>

</dd></dl>

<p>The following methods are available on any subclass of
<a class="reference internal" href="#django.contrib.auth.models.AbstractBaseUser" title="django.contrib.auth.models.AbstractBaseUser"><code class="xref py py-class docutils literal"><span class="pre">AbstractBaseUser</span></code></a>:</p>
<dl class="class">
<dt id="django.contrib.auth.models.AbstractBaseUser">
<em class="property">class </em><code class="descclassname">models.</code><code class="descname">AbstractBaseUser</code><a class="headerlink" href="#django.contrib.auth.models.AbstractBaseUser" title="Permalink to this definition">¶</a></dt>
<dd><dl class="method">
<dt id="django.contrib.auth.models.AbstractBaseUser.get_username">
<code class="descname">get_username</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#django.contrib.auth.models.AbstractBaseUser.get_username" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the value of the field nominated by <code class="docutils literal"><span class="pre">USERNAME_FIELD</span></code>.</p>
</dd></dl>

<dl class="method">
<dt id="django.contrib.auth.models.AbstractBaseUser.is_anonymous">
<code class="descname">is_anonymous</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#django.contrib.auth.models.AbstractBaseUser.is_anonymous" title="Permalink to this definition">¶</a></dt>
<dd><p>Always returns <code class="docutils literal"><span class="pre">False</span></code>. This is a way of differentiating
from  <code class="xref py py-class docutils literal"><span class="pre">AnonymousUser</span></code> objects.
Generally, you should prefer using
<a class="reference internal" href="#django.contrib.auth.models.AbstractBaseUser.is_authenticated" title="django.contrib.auth.models.AbstractBaseUser.is_authenticated"><code class="xref py py-meth docutils literal"><span class="pre">is_authenticated()</span></code></a> to this
method.</p>
</dd></dl>

<dl class="method">
<dt id="django.contrib.auth.models.AbstractBaseUser.is_authenticated">
<code class="descname">is_authenticated</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#django.contrib.auth.models.AbstractBaseUser.is_authenticated" title="Permalink to this definition">¶</a></dt>
<dd><p>Always returns <code class="docutils literal"><span class="pre">True</span></code>. This is a way to tell if the user has been
authenticated. This does not imply any permissions, and doesn&#8217;t check
if the user is active - it only indicates that the user has provided a
valid username and password.</p>
</dd></dl>

<dl class="method">
<dt id="django.contrib.auth.models.AbstractBaseUser.set_password">
<code class="descname">set_password</code><span class="sig-paren">(</span><em>raw_password</em><span class="sig-paren">)</span><a class="headerlink" href="#django.contrib.auth.models.AbstractBaseUser.set_password" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets the user&#8217;s password to the given raw string, taking care of the
password hashing. Doesn&#8217;t save the
<a class="reference internal" href="#django.contrib.auth.models.AbstractBaseUser" title="django.contrib.auth.models.AbstractBaseUser"><code class="xref py py-class docutils literal"><span class="pre">AbstractBaseUser</span></code></a> object.</p>
<p>When the raw_password is <code class="docutils literal"><span class="pre">None</span></code>, the password will be set to an
unusable password, as if
<a class="reference internal" href="#django.contrib.auth.models.AbstractBaseUser.set_unusable_password" title="django.contrib.auth.models.AbstractBaseUser.set_unusable_password"><code class="xref py py-meth docutils literal"><span class="pre">set_unusable_password()</span></code></a>
were used.</p>
</dd></dl>

<dl class="method">
<dt id="django.contrib.auth.models.AbstractBaseUser.check_password">
<code class="descname">check_password</code><span class="sig-paren">(</span><em>raw_password</em><span class="sig-paren">)</span><a class="headerlink" href="#django.contrib.auth.models.AbstractBaseUser.check_password" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns <code class="docutils literal"><span class="pre">True</span></code> if the given raw string is the correct password for
the user. (This takes care of the password hashing in making the
comparison.)</p>
</dd></dl>

<dl class="method">
<dt id="django.contrib.auth.models.AbstractBaseUser.set_unusable_password">
<code class="descname">set_unusable_password</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#django.contrib.auth.models.AbstractBaseUser.set_unusable_password" title="Permalink to this definition">¶</a></dt>
<dd><p>Marks the user as having no password set.  This isn&#8217;t the same as
having a blank string for a password.
<a class="reference internal" href="#django.contrib.auth.models.AbstractBaseUser.check_password" title="django.contrib.auth.models.AbstractBaseUser.check_password"><code class="xref py py-meth docutils literal"><span class="pre">check_password()</span></code></a> for this user
will never return <code class="docutils literal"><span class="pre">True</span></code>. Doesn&#8217;t save the
<a class="reference internal" href="#django.contrib.auth.models.AbstractBaseUser" title="django.contrib.auth.models.AbstractBaseUser"><code class="xref py py-class docutils literal"><span class="pre">AbstractBaseUser</span></code></a> object.</p>
<p>You may need this if authentication for your application takes place
against an existing external source such as an LDAP directory.</p>
</dd></dl>

<dl class="method">
<dt id="django.contrib.auth.models.AbstractBaseUser.has_usable_password">
<code class="descname">has_usable_password</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#django.contrib.auth.models.AbstractBaseUser.has_usable_password" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns <code class="docutils literal"><span class="pre">False</span></code> if
<a class="reference internal" href="#django.contrib.auth.models.AbstractBaseUser.set_unusable_password" title="django.contrib.auth.models.AbstractBaseUser.set_unusable_password"><code class="xref py py-meth docutils literal"><span class="pre">set_unusable_password()</span></code></a> has
been called for this user.</p>
</dd></dl>

<dl class="method">
<dt id="django.contrib.auth.models.AbstractBaseUser.get_session_auth_hash">
<code class="descname">get_session_auth_hash</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#django.contrib.auth.models.AbstractBaseUser.get_session_auth_hash" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns an HMAC of the password field. Used for
session invalidation on password change.</p>
</dd></dl>

</dd></dl>

<p>You should also define a custom manager for your <code class="docutils literal"><span class="pre">User</span></code> model. If your
<code class="docutils literal"><span class="pre">User</span></code> model defines <code class="docutils literal"><span class="pre">username</span></code>, <code class="docutils literal"><span class="pre">email</span></code>, <code class="docutils literal"><span class="pre">is_staff</span></code>, <code class="docutils literal"><span class="pre">is_active</span></code>,
<code class="docutils literal"><span class="pre">is_superuser</span></code>, <code class="docutils literal"><span class="pre">last_login</span></code>, and <code class="docutils literal"><span class="pre">date_joined</span></code> fields the same as
Django&#8217;s default <code class="docutils literal"><span class="pre">User</span></code>, you can just install Django&#8217;s
<code class="xref py py-class docutils literal"><span class="pre">UserManager</span></code>; however, if your <code class="docutils literal"><span class="pre">User</span></code>
model defines different fields, you will need to define a custom manager that
extends <a class="reference internal" href="#django.contrib.auth.models.BaseUserManager" title="django.contrib.auth.models.BaseUserManager"><code class="xref py py-class docutils literal"><span class="pre">BaseUserManager</span></code></a> providing two
additional methods:</p>
<dl class="class">
<dt id="django.contrib.auth.models.CustomUserManager">
<em class="property">class </em><code class="descclassname">models.</code><code class="descname">CustomUserManager</code><a class="headerlink" href="#django.contrib.auth.models.CustomUserManager" title="Permalink to this definition">¶</a></dt>
<dd><dl class="method">
<dt id="django.contrib.auth.models.CustomUserManager.create_user">
<code class="descname">create_user</code><span class="sig-paren">(</span><em>*username_field*</em>, <em>password=None</em>, <em>**other_fields</em><span class="sig-paren">)</span><a class="headerlink" href="#django.contrib.auth.models.CustomUserManager.create_user" title="Permalink to this definition">¶</a></dt>
<dd><p>The prototype of <code class="docutils literal"><span class="pre">create_user()</span></code> should accept the username field,
plus all required fields as arguments. For example, if your user model
uses <code class="docutils literal"><span class="pre">email</span></code> as the username field, and has <code class="docutils literal"><span class="pre">date_of_birth</span></code> as a
required field, then <code class="docutils literal"><span class="pre">create_user</span></code> should be defined as:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">create_user</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">email</span><span class="p">,</span> <span class="n">date_of_birth</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="c"># create user here</span>
    <span class="o">...</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="django.contrib.auth.models.CustomUserManager.create_superuser">
<code class="descname">create_superuser</code><span class="sig-paren">(</span><em>*username_field*</em>, <em>password</em>, <em>**other_fields</em><span class="sig-paren">)</span><a class="headerlink" href="#django.contrib.auth.models.CustomUserManager.create_superuser" title="Permalink to this definition">¶</a></dt>
<dd><p>The prototype of <code class="docutils literal"><span class="pre">create_superuser()</span></code> should accept the username
field, plus all required fields as arguments. For example, if your user
model uses <code class="docutils literal"><span class="pre">email</span></code> as the username field, and has <code class="docutils literal"><span class="pre">date_of_birth</span></code>
as a required field, then <code class="docutils literal"><span class="pre">create_superuser</span></code> should be defined as:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">create_superuser</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">email</span><span class="p">,</span> <span class="n">date_of_birth</span><span class="p">,</span> <span class="n">password</span><span class="p">):</span>
    <span class="c"># create superuser here</span>
    <span class="o">...</span>
</pre></div>
</div>
<p>Unlike <code class="docutils literal"><span class="pre">create_user()</span></code>, <code class="docutils literal"><span class="pre">create_superuser()</span></code> <em>must</em> require the
caller to provide a password.</p>
</dd></dl>

</dd></dl>

<p><a class="reference internal" href="#django.contrib.auth.models.BaseUserManager" title="django.contrib.auth.models.BaseUserManager"><code class="xref py py-class docutils literal"><span class="pre">BaseUserManager</span></code></a> provides the following
utility methods:</p>
<dl class="class">
<dt id="django.contrib.auth.models.BaseUserManager">
<em class="property">class </em><code class="descclassname">models.</code><code class="descname">BaseUserManager</code><a class="headerlink" href="#django.contrib.auth.models.BaseUserManager" title="Permalink to this definition">¶</a></dt>
<dd><dl class="method">
<dt id="django.contrib.auth.models.BaseUserManager.normalize_email">
<code class="descname">normalize_email</code><span class="sig-paren">(</span><em>email</em><span class="sig-paren">)</span><a class="headerlink" href="#django.contrib.auth.models.BaseUserManager.normalize_email" title="Permalink to this definition">¶</a></dt>
<dd><p>A <code class="docutils literal"><span class="pre">classmethod</span></code> that normalizes email addresses by lowercasing
the domain portion of the email address.</p>
</dd></dl>

<dl class="method">
<dt id="django.contrib.auth.models.BaseUserManager.get_by_natural_key">
<code class="descname">get_by_natural_key</code><span class="sig-paren">(</span><em>username</em><span class="sig-paren">)</span><a class="headerlink" href="#django.contrib.auth.models.BaseUserManager.get_by_natural_key" title="Permalink to this definition">¶</a></dt>
<dd><p>Retrieves a user instance using the contents of the field
nominated by <code class="docutils literal"><span class="pre">USERNAME_FIELD</span></code>.</p>
</dd></dl>

<dl class="method">
<dt id="django.contrib.auth.models.BaseUserManager.make_random_password">
<code class="descname">make_random_password</code><span class="sig-paren">(</span><em>length=10</em>, <em>allowed_chars='abcdefghjkmnpqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ23456789'</em><span class="sig-paren">)</span><a class="headerlink" href="#django.contrib.auth.models.BaseUserManager.make_random_password" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a random password with the given length and given string of
allowed characters. Note that the default value of <code class="docutils literal"><span class="pre">allowed_chars</span></code>
doesn&#8217;t contain letters that can cause user confusion, including:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">i</span></code>, <code class="docutils literal"><span class="pre">l</span></code>, <code class="docutils literal"><span class="pre">I</span></code>, and <code class="docutils literal"><span class="pre">1</span></code> (lowercase letter i, lowercase
letter L, uppercase letter i, and the number one)</li>
<li><code class="docutils literal"><span class="pre">o</span></code>, <code class="docutils literal"><span class="pre">O</span></code>, and <code class="docutils literal"><span class="pre">0</span></code> (lowercase letter o, uppercase letter o,
and zero)</li>
</ul>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="extending-django-s-default-user">
<h3>Extending Django&#8217;s default User<a class="headerlink" href="#extending-django-s-default-user" title="Permalink to this headline">¶</a></h3>
<p>If you&#8217;re entirely happy with Django&#8217;s <code class="xref py py-class docutils literal"><span class="pre">User</span></code>
model and you just want to add some additional profile information, you could
simply subclass <code class="docutils literal"><span class="pre">django.contrib.auth.models.AbstractUser</span></code> and add your
custom profile fields, although we&#8217;d recommend a separate model.
<code class="docutils literal"><span class="pre">AbstractUser</span></code> provides the full implementation of the default
<code class="xref py py-class docutils literal"><span class="pre">User</span></code> as an abstract model.</p>
</div>
<div class="section" id="custom-users-and-the-built-in-auth-forms">
<span id="id10"></span><h3>Custom users and the built-in auth forms<a class="headerlink" href="#custom-users-and-the-built-in-auth-forms" title="Permalink to this headline">¶</a></h3>
<p>As you may expect, Django&#8217;s built in forms and views make certain assumptions about the user
model that they are working with.</p>
<p>If your user model doesn&#8217;t follow the same assumptions, it may be necessary to define
a replacement form, and pass that form in as part of the configuration of the
auth views.</p>
<ul>
<li><p class="first"><code class="xref py py-class docutils literal"><span class="pre">UserCreationForm</span></code></p>
<p>Depends on the <code class="xref py py-class docutils literal"><span class="pre">User</span></code> model.
Must be re-written for any custom user model.</p>
</li>
<li><p class="first"><code class="xref py py-class docutils literal"><span class="pre">UserChangeForm</span></code></p>
<p>Depends on the <code class="xref py py-class docutils literal"><span class="pre">User</span></code> model.
Must be re-written for any custom user model.</p>
</li>
<li><p class="first"><code class="xref py py-class docutils literal"><span class="pre">AuthenticationForm</span></code></p>
<p>Works with any subclass of <a class="reference internal" href="#django.contrib.auth.models.AbstractBaseUser" title="django.contrib.auth.models.AbstractBaseUser"><code class="xref py py-class docutils literal"><span class="pre">AbstractBaseUser</span></code></a>,
and will adapt to use the field defined in <code class="docutils literal"><span class="pre">USERNAME_FIELD</span></code>.</p>
</li>
<li><p class="first"><code class="xref py py-class docutils literal"><span class="pre">PasswordResetForm</span></code></p>
<p>Assumes that the user model has a field named <code class="docutils literal"><span class="pre">email</span></code> that can be used to
identify the user and a boolean field named <code class="docutils literal"><span class="pre">is_active</span></code> to prevent
password resets for inactive users.</p>
</li>
<li><p class="first"><code class="xref py py-class docutils literal"><span class="pre">SetPasswordForm</span></code></p>
<p>Works with any subclass of <a class="reference internal" href="#django.contrib.auth.models.AbstractBaseUser" title="django.contrib.auth.models.AbstractBaseUser"><code class="xref py py-class docutils literal"><span class="pre">AbstractBaseUser</span></code></a></p>
</li>
<li><p class="first"><code class="xref py py-class docutils literal"><span class="pre">PasswordChangeForm</span></code></p>
<p>Works with any subclass of <a class="reference internal" href="#django.contrib.auth.models.AbstractBaseUser" title="django.contrib.auth.models.AbstractBaseUser"><code class="xref py py-class docutils literal"><span class="pre">AbstractBaseUser</span></code></a></p>
</li>
<li><p class="first"><code class="xref py py-class docutils literal"><span class="pre">AdminPasswordChangeForm</span></code></p>
<p>Works with any subclass of <a class="reference internal" href="#django.contrib.auth.models.AbstractBaseUser" title="django.contrib.auth.models.AbstractBaseUser"><code class="xref py py-class docutils literal"><span class="pre">AbstractBaseUser</span></code></a></p>
</li>
</ul>
</div>
<div class="section" id="custom-users-and-django-contrib-admin">
<h3>Custom users and <code class="xref py py-mod docutils literal"><span class="pre">django.contrib.admin</span></code><a class="headerlink" href="#custom-users-and-django-contrib-admin" title="Permalink to this headline">¶</a></h3>
<p>If you want your custom User model to also work with Admin, your User model must
define some additional attributes and methods. These methods allow the admin to
control access of the User to admin content:</p>
<dl class="class">
<dt>
<em class="property">class </em><code class="descclassname">models.</code><code class="descname">CustomUser</code></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="django.contrib.auth.is_staff">
<code class="descclassname">django.contrib.auth.</code><code class="descname">is_staff</code><a class="headerlink" href="#django.contrib.auth.is_staff" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns <code class="docutils literal"><span class="pre">True</span></code> if the user is allowed to have access to the admin site.</p>
</dd></dl>

<dl class="attribute">
<dt id="django.contrib.auth.is_active">
<code class="descclassname">django.contrib.auth.</code><code class="descname">is_active</code><a class="headerlink" href="#django.contrib.auth.is_active" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns <code class="docutils literal"><span class="pre">True</span></code> if the user account is currently active.</p>
</dd></dl>

<dl class="method">
<dt>
<code class="descname">has_perm(perm, obj=None):</code></dt>
<dd><p>Returns <code class="docutils literal"><span class="pre">True</span></code> if the user has the named permission. If <code class="docutils literal"><span class="pre">obj</span></code> is
provided, the permission needs to be checked against a specific object
instance.</p>
</dd></dl>

<dl class="method">
<dt>
<code class="descname">has_module_perms(app_label):</code></dt>
<dd><p>Returns <code class="docutils literal"><span class="pre">True</span></code> if the user has permission to access models in
the given app.</p>
</dd></dl>

<p>You will also need to register your custom User model with the admin. If
your custom User model extends <code class="docutils literal"><span class="pre">django.contrib.auth.models.AbstractUser</span></code>,
you can use Django&#8217;s existing <code class="docutils literal"><span class="pre">django.contrib.auth.admin.UserAdmin</span></code>
class. However, if your User model extends
<a class="reference internal" href="#django.contrib.auth.models.AbstractBaseUser" title="django.contrib.auth.models.AbstractBaseUser"><code class="xref py py-class docutils literal"><span class="pre">AbstractBaseUser</span></code></a>, you&#8217;ll need to define
a custom <code class="docutils literal"><span class="pre">ModelAdmin</span></code> class. It may be possible to subclass the default
<code class="docutils literal"><span class="pre">django.contrib.auth.admin.UserAdmin</span></code>; however, you&#8217;ll need to
override any of the definitions that refer to fields on
<code class="docutils literal"><span class="pre">django.contrib.auth.models.AbstractUser</span></code> that aren&#8217;t on your
custom User class.</p>
</div>
<div class="section" id="custom-users-and-permissions">
<h3>Custom users and permissions<a class="headerlink" href="#custom-users-and-permissions" title="Permalink to this headline">¶</a></h3>
<p>To make it easy to include Django&#8217;s permission framework into your own User
class, Django provides <a class="reference internal" href="#django.contrib.auth.models.PermissionsMixin" title="django.contrib.auth.models.PermissionsMixin"><code class="xref py py-class docutils literal"><span class="pre">PermissionsMixin</span></code></a>.
This is an abstract model you can include in the class hierarchy for your User
model, giving you all the methods and database fields necessary to support
Django&#8217;s permission model.</p>
<p><a class="reference internal" href="#django.contrib.auth.models.PermissionsMixin" title="django.contrib.auth.models.PermissionsMixin"><code class="xref py py-class docutils literal"><span class="pre">PermissionsMixin</span></code></a> provides the following
methods and attributes:</p>
<dl class="class">
<dt id="django.contrib.auth.models.PermissionsMixin">
<em class="property">class </em><code class="descclassname">models.</code><code class="descname">PermissionsMixin</code><a class="headerlink" href="#django.contrib.auth.models.PermissionsMixin" title="Permalink to this definition">¶</a></dt>
<dd><dl class="attribute">
<dt id="django.contrib.auth.models.PermissionsMixin.is_superuser">
<code class="descname">is_superuser</code><a class="headerlink" href="#django.contrib.auth.models.PermissionsMixin.is_superuser" title="Permalink to this definition">¶</a></dt>
<dd><p>Boolean. Designates that this user has all permissions without
explicitly assigning them.</p>
</dd></dl>

<dl class="method">
<dt id="django.contrib.auth.models.PermissionsMixin.get_group_permissions">
<code class="descname">get_group_permissions</code><span class="sig-paren">(</span><em>obj=None</em><span class="sig-paren">)</span><a class="headerlink" href="#django.contrib.auth.models.PermissionsMixin.get_group_permissions" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a set of permission strings that the user has, through their
groups.</p>
<p>If <code class="docutils literal"><span class="pre">obj</span></code> is passed in, only returns the group permissions for
this specific object.</p>
</dd></dl>

<dl class="method">
<dt id="django.contrib.auth.models.PermissionsMixin.get_all_permissions">
<code class="descname">get_all_permissions</code><span class="sig-paren">(</span><em>obj=None</em><span class="sig-paren">)</span><a class="headerlink" href="#django.contrib.auth.models.PermissionsMixin.get_all_permissions" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a set of permission strings that the user has, both through
group and user permissions.</p>
<p>If <code class="docutils literal"><span class="pre">obj</span></code> is passed in, only returns the permissions for this
specific object.</p>
</dd></dl>

<dl class="method">
<dt id="django.contrib.auth.models.PermissionsMixin.has_perm">
<code class="descname">has_perm</code><span class="sig-paren">(</span><em>perm</em>, <em>obj=None</em><span class="sig-paren">)</span><a class="headerlink" href="#django.contrib.auth.models.PermissionsMixin.has_perm" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns <code class="docutils literal"><span class="pre">True</span></code> if the user has the specified permission, where
<code class="docutils literal"><span class="pre">perm</span></code> is in the format <code class="docutils literal"><span class="pre">&quot;&lt;app</span> <span class="pre">label&gt;.&lt;permission</span> <span class="pre">codename&gt;&quot;</span></code>. If
the user is inactive, this method will always return <code class="docutils literal"><span class="pre">False</span></code>.</p>
<p>If <code class="docutils literal"><span class="pre">obj</span></code> is passed in, this method won&#8217;t check for a permission for
the model, but for this specific object.</p>
</dd></dl>

<dl class="method">
<dt id="django.contrib.auth.models.PermissionsMixin.has_perms">
<code class="descname">has_perms</code><span class="sig-paren">(</span><em>perm_list</em>, <em>obj=None</em><span class="sig-paren">)</span><a class="headerlink" href="#django.contrib.auth.models.PermissionsMixin.has_perms" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns <code class="docutils literal"><span class="pre">True</span></code> if the user has each of the specified permissions,
where each perm is in the format
<code class="docutils literal"><span class="pre">&quot;&lt;app</span> <span class="pre">label&gt;.&lt;permission</span> <span class="pre">codename&gt;&quot;</span></code>. If the user is inactive,
this method will always return <code class="docutils literal"><span class="pre">False</span></code>.</p>
<p>If <code class="docutils literal"><span class="pre">obj</span></code> is passed in, this method won&#8217;t check for permissions for
the model, but for the specific object.</p>
</dd></dl>

<dl class="method">
<dt id="django.contrib.auth.models.PermissionsMixin.has_module_perms">
<code class="descname">has_module_perms</code><span class="sig-paren">(</span><em>package_name</em><span class="sig-paren">)</span><a class="headerlink" href="#django.contrib.auth.models.PermissionsMixin.has_module_perms" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns <code class="docutils literal"><span class="pre">True</span></code> if the user has any permissions in the given package
(the Django app label). If the user is inactive, this method will
always return <code class="docutils literal"><span class="pre">False</span></code>.</p>
</dd></dl>

</dd></dl>

<div class="admonition-modelbackend admonition">
<p class="first admonition-title">ModelBackend</p>
<p class="last">If you don&#8217;t include the
<a class="reference internal" href="#django.contrib.auth.models.PermissionsMixin" title="django.contrib.auth.models.PermissionsMixin"><code class="xref py py-class docutils literal"><span class="pre">PermissionsMixin</span></code></a>, you must ensure you
don&#8217;t invoke the permissions methods on <code class="docutils literal"><span class="pre">ModelBackend</span></code>. <code class="docutils literal"><span class="pre">ModelBackend</span></code>
assumes that certain fields are available on your user model. If your User
model doesn&#8217;t provide  those fields, you will receive database errors when
you check permissions.</p>
</div>
</div>
<div class="section" id="custom-users-and-proxy-models">
<h3>Custom users and Proxy models<a class="headerlink" href="#custom-users-and-proxy-models" title="Permalink to this headline">¶</a></h3>
<p>One limitation of custom User models is that installing a custom User model
will break any proxy model extending <code class="xref py py-class docutils literal"><span class="pre">User</span></code>.
Proxy models must be based on a concrete base class; by defining a custom User
model, you remove the ability of Django to reliably identify the base class.</p>
<p>If your project uses proxy models, you must either modify the proxy to extend
the User model that is currently in use in your project, or merge your proxy&#8217;s
behavior into your User subclass.</p>
</div>
<div class="section" id="custom-users-and-signals">
<h3>Custom users and signals<a class="headerlink" href="#custom-users-and-signals" title="Permalink to this headline">¶</a></h3>
<p>Another limitation of custom User models is that you can&#8217;t use
<a class="reference internal" href="#django.contrib.auth.get_user_model" title="django.contrib.auth.get_user_model"><code class="xref py py-func docutils literal"><span class="pre">django.contrib.auth.get_user_model()</span></code></a> as the sender or target of a signal
handler. Instead, you must register the handler with the resulting User model.</p>
</div>
<div class="section" id="custom-users-and-testing-fixtures">
<h3>Custom users and testing/fixtures<a class="headerlink" href="#custom-users-and-testing-fixtures" title="Permalink to this headline">¶</a></h3>
<p>If you are writing an application that interacts with the User model, you must
take some precautions to ensure that your test suite will run regardless of
the User model that is being used by a project. Any test that instantiates an
instance of User will fail if the User model has been swapped out. This
includes any attempt to create an instance of User with a fixture.</p>
<p>To ensure that your test suite will pass in any project configuration,
<code class="docutils literal"><span class="pre">django.contrib.auth.tests.utils</span></code> defines a <code class="docutils literal"><span class="pre">&#64;skipIfCustomUser</span></code> decorator.
This decorator will cause a test case to be skipped if any User model other
than the default Django user is in use. This decorator can be applied to a
single test, or to an entire test class.</p>
<p>Depending on your application, tests may also be needed to be added to ensure
that the application works with <em>any</em> user model, not just the default User
model. To assist with this, Django provides two substitute user models that
can be used in test suites:</p>
<dl class="class">
<dt id="django.contrib.auth.tests.custom_user.CustomUser">
<em class="property">class </em><code class="descclassname">tests.custom_user.</code><code class="descname">CustomUser</code><a class="headerlink" href="#django.contrib.auth.tests.custom_user.CustomUser" title="Permalink to this definition">¶</a></dt>
<dd><p>A custom user model that uses an <code class="docutils literal"><span class="pre">email</span></code> field as the username, and has a basic
admin-compliant permissions setup</p>
</dd></dl>

<dl class="class">
<dt id="django.contrib.auth.tests.custom_user.ExtensionUser">
<em class="property">class </em><code class="descclassname">tests.custom_user.</code><code class="descname">ExtensionUser</code><a class="headerlink" href="#django.contrib.auth.tests.custom_user.ExtensionUser" title="Permalink to this definition">¶</a></dt>
<dd><p>A custom user model that extends <code class="docutils literal"><span class="pre">django.contrib.auth.models.AbstractUser</span></code>,
adding a <code class="docutils literal"><span class="pre">date_of_birth</span></code> field.</p>
</dd></dl>

<p>You can then use the <code class="docutils literal"><span class="pre">&#64;override_settings</span></code> decorator to make that test run
with the custom User model. For example, here is a skeleton for a test that
would test three possible User models &#8211; the default, plus the two User
models provided by <code class="docutils literal"><span class="pre">auth</span></code> app:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">django.contrib.auth.tests.utils</span> <span class="kn">import</span> <span class="n">skipIfCustomUser</span>
<span class="kn">from</span> <span class="nn">django.contrib.auth.tests.custom_user</span> <span class="kn">import</span> <span class="n">CustomUser</span><span class="p">,</span> <span class="n">ExtensionUser</span>
<span class="kn">from</span> <span class="nn">django.test</span> <span class="kn">import</span> <span class="n">TestCase</span><span class="p">,</span> <span class="n">override_settings</span>


<span class="k">class</span> <span class="nc">ApplicationTestCase</span><span class="p">(</span><span class="n">TestCase</span><span class="p">):</span>
    <span class="nd">@skipIfCustomUser</span>
    <span class="k">def</span> <span class="nf">test_normal_user</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="s">&quot;Run tests for the normal user model&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertSomething</span><span class="p">()</span>

    <span class="nd">@override_settings</span><span class="p">(</span><span class="n">AUTH_USER_MODEL</span><span class="o">=</span><span class="s">&#39;auth.CustomUser&#39;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">test_custom_user</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="s">&quot;Run tests for a custom user model with email-based authentication&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertSomething</span><span class="p">()</span>

    <span class="nd">@override_settings</span><span class="p">(</span><span class="n">AUTH_USER_MODEL</span><span class="o">=</span><span class="s">&#39;auth.ExtensionUser&#39;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">test_extension_user</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="s">&quot;Run tests for a simple extension of the built-in User.&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertSomething</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="section" id="a-full-example">
<h3>A full example<a class="headerlink" href="#a-full-example" title="Permalink to this headline">¶</a></h3>
<p>A full example of an admin-compliant custom user app can be found on the
<a class="reference external" href="https://docs.djangoproject.com/en/1.8/topics/auth/customizing/#a-full-example">Django Project website</a>.</p>
</div>
</div>
</div>


          </div>
        </div>
      </div>
        </div>
        <div class="sidebar">
          <h3>Table Of Contents</h3>
          <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="front_matter.html">Frontmatter</a></li>
<li class="toctree-l1"><a class="reference internal" href="introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="introduction_django.html">Introduction to Django</a></li>
<li class="toctree-l1"><a class="reference internal" href="chapter_01.html">Chapter 1: Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="chapter_02.html">Chapter 2: Views and URLconfs</a></li>
<li class="toctree-l1"><a class="reference internal" href="chapter_03.html">Chapter 3: Templates</a></li>
<li class="toctree-l1"><a class="reference internal" href="chapter_04.html">Chapter 4: Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="chapter_05.html">Chapter 5: The Django Admin Site</a></li>
<li class="toctree-l1"><a class="reference internal" href="chapter_06.html">Chapter 6: Forms</a></li>
<li class="toctree-l1"><a class="reference internal" href="chapter_07.html">Chapter 7: Advanced Views and URLconfs</a></li>
<li class="toctree-l1"><a class="reference internal" href="chapter_08.html">Chapter 8: Advanced Templates</a></li>
<li class="toctree-l1"><a class="reference internal" href="chapter_09.html">Chapter 9: Advanced Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="chapter_10.html">Chapter 10: Generic Views</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="">Chapter 11: User authentication in Django</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#overview">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="#using-the-django-authentication-system">Using the Django authentication system</a></li>
<li class="toctree-l2"><a class="reference internal" href="#user-objects">User objects</a></li>
<li class="toctree-l2"><a class="reference internal" href="#permissions-and-authorization">Permissions and Authorization</a></li>
<li class="toctree-l2"><a class="reference internal" href="#authentication-in-web-requests">Authentication in Web requests</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-django.contrib.auth.views">Authentication Views</a></li>
<li class="toctree-l2"><a class="reference internal" href="#built-in-forms">Built-in forms</a></li>
<li class="toctree-l2"><a class="reference internal" href="#managing-users-in-the-admin">Managing users in the admin</a></li>
<li class="toctree-l2"><a class="reference internal" href="#password-management-in-django">Password management in Django</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-django.contrib.auth.hashers">Manually managing a user&#8217;s password</a></li>
<li class="toctree-l2"><a class="reference internal" href="#customizing-authentication-in-django">Customizing authentication in Django</a></li>
<li class="toctree-l2"><a class="reference internal" href="#other-authentication-sources">Other authentication sources</a></li>
<li class="toctree-l2"><a class="reference internal" href="#custom-permissions">Custom permissions</a></li>
<li class="toctree-l2"><a class="reference internal" href="#extending-the-existing-user-model">Extending the existing User model</a></li>
<li class="toctree-l2"><a class="reference internal" href="#substituting-a-custom-user-model">Substituting a custom User model</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="chapter_12.html">Chapter 12 - testing in Django</a></li>
<li class="toctree-l1"><a class="reference internal" href="chapter_13.html">Chapter 13: Deploying Django</a></li>
<li class="toctree-l1"><a class="reference internal" href="chapter_14.html">Chapter 14 - How to write reusable apps</a></li>
<li class="toctree-l1"><a class="reference internal" href="chapter_15.html">Chapter 15: Generating Non-HTML Content</a></li>
<li class="toctree-l1"><a class="reference internal" href="chapter_16.html">Chapter 16 - Django sessions</a></li>
<li class="toctree-l1"><a class="reference internal" href="chapter_17.html">Chapter 17 - Django&#8217;s cache framework</a></li>
<li class="toctree-l1"><a class="reference internal" href="chapter_18.html">Chapter 18 - Other core Django functionalities</a></li>
<li class="toctree-l1"><a class="reference internal" href="chapter_19.html">Chapter 19 - Django Middleware</a></li>
<li class="toctree-l1"><a class="reference internal" href="chapter_20.html">Chapter 20: Internationalization</a></li>
<li class="toctree-l1"><a class="reference internal" href="chapter_21.html">Chapter 21: Security in Django</a></li>
<li class="toctree-l1"><a class="reference internal" href="chapter_22.html">How to install Django</a></li>
<li class="toctree-l1"><a class="reference internal" href="chapter_23.html">Chapter 23: Advanced database management</a></li>
<li class="toctree-l1"><a class="reference internal" href="appendix_A.html">Appendix A: Model Definition Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="appendix_B.html">Appendix B: Database API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="appendix_C.html">Appendix C: Generic View Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="appendix_D.html">Appendix D: Settings</a></li>
<li class="toctree-l1"><a class="reference internal" href="appendix_E.html">Appendix E: Built-in Template Tags and Filters</a></li>
<li class="toctree-l1"><a class="reference internal" href="appendix_F.html">Appendix F: The django-admin Utility</a></li>
<li class="toctree-l1"><a class="reference internal" href="appendix_G.html">Appendix G: Request and Response Objects</a></li>
<li class="toctree-l1"><a class="reference internal" href="license.html">License &amp; Copyright</a></li>
</ul>

          <div role="search">
            <h3 style="margin-top: 1.5em;">Search</h3>
            <form class="search" action="search.html" method="get">
                <input type="text" name="q" />
                <input type="submit" value="Go" />
                <input type="hidden" name="check_keywords" value="yes" />
                <input type="hidden" name="area" value="default" />
            </form>
            <p class="searchtip" style="font-size: 90%">
                Enter search terms or a module, class or function name.
            </p>
          </div>
        </div>
        <div class="clearer"></div>
      </div>
    </div>

    <div class="footer-wrapper">
      <div class="footer">
        <div class="left">
          <div role="navigation" aria-label="related navigaton">
            <a href="chapter_10.html" title="Chapter 10: Generic Views"
              >previous</a> |
            <a href="chapter_12.html" title="Chapter 12 - testing in Django"
              >next</a> |
            <a href="py-modindex.html" title="Python Module Index"
              >modules</a> |
            <a href="genindex.html" title="General Index"
              >index</a>
          </div>
          <div role="note" aria-label="source link">
              <br/>
              <a href="_sources/chapter_11.txt"
                rel="nofollow">Show Source</a>
          </div>
        </div>

        <div class="right">
          
    <div class="footer" role="contentinfo">
        &copy; Copyright 2015, Nigel George.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.3.1.
    </div>
        </div>
        <div class="clearer"></div>
      </div>
    </div>

  </body>
</html>