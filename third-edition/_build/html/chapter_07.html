<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Chapter 7: Advanced Views and URLconfs &mdash; New Django Book v0.1 0.1 documentation</title>
    
    <link rel="stylesheet" href="_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '0.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="New Django Book v0.1 0.1 documentation" href="index.html" />
    <link rel="next" title="Chapter 8: Advanced Templates" href="chapter_08.html" />
    <link rel="prev" title="Chapter 6: Forms" href="chapter_06.html" />
   
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9">

  </head>
  <body role="document">  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="chapter-7-advanced-views-and-urlconfs">
<h1>Chapter 7: Advanced Views and URLconfs<a class="headerlink" href="#chapter-7-advanced-views-and-urlconfs" title="Permalink to this headline">¶</a></h1>
<p>In Chapter 2, we explained the basics of Django view functions and URLconfs.
This chapter goes into more detail about advanced functionality in those two
pieces of the framework.</p>
<div class="section" id="urlconf-tricks">
<h2>URLconf Tricks<a class="headerlink" href="#urlconf-tricks" title="Permalink to this headline">¶</a></h2>
<p>There&#8217;s nothing &#8220;special&#8221; about URLconfs &#8211; like anything else in Django,
they&#8217;re just Python code. You can take advantage of this in several ways, as
described in the sections that follow.</p>
<div class="section" id="streamlining-function-imports">
<h3>Streamlining Function Imports<a class="headerlink" href="#streamlining-function-imports" title="Permalink to this headline">¶</a></h3>
<p>Consider this URLconf, which builds on the example in Chapter 2:</p>
<div class="highlight-python"><div class="highlight"><pre>from django.conf.urls import include, url
      from django.contrib import admin
      from mysite.views import hello, current_datetime, hours_ahead

      urlpatterns = [
      url(r&#39;^admin/&#39;, include(admin.site.urls)),
      url(r&#39;^hello/$&#39;, hello),
      url(r&#39;^time/$&#39;, current_datetime),
      url(r&#39;^time/plus/(\d{1,2})/$&#39;, hours_ahead),
      ]
</pre></div>
</div>
<p>As explained in Chapter 2, each entry in the URLconf includes its associated
view function, passed directly as a function object. This means it&#8217;s necessary
to import the view functions at the top of the module.</p>
<p>But as a Django application grows in complexity, its URLconf grows, too, and
keeping those imports can be tedious to manage. (For each new view function,
you have to remember to import it, and the import statement tends to get
overly long if you use this approach.) It&#8217;s possible to avoid that tedium by
importing the <code class="docutils literal"><span class="pre">views</span></code> module itself. This example URLconf is equivalent to
the previous one:</p>
<pre class="literal-block">
from django.conf.urls import include, url
<strong>from . import views</strong>

urlpatterns = [
   url(r'^hello/$', <strong>views.hello</strong>),
   url(r'^time/$', <strong>views.current_datetime</strong>),
   url(r'^time/plus/(d{1,2})/$', <strong>views.hours_ahead</strong>),
]
</pre>
</div>
<div class="section" id="special-casing-urls-in-debug-mode">
<h3>Special-Casing URLs in Debug Mode<a class="headerlink" href="#special-casing-urls-in-debug-mode" title="Permalink to this headline">¶</a></h3>
<p>Speaking of constructing <code class="docutils literal"><span class="pre">urlpatterns</span></code> dynamically, you might want to take
advantage of this technique to alter your URLconf&#8217;s behavior while in Django&#8217;s
debug mode. To do this, just check the value of the <code class="docutils literal"><span class="pre">DEBUG</span></code> setting at
runtime, like so:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">django.conf</span> <span class="kn">import</span> <span class="n">settings</span>
<span class="kn">from</span> <span class="nn">django.conf.urls</span> <span class="kn">import</span> <span class="n">url</span>
<span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">views</span>

<span class="n">urlpatterns</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">url</span><span class="p">(</span><span class="s">r&#39;^$&#39;</span><span class="p">,</span> <span class="n">views</span><span class="o">.</span><span class="n">homepage</span><span class="p">),</span>
    <span class="n">url</span><span class="p">(</span><span class="s">r&#39;^(\d{4})/([a-z]{3})/$&#39;</span><span class="p">,</span> <span class="n">views</span><span class="o">.</span><span class="n">archive_month</span><span class="p">),</span>
<span class="p">]</span>

<span class="k">if</span> <span class="n">settings</span><span class="o">.</span><span class="n">DEBUG</span><span class="p">:</span>
    <span class="n">urlpatterns</span> <span class="o">+=</span> <span class="p">[</span><span class="n">url</span><span class="p">(</span><span class="s">r&#39;^debuginfo/$&#39;</span><span class="p">,</span> <span class="n">views</span><span class="o">.</span><span class="n">debug</span><span class="p">),]</span>
</pre></div>
</div>
<p>In this example, the URL <code class="docutils literal"><span class="pre">/debuginfo/</span></code> will only be available if your
<code class="docutils literal"><span class="pre">DEBUG</span></code> setting is set to <code class="docutils literal"><span class="pre">True</span></code>.</p>
</div>
</div>
<div class="section" id="named-groups">
<h2>Named groups<a class="headerlink" href="#named-groups" title="Permalink to this headline">¶</a></h2>
<p>The above example used simple, <em>non-named</em> regular-expression groups (via
parenthesis) to capture bits of the URL and pass them as <em>positional</em> arguments
to a view. In more advanced usage, it&#8217;s possible to use <em>named</em>
regular-expression groups to capture URL bits and pass them as <em>keyword</em>
arguments to a view.</p>
<div class="admonition-keyword-arguments-vs-positional-arguments admonition">
<p class="first admonition-title">Keyword Arguments vs. Positional Arguments</p>
<p>A Python function can be called using keyword arguments or positional
arguments &#8211; and, in some cases, both at the same time. In a keyword
argument call, you specify the names of the arguments along with the values
you&#8217;re passing. In a positional argument call, you simply pass the
arguments without explicitly specifying which argument matches which value;
the association is implicit in the arguments&#8217; order.</p>
<p>For example, consider this simple function:</p>
<div class="highlight-python"><div class="highlight"><pre>def sell(item, price, quantity):
    print &quot;Selling %s unit(s) of %s at %s&quot; % (quantity, item, price)
</pre></div>
</div>
<p>To call it with positional arguments, you specify the arguments in the
order in which they&#8217;re listed in the function definition:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">sell</span><span class="p">(</span><span class="s">&#39;Socks&#39;</span><span class="p">,</span> <span class="s">&#39;$2.50&#39;</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
</pre></div>
</div>
<p>To call it with keyword arguments, you specify the names of the arguments
along with the values. The following statements are equivalent:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">sell</span><span class="p">(</span><span class="n">item</span><span class="o">=</span><span class="s">&#39;Socks&#39;</span><span class="p">,</span> <span class="n">price</span><span class="o">=</span><span class="s">&#39;$2.50&#39;</span><span class="p">,</span> <span class="n">quantity</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>
<span class="n">sell</span><span class="p">(</span><span class="n">item</span><span class="o">=</span><span class="s">&#39;Socks&#39;</span><span class="p">,</span> <span class="n">quantity</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">price</span><span class="o">=</span><span class="s">&#39;$2.50&#39;</span><span class="p">)</span>
<span class="n">sell</span><span class="p">(</span><span class="n">price</span><span class="o">=</span><span class="s">&#39;$2.50&#39;</span><span class="p">,</span> <span class="n">item</span><span class="o">=</span><span class="s">&#39;Socks&#39;</span><span class="p">,</span> <span class="n">quantity</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>
<span class="n">sell</span><span class="p">(</span><span class="n">price</span><span class="o">=</span><span class="s">&#39;$2.50&#39;</span><span class="p">,</span> <span class="n">quantity</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">item</span><span class="o">=</span><span class="s">&#39;Socks&#39;</span><span class="p">)</span>
<span class="n">sell</span><span class="p">(</span><span class="n">quantity</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">item</span><span class="o">=</span><span class="s">&#39;Socks&#39;</span><span class="p">,</span> <span class="n">price</span><span class="o">=</span><span class="s">&#39;$2.50&#39;</span><span class="p">)</span>
<span class="n">sell</span><span class="p">(</span><span class="n">quantity</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">price</span><span class="o">=</span><span class="s">&#39;$2.50&#39;</span><span class="p">,</span> <span class="n">item</span><span class="o">=</span><span class="s">&#39;Socks&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Finally, you can mix keyword and positional arguments, as long as all
positional arguments are listed before keyword arguments. The following
statements are equivalent to the previous examples:</p>
<div class="last highlight-python"><div class="highlight"><pre><span class="n">sell</span><span class="p">(</span><span class="s">&#39;Socks&#39;</span><span class="p">,</span> <span class="s">&#39;$2.50&#39;</span><span class="p">,</span> <span class="n">quantity</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>
<span class="n">sell</span><span class="p">(</span><span class="s">&#39;Socks&#39;</span><span class="p">,</span> <span class="n">price</span><span class="o">=</span><span class="s">&#39;$2.50&#39;</span><span class="p">,</span> <span class="n">quantity</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>
<span class="n">sell</span><span class="p">(</span><span class="s">&#39;Socks&#39;</span><span class="p">,</span> <span class="n">quantity</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">price</span><span class="o">=</span><span class="s">&#39;$2.50&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>In Python regular expressions, the syntax for named regular-expression groups
is <code class="docutils literal"><span class="pre">(?P&lt;name&gt;pattern)</span></code>, where <code class="docutils literal"><span class="pre">name</span></code> is the name of the group and
<code class="docutils literal"><span class="pre">pattern</span></code> is some pattern to match.</p>
<p>Here&#8217;s a sample URLconf:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">django.conf.urls</span> <span class="kn">import</span> <span class="n">url</span>

<span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">views</span>

<span class="n">urlpatterns</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">url</span><span class="p">(</span><span class="s">r&#39;^articles/2003/$&#39;</span><span class="p">,</span> <span class="n">views</span><span class="o">.</span><span class="n">special_case_2003</span><span class="p">),</span>
    <span class="n">url</span><span class="p">(</span><span class="s">r&#39;^articles/([0-9]{4})/$&#39;</span><span class="p">,</span> <span class="n">views</span><span class="o">.</span><span class="n">year_archive</span><span class="p">),</span>
    <span class="n">url</span><span class="p">(</span><span class="s">r&#39;^articles/([0-9]{4})/([0-9]{2})/$&#39;</span><span class="p">,</span> <span class="n">views</span><span class="o">.</span><span class="n">month_archive</span><span class="p">),</span>
    <span class="n">url</span><span class="p">(</span><span class="s">r&#39;^articles/([0-9]{4})/([0-9]{2})/([0-9]+)/$&#39;</span><span class="p">,</span> <span class="n">views</span><span class="o">.</span><span class="n">article_detail</span><span class="p">),</span>
<span class="p">]</span>
</pre></div>
</div>
<p>Notes:</p>
<ul class="simple">
<li>To capture a value from the URL, just put parenthesis around it.</li>
<li>There&#8217;s no need to add a leading slash, because every URL has that. For
example, it&#8217;s <code class="docutils literal"><span class="pre">^articles</span></code>, not <code class="docutils literal"><span class="pre">^/articles</span></code>.</li>
<li>The <code class="docutils literal"><span class="pre">'r'</span></code> in front of each regular expression string is optional but
recommended. It tells Python that a string is &#8220;raw&#8221; &#8211; that nothing in
the string should be escaped.</li>
</ul>
<p>Example requests:</p>
<ul class="simple">
<li>A request to <code class="docutils literal"><span class="pre">/articles/2005/03/</span></code> would match the third entry in the
list. Django would call the function
<code class="docutils literal"><span class="pre">views.month_archive(request,</span> <span class="pre">'2005',</span> <span class="pre">'03')</span></code>.</li>
<li><code class="docutils literal"><span class="pre">/articles/2005/3/</span></code> would not match any URL patterns, because the
third entry in the list requires two digits for the month.</li>
<li><code class="docutils literal"><span class="pre">/articles/2003/</span></code> would match the first pattern in the list, not the
second one, because the patterns are tested in order, and the first one
is the first test to pass. Feel free to exploit the ordering to insert
special cases like this.</li>
<li><code class="docutils literal"><span class="pre">/articles/2003</span></code> would not match any of these patterns, because each
pattern requires that the URL end with a slash.</li>
<li><code class="docutils literal"><span class="pre">/articles/2003/03/03/</span></code> would match the final pattern. Django would call
the function <code class="docutils literal"><span class="pre">views.article_detail(request,</span> <span class="pre">'2003',</span> <span class="pre">'03',</span> <span class="pre">'03')</span></code>.</li>
</ul>
<p>Here&#8217;s the above example URLconf, rewritten to use named groups:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">django.conf.urls</span> <span class="kn">import</span> <span class="n">url</span>

<span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">views</span>

<span class="n">urlpatterns</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">url</span><span class="p">(</span><span class="s">r&#39;^articles/2003/$&#39;</span><span class="p">,</span> <span class="n">views</span><span class="o">.</span><span class="n">special_case_2003</span><span class="p">),</span>
    <span class="n">url</span><span class="p">(</span><span class="s">r&#39;^articles/(?P&lt;year&gt;[0-9]{4})/$&#39;</span><span class="p">,</span> <span class="n">views</span><span class="o">.</span><span class="n">year_archive</span><span class="p">),</span>
    <span class="n">url</span><span class="p">(</span><span class="s">r&#39;^articles/(?P&lt;year&gt;[0-9]{4})/(?P&lt;month&gt;[0-9]{2})/$&#39;</span><span class="p">,</span> <span class="n">views</span><span class="o">.</span><span class="n">month_archive</span><span class="p">),</span>
    <span class="n">url</span><span class="p">(</span><span class="s">r&#39;^articles/(?P&lt;year&gt;[0-9]{4})/(?P&lt;month&gt;[0-9]{2})/(?P&lt;day&gt;[0-9]{2})/$&#39;</span><span class="p">,</span> <span class="n">views</span><span class="o">.</span><span class="n">article_detail</span><span class="p">),</span>
<span class="p">]</span>
</pre></div>
</div>
<p>This accomplishes exactly the same thing as the previous example, with one
subtle difference: The captured values are passed to view functions as keyword
arguments rather than positional arguments. For example:</p>
<ul class="simple">
<li>A request to <code class="docutils literal"><span class="pre">/articles/2005/03/</span></code> would call the function
<code class="docutils literal"><span class="pre">views.month_archive(request,</span> <span class="pre">year='2005',</span> <span class="pre">month='03')</span></code>, instead
of <code class="docutils literal"><span class="pre">views.month_archive(request,</span> <span class="pre">'2005',</span> <span class="pre">'03')</span></code>.</li>
<li>A request to <code class="docutils literal"><span class="pre">/articles/2003/03/03/</span></code> would call the function
<code class="docutils literal"><span class="pre">views.article_detail(request,</span> <span class="pre">year='2003',</span> <span class="pre">month='03',</span> <span class="pre">day='03')</span></code>.</li>
</ul>
<p>In practice, this means your URLconfs are slightly more explicit and less prone
to argument-order bugs &#8211; and you can reorder the arguments in your views&#8217;
function definitions. Of course, these benefits come at the cost of brevity;
some developers find the named-group syntax ugly and too verbose.</p>
<div class="section" id="the-matching-grouping-algorithm">
<h3>The matching/grouping algorithm<a class="headerlink" href="#the-matching-grouping-algorithm" title="Permalink to this headline">¶</a></h3>
<p>Here&#8217;s the algorithm the URLconf parser follows, with respect to named groups
vs. non-named groups in a regular expression:</p>
<ol class="arabic simple">
<li>If there are any named arguments, it will use those, ignoring non-named
arguments.</li>
<li>Otherwise, it will pass all non-named arguments as positional arguments.</li>
</ol>
<p>In both cases, any extra keyword arguments that have been given will also be passed to the view.</p>
</div>
</div>
<div class="section" id="what-the-urlconf-searches-against">
<h2>What the URLconf searches against<a class="headerlink" href="#what-the-urlconf-searches-against" title="Permalink to this headline">¶</a></h2>
<p>The URLconf searches against the requested URL, as a normal Python string. This
does not include GET or POST parameters, or the domain name.</p>
<p>For example, in a request to <code class="docutils literal"><span class="pre">http://www.example.com/myapp/</span></code>, the URLconf
will look for <code class="docutils literal"><span class="pre">myapp/</span></code>.</p>
<p>In a request to <code class="docutils literal"><span class="pre">http://www.example.com/myapp/?page=3</span></code>, the URLconf will look
for <code class="docutils literal"><span class="pre">myapp/</span></code>.</p>
<p>The URLconf doesn&#8217;t look at the request method. In other words, all request
methods &#8211; <code class="docutils literal"><span class="pre">POST</span></code>, <code class="docutils literal"><span class="pre">GET</span></code>, <code class="docutils literal"><span class="pre">HEAD</span></code>, etc. &#8211; will be routed to the same
function for the same URL.</p>
</div>
<div class="section" id="captured-arguments-are-always-strings">
<h2>Captured arguments are always strings<a class="headerlink" href="#captured-arguments-are-always-strings" title="Permalink to this headline">¶</a></h2>
<p>Each captured argument is sent to the view as a plain Python string, regardless
of what sort of match the regular expression makes. For example, in this
URLconf line:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">url</span><span class="p">(</span><span class="s">r&#39;^articles/(?P&lt;year&gt;[0-9]{4})/$&#39;</span><span class="p">,</span> <span class="n">views</span><span class="o">.</span><span class="n">year_archive</span><span class="p">),</span>
</pre></div>
</div>
<p>...the <code class="docutils literal"><span class="pre">year</span></code> argument to <code class="docutils literal"><span class="pre">views.year_archive()</span></code> will be a string, not
an integer, even though the <code class="docutils literal"><span class="pre">[0-9]{4}</span></code> will only match integer strings.</p>
</div>
<div class="section" id="specifying-defaults-for-view-arguments">
<h2>Specifying defaults for view arguments<a class="headerlink" href="#specifying-defaults-for-view-arguments" title="Permalink to this headline">¶</a></h2>
<p>A convenient trick is to specify default parameters for your views&#8217; arguments.
Here&#8217;s an example URLconf and view:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># URLconf</span>
<span class="kn">from</span> <span class="nn">django.conf.urls</span> <span class="kn">import</span> <span class="n">url</span>

<span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">views</span>

<span class="n">urlpatterns</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">url</span><span class="p">(</span><span class="s">r&#39;^blog/$&#39;</span><span class="p">,</span> <span class="n">views</span><span class="o">.</span><span class="n">page</span><span class="p">),</span>
    <span class="n">url</span><span class="p">(</span><span class="s">r&#39;^blog/page(?P&lt;num&gt;[0-9]+)/$&#39;</span><span class="p">,</span> <span class="n">views</span><span class="o">.</span><span class="n">page</span><span class="p">),</span>
<span class="p">]</span>

<span class="c"># View (in blog/views.py)</span>
<span class="k">def</span> <span class="nf">page</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">num</span><span class="o">=</span><span class="s">&quot;1&quot;</span><span class="p">):</span>
    <span class="c"># Output the appropriate page of blog entries, according to num.</span>
    <span class="o">...</span>
</pre></div>
</div>
<p>In the above example, both URL patterns point to the same view &#8211;
<code class="docutils literal"><span class="pre">views.page</span></code> &#8211; but the first pattern doesn&#8217;t capture anything from the
URL. If the first pattern matches, the <code class="docutils literal"><span class="pre">page()</span></code> function will use its
default argument for <code class="docutils literal"><span class="pre">num</span></code>, <code class="docutils literal"><span class="pre">&quot;1&quot;</span></code>. If the second pattern matches,
<code class="docutils literal"><span class="pre">page()</span></code> will use whatever <code class="docutils literal"><span class="pre">num</span></code> value was captured by the regex.</p>
</div>
<div class="section" id="performance">
<h2>Performance<a class="headerlink" href="#performance" title="Permalink to this headline">¶</a></h2>
<p>Each regular expression in a <code class="docutils literal"><span class="pre">urlpatterns</span></code> is compiled the first time it&#8217;s
accessed. This makes the system blazingly fast.</p>
</div>
<div class="section" id="error-handling">
<h2>Error handling<a class="headerlink" href="#error-handling" title="Permalink to this headline">¶</a></h2>
<p>When Django can&#8217;t find a regex matching the requested URL, or when an
exception is raised, Django will invoke an error-handling view.</p>
<p>The views to use for these cases are specified by four variables. Their
default values should suffice for most projects, but further customization is
possible by assigning values to them.</p>
<p>Such values can be set in your root URLconf. Setting these variables in any
other URLconf will have no effect.</p>
<p>Values must be callables, or strings representing the full Python import path
to the view that should be called to handle the error condition at hand.</p>
<p>The variables are:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">handler404</span></code> &#8211; See <code class="xref py py-data docutils literal"><span class="pre">django.conf.urls.handler404</span></code>.</li>
<li><code class="docutils literal"><span class="pre">handler500</span></code> &#8211; See <code class="xref py py-data docutils literal"><span class="pre">django.conf.urls.handler500</span></code>.</li>
<li><code class="docutils literal"><span class="pre">handler403</span></code> &#8211; See <code class="xref py py-data docutils literal"><span class="pre">django.conf.urls.handler403</span></code>.</li>
<li><code class="docutils literal"><span class="pre">handler400</span></code> &#8211; See <code class="xref py py-data docutils literal"><span class="pre">django.conf.urls.handler400</span></code>.</li>
</ul>
</div>
<div class="section" id="including-other-urlconfs">
<span id="id1"></span><h2>Including other URLconfs<a class="headerlink" href="#including-other-urlconfs" title="Permalink to this headline">¶</a></h2>
<p>At any point, your <code class="docutils literal"><span class="pre">urlpatterns</span></code> can &#8220;include&#8221; other URLconf modules. This
essentially &#8220;roots&#8221; a set of URLs below other ones.</p>
<p>For example, here&#8217;s an excerpt of the URLconf for the Django Web site
itself. It includes a number of other URLconfs:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">django.conf.urls</span> <span class="kn">import</span> <span class="n">include</span><span class="p">,</span> <span class="n">url</span>

<span class="n">urlpatterns</span> <span class="o">=</span> <span class="p">[</span>
    <span class="c"># ... snip ...</span>
    <span class="n">url</span><span class="p">(</span><span class="s">r&#39;^community/&#39;</span><span class="p">,</span> <span class="n">include</span><span class="p">(</span><span class="s">&#39;django_website.aggregator.urls&#39;</span><span class="p">)),</span>
    <span class="n">url</span><span class="p">(</span><span class="s">r&#39;^contact/&#39;</span><span class="p">,</span> <span class="n">include</span><span class="p">(</span><span class="s">&#39;django_website.contact.urls&#39;</span><span class="p">)),</span>
    <span class="c"># ... snip ...</span>
<span class="p">]</span>
</pre></div>
</div>
<p>Note that the regular expressions in this example don&#8217;t have a <code class="docutils literal"><span class="pre">$</span></code>
(end-of-string match character) but do include a trailing slash. Whenever
Django encounters <code class="docutils literal"><span class="pre">include()</span></code> (<code class="xref py py-func docutils literal"><span class="pre">django.conf.urls.include()</span></code>), it chops
off whatever part of the URL matched up to that point and sends the remaining
string to the included URLconf for further processing.</p>
<p>Another possibility is to include additional URL patterns by using a list of
<code class="xref py py-func docutils literal"><span class="pre">url()</span></code> instances. For example, consider this URLconf:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">django.conf.urls</span> <span class="kn">import</span> <span class="n">include</span><span class="p">,</span> <span class="n">url</span>

<span class="kn">from</span> <span class="nn">apps.main</span> <span class="kn">import</span> <span class="n">views</span> <span class="k">as</span> <span class="n">main_views</span>
<span class="kn">from</span> <span class="nn">credit</span> <span class="kn">import</span> <span class="n">views</span> <span class="k">as</span> <span class="n">credit_views</span>

<span class="n">extra_patterns</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">url</span><span class="p">(</span><span class="s">r&#39;^reports/(?P&lt;id&gt;[0-9]+)/$&#39;</span><span class="p">,</span> <span class="n">credit_views</span><span class="o">.</span><span class="n">report</span><span class="p">),</span>
    <span class="n">url</span><span class="p">(</span><span class="s">r&#39;^charge/$&#39;</span><span class="p">,</span> <span class="n">credit_views</span><span class="o">.</span><span class="n">charge</span><span class="p">),</span>
<span class="p">]</span>

<span class="n">urlpatterns</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">url</span><span class="p">(</span><span class="s">r&#39;^$&#39;</span><span class="p">,</span> <span class="n">main_views</span><span class="o">.</span><span class="n">homepage</span><span class="p">),</span>
    <span class="n">url</span><span class="p">(</span><span class="s">r&#39;^help/&#39;</span><span class="p">,</span> <span class="n">include</span><span class="p">(</span><span class="s">&#39;apps.help.urls&#39;</span><span class="p">)),</span>
    <span class="n">url</span><span class="p">(</span><span class="s">r&#39;^credit/&#39;</span><span class="p">,</span> <span class="n">include</span><span class="p">(</span><span class="n">extra_patterns</span><span class="p">)),</span>
<span class="p">]</span>
</pre></div>
</div>
<p>In this example, the <code class="docutils literal"><span class="pre">/credit/reports/</span></code> URL will be handled by the
<code class="docutils literal"><span class="pre">credit.views.report()</span></code> Django view.</p>
<p>This can be used to remove redundancy from URLconfs where a single pattern
prefix is used repeatedly. For example, consider this URLconf:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">django.conf.urls</span> <span class="kn">import</span> <span class="n">url</span>
<span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">views</span>

<span class="n">urlpatterns</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">url</span><span class="p">(</span><span class="s">r&#39;^(?P&lt;page_slug&gt;\w+)-(?P&lt;page_id&gt;\w+)/history/$&#39;</span><span class="p">,</span> <span class="n">views</span><span class="o">.</span><span class="n">history</span><span class="p">),</span>
    <span class="n">url</span><span class="p">(</span><span class="s">r&#39;^(?P&lt;page_slug&gt;\w+)-(?P&lt;page_id&gt;\w+)/edit/$&#39;</span><span class="p">,</span> <span class="n">views</span><span class="o">.</span><span class="n">edit</span><span class="p">),</span>
    <span class="n">url</span><span class="p">(</span><span class="s">r&#39;^(?P&lt;page_slug&gt;\w+)-(?P&lt;page_id&gt;\w+)/discuss/$&#39;</span><span class="p">,</span> <span class="n">views</span><span class="o">.</span><span class="n">discuss</span><span class="p">),</span>
    <span class="n">url</span><span class="p">(</span><span class="s">r&#39;^(?P&lt;page_slug&gt;\w+)-(?P&lt;page_id&gt;\w+)/permissions/$&#39;</span><span class="p">,</span> <span class="n">views</span><span class="o">.</span><span class="n">permissions</span><span class="p">),</span>
<span class="p">]</span>
</pre></div>
</div>
<p>We can improve this by stating the common path prefix only once and grouping
the suffixes that differ:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">django.conf.urls</span> <span class="kn">import</span> <span class="n">include</span><span class="p">,</span> <span class="n">url</span>
<span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">views</span>

<span class="n">urlpatterns</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">url</span><span class="p">(</span><span class="s">r&#39;^(?P&lt;page_slug&gt;\w+)-(?P&lt;page_id&gt;\w+)/&#39;</span><span class="p">,</span> <span class="n">include</span><span class="p">([</span>
        <span class="n">url</span><span class="p">(</span><span class="s">r&#39;^history/$&#39;</span><span class="p">,</span> <span class="n">views</span><span class="o">.</span><span class="n">history</span><span class="p">),</span>
        <span class="n">url</span><span class="p">(</span><span class="s">r&#39;^edit/$&#39;</span><span class="p">,</span> <span class="n">views</span><span class="o">.</span><span class="n">edit</span><span class="p">),</span>
        <span class="n">url</span><span class="p">(</span><span class="s">r&#39;^discuss/$&#39;</span><span class="p">,</span> <span class="n">views</span><span class="o">.</span><span class="n">discuss</span><span class="p">),</span>
        <span class="n">url</span><span class="p">(</span><span class="s">r&#39;^permissions/$&#39;</span><span class="p">,</span> <span class="n">views</span><span class="o">.</span><span class="n">permissions</span><span class="p">),</span>
    <span class="p">])),</span>
<span class="p">]</span>
</pre></div>
</div>
<div class="section" id="captured-parameters">
<h3>Captured parameters<a class="headerlink" href="#captured-parameters" title="Permalink to this headline">¶</a></h3>
<p>An included URLconf receives any captured parameters from parent URLconfs, so
the following example is valid:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># In settings/urls/main.py</span>
<span class="kn">from</span> <span class="nn">django.conf.urls</span> <span class="kn">import</span> <span class="n">include</span><span class="p">,</span> <span class="n">url</span>

<span class="n">urlpatterns</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">url</span><span class="p">(</span><span class="s">r&#39;^(?P&lt;username&gt;\w+)/blog/&#39;</span><span class="p">,</span> <span class="n">include</span><span class="p">(</span><span class="s">&#39;foo.urls.blog&#39;</span><span class="p">)),</span>
<span class="p">]</span>

<span class="c"># In foo/urls/blog.py</span>
<span class="kn">from</span> <span class="nn">django.conf.urls</span> <span class="kn">import</span> <span class="n">url</span>
<span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">views</span>

<span class="n">urlpatterns</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">url</span><span class="p">(</span><span class="s">r&#39;^$&#39;</span><span class="p">,</span> <span class="n">views</span><span class="o">.</span><span class="n">blog</span><span class="o">.</span><span class="n">index</span><span class="p">),</span>
    <span class="n">url</span><span class="p">(</span><span class="s">r&#39;^archive/$&#39;</span><span class="p">,</span> <span class="n">views</span><span class="o">.</span><span class="n">blog</span><span class="o">.</span><span class="n">archive</span><span class="p">),</span>
<span class="p">]</span>
</pre></div>
</div>
<p>In the above example, the captured <code class="docutils literal"><span class="pre">&quot;username&quot;</span></code> variable is passed to the
included URLconf, as expected.</p>
</div>
</div>
<div class="section" id="passing-extra-options-to-view-functions">
<span id="views-extra-options"></span><h2>Passing extra options to view functions<a class="headerlink" href="#passing-extra-options-to-view-functions" title="Permalink to this headline">¶</a></h2>
<p>URLconfs have a hook that lets you pass extra arguments to your view functions,
as a Python dictionary.</p>
<p>The <code class="xref py py-func docutils literal"><span class="pre">django.conf.urls.url()</span></code> function can take an optional third argument
which should be a dictionary of extra keyword arguments to pass to the view
function.</p>
<p>For example:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">django.conf.urls</span> <span class="kn">import</span> <span class="n">url</span>
<span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">views</span>

<span class="n">urlpatterns</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">url</span><span class="p">(</span><span class="s">r&#39;^blog/(?P&lt;year&gt;[0-9]{4})/$&#39;</span><span class="p">,</span> <span class="n">views</span><span class="o">.</span><span class="n">year_archive</span><span class="p">,</span> <span class="p">{</span><span class="s">&#39;foo&#39;</span><span class="p">:</span> <span class="s">&#39;bar&#39;</span><span class="p">}),</span>
<span class="p">]</span>
</pre></div>
</div>
<p>In this example, for a request to <code class="docutils literal"><span class="pre">/blog/2005/</span></code>, Django will call
<code class="docutils literal"><span class="pre">views.year_archive(request,</span> <span class="pre">year='2005',</span> <span class="pre">foo='bar')</span></code>.</p>
<p>This technique is used in the syndication framework to pass metadata and
options to views (see Chapter 15).</p>
<div class="admonition-dealing-with-conflicts admonition">
<p class="first admonition-title">Dealing with conflicts</p>
<p class="last">It&#8217;s possible to have a URL pattern which captures named keyword arguments,
and also passes arguments with the same names in its dictionary of extra
arguments. When this happens, the arguments in the dictionary will be used
instead of the arguments captured in the URL.</p>
</div>
<div class="section" id="passing-extra-options-to-include">
<h3>Passing extra options to <code class="docutils literal"><span class="pre">include()</span></code><a class="headerlink" href="#passing-extra-options-to-include" title="Permalink to this headline">¶</a></h3>
<p>Similarly, you can pass extra options to <code class="xref py py-func docutils literal"><span class="pre">include()</span></code>.
When you pass extra options to <code class="docutils literal"><span class="pre">include()</span></code>, <em>each</em> line in the included
URLconf will be passed the extra options.</p>
<p>For example, these two URLconf sets are functionally identical:</p>
<p>Set one:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># main.py</span>
<span class="kn">from</span> <span class="nn">django.conf.urls</span> <span class="kn">import</span> <span class="n">include</span><span class="p">,</span> <span class="n">url</span>

<span class="n">urlpatterns</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">url</span><span class="p">(</span><span class="s">r&#39;^blog/&#39;</span><span class="p">,</span> <span class="n">include</span><span class="p">(</span><span class="s">&#39;inner&#39;</span><span class="p">),</span> <span class="p">{</span><span class="s">&#39;blogid&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">}),</span>
<span class="p">]</span>

<span class="c"># inner.py</span>
<span class="kn">from</span> <span class="nn">django.conf.urls</span> <span class="kn">import</span> <span class="n">url</span>
<span class="kn">from</span> <span class="nn">mysite</span> <span class="kn">import</span> <span class="n">views</span>

<span class="n">urlpatterns</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">url</span><span class="p">(</span><span class="s">r&#39;^archive/$&#39;</span><span class="p">,</span> <span class="n">views</span><span class="o">.</span><span class="n">archive</span><span class="p">),</span>
    <span class="n">url</span><span class="p">(</span><span class="s">r&#39;^about/$&#39;</span><span class="p">,</span> <span class="n">views</span><span class="o">.</span><span class="n">about</span><span class="p">),</span>
<span class="p">]</span>
</pre></div>
</div>
<p>Set two:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># main.py</span>
<span class="kn">from</span> <span class="nn">django.conf.urls</span> <span class="kn">import</span> <span class="n">include</span><span class="p">,</span> <span class="n">url</span>
<span class="kn">from</span> <span class="nn">mysite</span> <span class="kn">import</span> <span class="n">views</span>

<span class="n">urlpatterns</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">url</span><span class="p">(</span><span class="s">r&#39;^blog/&#39;</span><span class="p">,</span> <span class="n">include</span><span class="p">(</span><span class="s">&#39;inner&#39;</span><span class="p">)),</span>
<span class="p">]</span>

<span class="c"># inner.py</span>
<span class="kn">from</span> <span class="nn">django.conf.urls</span> <span class="kn">import</span> <span class="n">url</span>

<span class="n">urlpatterns</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">url</span><span class="p">(</span><span class="s">r&#39;^archive/$&#39;</span><span class="p">,</span> <span class="n">views</span><span class="o">.</span><span class="n">archive</span><span class="p">,</span> <span class="p">{</span><span class="s">&#39;blogid&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">}),</span>
    <span class="n">url</span><span class="p">(</span><span class="s">r&#39;^about/$&#39;</span><span class="p">,</span> <span class="n">views</span><span class="o">.</span><span class="n">about</span><span class="p">,</span> <span class="p">{</span><span class="s">&#39;blogid&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">}),</span>
<span class="p">]</span>
</pre></div>
</div>
<p>Note that extra options will <em>always</em> be passed to <em>every</em> line in the included
URLconf, regardless of whether the line&#8217;s view actually accepts those options
as valid. For this reason, this technique is only useful if you&#8217;re certain that
every view in the included URLconf accepts the extra options you&#8217;re passing.</p>
</div>
</div>
<div class="section" id="reverse-resolution-of-urls">
<h2>Reverse resolution of URLs<a class="headerlink" href="#reverse-resolution-of-urls" title="Permalink to this headline">¶</a></h2>
<p>A common need when working on a Django project is the possibility to obtain URLs
in their final forms either for embedding in generated content (views and assets
URLs, URLs shown to the user, etc.) or for handling of the navigation flow on
the server side (redirections, etc.)</p>
<p>It is strongly desirable not having to hard-code these URLs (a laborious,
non-scalable and error-prone strategy) or having to devise ad-hoc mechanisms for
generating URLs that are parallel to the design described by the URLconf and as
such in danger of producing stale URLs at some point.</p>
<p>In other words, what&#8217;s needed is a DRY mechanism. Among other advantages it
would allow evolution of the URL design without having to go all over the
project source code to search and replace outdated URLs.</p>
<p>The piece of information we have available as a starting point to get a URL is
an identification (e.g. the name) of the view in charge of handling it, other
pieces of information that necessarily must participate in the lookup of the
right URL are the types (positional, keyword) and values of the view arguments.</p>
<p>Django provides a solution such that the URL mapper is the only repository of
the URL design. You feed it with your URLconf and then it can be used in both
directions:</p>
<ul class="simple">
<li>Starting with a URL requested by the user/browser, it calls the right Django
view providing any arguments it might need with their values as extracted from
the URL.</li>
<li>Starting with the identification of the corresponding Django view plus the
values of arguments that would be passed to it, obtain the associated URL.</li>
</ul>
<p>The first one is the usage we&#8217;ve been discussing in the previous sections. The
second one is what is known as <em>reverse resolution of URLs</em>, <em>reverse URL
matching</em>, <em>reverse URL lookup</em>, or simply <em>URL reversing</em>.</p>
<p>Django provides tools for performing URL reversing that match the different
layers where URLs are needed:</p>
<ul class="simple">
<li>In templates: Using the <code class="docutils literal"><span class="pre">url</span></code> template tag.</li>
<li>In Python code: Using the <code class="xref py py-func docutils literal"><span class="pre">django.core.urlresolvers.reverse()</span></code>
function.</li>
<li>In higher level code related to handling of URLs of Django model instances:
The <code class="xref py py-meth docutils literal"><span class="pre">get_absolute_url()</span></code> method.</li>
</ul>
<div class="section" id="examples">
<h3>Examples<a class="headerlink" href="#examples" title="Permalink to this headline">¶</a></h3>
<p>Consider again this URLconf entry:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">django.conf.urls</span> <span class="kn">import</span> <span class="n">url</span>

<span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">views</span>

<span class="n">urlpatterns</span> <span class="o">=</span> <span class="p">[</span>
    <span class="c">#...</span>
    <span class="n">url</span><span class="p">(</span><span class="s">r&#39;^articles/([0-9]{4})/$&#39;</span><span class="p">,</span> <span class="n">views</span><span class="o">.</span><span class="n">year_archive</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s">&#39;news-year-archive&#39;</span><span class="p">),</span>
    <span class="c">#...</span>
<span class="p">]</span>
</pre></div>
</div>
<p>According to this design, the URL for the archive corresponding to year <em>nnnn</em>
is <code class="docutils literal"><span class="pre">/articles/nnnn/</span></code>.</p>
<p>You can obtain these in template code by using:</p>
<div class="highlight-html+django"><div class="highlight"><pre><span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">&quot;</span><span class="cp">{%</span> <span class="k">url</span> <span class="s1">&#39;news-year-archive&#39;</span> <span class="m">2012</span> <span class="cp">%}</span><span class="s">&quot;</span><span class="nt">&gt;</span>2012 Archive<span class="nt">&lt;/a&gt;</span>
<span class="c">{# Or with the year in a template context variable: #}</span>
<span class="nt">&lt;ul&gt;</span>
<span class="cp">{%</span> <span class="k">for</span> <span class="nv">yearvar</span> <span class="k">in</span> <span class="nv">year_list</span> <span class="cp">%}</span>
<span class="nt">&lt;li&gt;&lt;a</span> <span class="na">href=</span><span class="s">&quot;</span><span class="cp">{%</span> <span class="k">url</span> <span class="s1">&#39;news-year-archive&#39;</span> <span class="nv">yearvar</span> <span class="cp">%}</span><span class="s">&quot;</span><span class="nt">&gt;</span><span class="cp">{{</span> <span class="nv">yearvar</span> <span class="cp">}}</span> Archive<span class="nt">&lt;/a&gt;&lt;/li&gt;</span>
<span class="cp">{%</span> <span class="k">endfor</span> <span class="cp">%}</span>
<span class="nt">&lt;/ul&gt;</span>
</pre></div>
</div>
<p>Or in Python code:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">django.core.urlresolvers</span> <span class="kn">import</span> <span class="n">reverse</span>
<span class="kn">from</span> <span class="nn">django.http</span> <span class="kn">import</span> <span class="n">HttpResponseRedirect</span>

<span class="k">def</span> <span class="nf">redirect_to_year</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
    <span class="c"># ...</span>
    <span class="n">year</span> <span class="o">=</span> <span class="mi">2006</span>
    <span class="c"># ...</span>
    <span class="k">return</span> <span class="n">HttpResponseRedirect</span><span class="p">(</span><span class="n">reverse</span><span class="p">(</span><span class="s">&#39;news-year-archive&#39;</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">year</span><span class="p">,)))</span>
</pre></div>
</div>
<p>If, for some reason, it was decided that the URLs where content for yearly
article archives are published at should be changed then you would only need to
change the entry in the URLconf.</p>
<p>In some scenarios where views are of a generic nature, a many-to-one
relationship might exist between URLs and views. For these cases the view name
isn&#8217;t a good enough identifier for it when comes the time of reversing
URLs. Read the next section to know about the solution Django provides for this.</p>
</div>
</div>
<div class="section" id="naming-url-patterns">
<span id="id2"></span><h2>Naming URL patterns<a class="headerlink" href="#naming-url-patterns" title="Permalink to this headline">¶</a></h2>
<p>In order to perform URL reversing, you&#8217;ll need to use <strong>named URL patterns</strong>
as done in the examples above. The string used for the URL name can contain any
characters you like. You are not restricted to valid Python names.</p>
<p>When you name your URL patterns, make sure you use names that are unlikely
to clash with any other application&#8217;s choice of names. If you call your URL
pattern <code class="docutils literal"><span class="pre">comment</span></code>, and another application does the same thing, there&#8217;s
no guarantee which URL will be inserted into your template when you use
this name.</p>
<p>Putting a prefix on your URL names, perhaps derived from the application
name, will decrease the chances of collision. We recommend something like
<code class="docutils literal"><span class="pre">myapp-comment</span></code> instead of <code class="docutils literal"><span class="pre">comment</span></code>.</p>
</div>
<div class="section" id="url-namespaces">
<span id="topics-http-defining-url-namespaces"></span><h2>URL namespaces<a class="headerlink" href="#url-namespaces" title="Permalink to this headline">¶</a></h2>
<div class="section" id="introduction">
<h3>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h3>
<p>URL namespaces allow you to uniquely reverse named URL patterns even if different applications use the same URL names.
It&#8217;s a good practice for third-party apps to always use namespaced URLs (as we
did in the tutorial). Similarly, it also allows you to reverse URLs if multiple
instances of an application are deployed. In other words, since multiple
instances of a single application will share named URLs, namespaces provide a
way to tell these named URLs apart.</p>
<p>Django applications that make proper use of URL namespacing can be deployed more
than once for a particular site. For example <code class="xref py py-mod docutils literal"><span class="pre">django.contrib.admin</span></code> has an
<code class="xref py py-class docutils literal"><span class="pre">AdminSite</span></code> class which allows you to easily
deploy more than once instance of the admin`.</p>
<p>A URL namespace comes in two parts, both of which are strings:</p>
<dl class="glossary docutils">
<dt id="term-application-namespace">application namespace</dt>
<dd>This describes the name of the application that is being deployed. Every
instance of a single application will have the same application namespace.
For example, Django&#8217;s admin application has the somewhat predictable
application namespace of <code class="docutils literal"><span class="pre">'admin'</span></code>.</dd>
<dt id="term-instance-namespace">instance namespace</dt>
<dd>This identifies a specific instance of an application. Instance namespaces
should be unique across your entire project. However, an instance namespace
can be the same as the application namespace. This is used to specify a
default instance of an application. For example, the default Django admin
instance has an instance namespace of <code class="docutils literal"><span class="pre">'admin'</span></code>.</dd>
</dl>
<p>Namespaced URLs are specified using the <code class="docutils literal"><span class="pre">':'</span></code> operator. For example, the main
index page of the admin application is referenced using <code class="docutils literal"><span class="pre">'admin:index'</span></code>. This
indicates a namespace of <code class="docutils literal"><span class="pre">'admin'</span></code>, and a named URL of <code class="docutils literal"><span class="pre">'index'</span></code>.</p>
<p>Namespaces can also be nested. The named URL <code class="docutils literal"><span class="pre">'sports:polls:index'</span></code> would
look for a pattern named <code class="docutils literal"><span class="pre">'index'</span></code> in the namespace <code class="docutils literal"><span class="pre">'polls'</span></code> that is itself
defined within the top-level namespace <code class="docutils literal"><span class="pre">'sports'</span></code>.</p>
</div>
<div class="section" id="reversing-namespaced-urls">
<span id="topics-http-reversing-url-namespaces"></span><h3>Reversing namespaced URLs<a class="headerlink" href="#reversing-namespaced-urls" title="Permalink to this headline">¶</a></h3>
<p>When given a namespaced URL (e.g. <code class="docutils literal"><span class="pre">'polls:index'</span></code>) to resolve, Django splits
the fully qualified name into parts and then tries the following lookup:</p>
<ol class="arabic">
<li><p class="first">First, Django looks for a matching <a class="reference internal" href="#term-application-namespace"><span class="xref std std-term">application namespace</span></a> (in this
example, <code class="docutils literal"><span class="pre">'polls'</span></code>). This will yield a list of instances of that
application.</p>
</li>
<li><p class="first">If there is a <em>current</em> application defined, Django finds and returns
the URL resolver for that instance. The <em>current</em> application can be
specified as an attribute on the request. Applications that expect to
have multiple deployments should set the <code class="docutils literal"><span class="pre">current_app</span></code> attribute on
the <code class="docutils literal"><span class="pre">request</span></code> being processed.</p>
<p>The current application can also be specified manually as an argument
to the <code class="xref py py-func docutils literal"><span class="pre">reverse()</span></code> function.</p>
</li>
<li><p class="first">If there is no current application. Django looks for a default
application instance. The default application instance is the instance
that has an <a class="reference internal" href="#term-instance-namespace"><span class="xref std std-term">instance namespace</span></a> matching the <a class="reference internal" href="#term-application-namespace"><span class="xref std std-term">application
namespace</span></a> (in this example, an instance of <code class="docutils literal"><span class="pre">polls</span></code> called <code class="docutils literal"><span class="pre">'polls'</span></code>).</p>
</li>
<li><p class="first">If there is no default application instance, Django will pick the last
deployed instance of the application, whatever its instance name may be.</p>
</li>
<li><p class="first">If the provided namespace doesn&#8217;t match an <a class="reference internal" href="#term-application-namespace"><span class="xref std std-term">application namespace</span></a> in
step 1, Django will attempt a direct lookup of the namespace as an
<a class="reference internal" href="#term-instance-namespace"><span class="xref std std-term">instance namespace</span></a>.</p>
</li>
</ol>
<p>If there are nested namespaces, these steps are repeated for each part of the
namespace until only the view name is unresolved. The view name will then be
resolved into a URL in the namespace that has been found.</p>
</div>
<div class="section" id="url-namespaces-and-included-urlconfs">
<span id="namespaces-and-include"></span><h3>URL namespaces and included URLconfs<a class="headerlink" href="#url-namespaces-and-included-urlconfs" title="Permalink to this headline">¶</a></h3>
<p>URL namespaces of included URLconfs can be specified in two ways.</p>
<p>Firstly, you can provide the <a class="reference internal" href="#term-application-namespace"><span class="xref std std-term">application</span></a> and
<a class="reference internal" href="#term-instance-namespace"><span class="xref std std-term">instance</span></a> namespaces as arguments to
<code class="xref py py-func docutils literal"><span class="pre">include()</span></code> when you construct your URL patterns. For
example,:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">url</span><span class="p">(</span><span class="s">r&#39;^polls/&#39;</span><span class="p">,</span> <span class="n">include</span><span class="p">(</span><span class="s">&#39;polls.urls&#39;</span><span class="p">,</span> <span class="n">namespace</span><span class="o">=</span><span class="s">&#39;author-polls&#39;</span><span class="p">,</span> <span class="n">app_name</span><span class="o">=</span><span class="s">&#39;polls&#39;</span><span class="p">)),</span>
</pre></div>
</div>
<p>This will include the URLs defined in <code class="docutils literal"><span class="pre">polls.urls</span></code> into the
<a class="reference internal" href="#term-application-namespace"><span class="xref std std-term">application namespace</span></a> <code class="docutils literal"><span class="pre">'polls'</span></code>, with the <a class="reference internal" href="#term-instance-namespace"><span class="xref std std-term">instance namespace</span></a>
<code class="docutils literal"><span class="pre">'author-polls'</span></code>.</p>
<p>Secondly, you can include an object that contains embedded namespace data. If
you <code class="docutils literal"><span class="pre">include()</span></code> a list of <code class="xref py py-func docutils literal"><span class="pre">url()</span></code> instances,
the URLs contained in that object will be added to the global namespace.
However, you can also <code class="docutils literal"><span class="pre">include()</span></code> a 3-tuple containing:</p>
<div class="highlight-python"><div class="highlight"><pre>(&lt;list of url() instances&gt;, &lt;application namespace&gt;, &lt;instance namespace&gt;)
</pre></div>
</div>
<p>For example:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">django.conf.urls</span> <span class="kn">import</span> <span class="n">include</span><span class="p">,</span> <span class="n">url</span>

<span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">views</span>

<span class="n">polls_patterns</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">url</span><span class="p">(</span><span class="s">r&#39;^$&#39;</span><span class="p">,</span> <span class="n">views</span><span class="o">.</span><span class="n">IndexView</span><span class="o">.</span><span class="n">as_view</span><span class="p">(),</span> <span class="n">name</span><span class="o">=</span><span class="s">&#39;index&#39;</span><span class="p">),</span>
    <span class="n">url</span><span class="p">(</span><span class="s">r&#39;^(?P&lt;pk&gt;\d+)/$&#39;</span><span class="p">,</span> <span class="n">views</span><span class="o">.</span><span class="n">DetailView</span><span class="o">.</span><span class="n">as_view</span><span class="p">(),</span> <span class="n">name</span><span class="o">=</span><span class="s">&#39;detail&#39;</span><span class="p">),</span>
<span class="p">]</span>

<span class="n">url</span><span class="p">(</span><span class="s">r&#39;^polls/&#39;</span><span class="p">,</span> <span class="n">include</span><span class="p">((</span><span class="n">polls_patterns</span><span class="p">,</span> <span class="s">&#39;polls&#39;</span><span class="p">,</span> <span class="s">&#39;author-polls&#39;</span><span class="p">))),</span>
</pre></div>
</div>
<p>This will include the nominated URL patterns into the given application and
instance namespace.</p>
<p>For example, the Django admin is deployed as instances of
<code class="xref py py-class docutils literal"><span class="pre">AdminSite</span></code>.  <code class="docutils literal"><span class="pre">AdminSite</span></code> objects have a <code class="docutils literal"><span class="pre">urls</span></code>
attribute: A 3-tuple that contains all the patterns in the corresponding admin
site, plus the application namespace <code class="docutils literal"><span class="pre">'admin'</span></code>, and the name of the admin
instance. It is this <code class="docutils literal"><span class="pre">urls</span></code> attribute that you <code class="docutils literal"><span class="pre">include()</span></code> into your
projects <code class="docutils literal"><span class="pre">urlpatterns</span></code> when you deploy an admin instance.</p>
<p>Be sure to pass a tuple to <code class="docutils literal"><span class="pre">include()</span></code>. If you simply pass three arguments:
<code class="docutils literal"><span class="pre">include(polls_patterns,</span> <span class="pre">'polls',</span> <span class="pre">'author-polls')</span></code>, Django won&#8217;t throw an
error but due to the signature of <code class="docutils literal"><span class="pre">include()</span></code>, <code class="docutils literal"><span class="pre">'polls'</span></code> will be the
instance namespace and <code class="docutils literal"><span class="pre">'author-polls'</span></code> will be the application namespace
instead of vice versa.</p>
</div>
</div>
<div class="section" id="what-s-next">
<h2>What&#8217;s Next?<a class="headerlink" href="#what-s-next" title="Permalink to this headline">¶</a></h2>
<p>This chapter has provided many advanced tips and tricks for views and URLconfs.
Next, in Chapter 8, we&#8217;ll give this advanced treatment to Django&#8217;s template
system.</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Chapter 7: Advanced Views and URLconfs</a><ul>
<li><a class="reference internal" href="#urlconf-tricks">URLconf Tricks</a><ul>
<li><a class="reference internal" href="#streamlining-function-imports">Streamlining Function Imports</a></li>
<li><a class="reference internal" href="#special-casing-urls-in-debug-mode">Special-Casing URLs in Debug Mode</a></li>
</ul>
</li>
<li><a class="reference internal" href="#named-groups">Named groups</a><ul>
<li><a class="reference internal" href="#the-matching-grouping-algorithm">The matching/grouping algorithm</a></li>
</ul>
</li>
<li><a class="reference internal" href="#what-the-urlconf-searches-against">What the URLconf searches against</a></li>
<li><a class="reference internal" href="#captured-arguments-are-always-strings">Captured arguments are always strings</a></li>
<li><a class="reference internal" href="#specifying-defaults-for-view-arguments">Specifying defaults for view arguments</a></li>
<li><a class="reference internal" href="#performance">Performance</a></li>
<li><a class="reference internal" href="#error-handling">Error handling</a></li>
<li><a class="reference internal" href="#including-other-urlconfs">Including other URLconfs</a><ul>
<li><a class="reference internal" href="#captured-parameters">Captured parameters</a></li>
</ul>
</li>
<li><a class="reference internal" href="#passing-extra-options-to-view-functions">Passing extra options to view functions</a><ul>
<li><a class="reference internal" href="#passing-extra-options-to-include">Passing extra options to <code class="docutils literal"><span class="pre">include()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#reverse-resolution-of-urls">Reverse resolution of URLs</a><ul>
<li><a class="reference internal" href="#examples">Examples</a></li>
</ul>
</li>
<li><a class="reference internal" href="#naming-url-patterns">Naming URL patterns</a></li>
<li><a class="reference internal" href="#url-namespaces">URL namespaces</a><ul>
<li><a class="reference internal" href="#introduction">Introduction</a></li>
<li><a class="reference internal" href="#reversing-namespaced-urls">Reversing namespaced URLs</a></li>
<li><a class="reference internal" href="#url-namespaces-and-included-urlconfs">URL namespaces and included URLconfs</a></li>
</ul>
</li>
<li><a class="reference internal" href="#what-s-next">What&#8217;s Next?</a></li>
</ul>
</li>
</ul>
<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="chapter_06.html" title="previous chapter">Chapter 6: Forms</a></li>
      <li>Next: <a href="chapter_08.html" title="next chapter">Chapter 8: Advanced Templates</a></li>
  </ul></li>
</ul>
</div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/chapter_07.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2015, Nigel George.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.3.1</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.6</a>
      
      |
      <a href="_sources/chapter_07.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>